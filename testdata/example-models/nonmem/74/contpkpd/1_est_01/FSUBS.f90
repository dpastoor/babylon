      MODULE NMPRD4P
      USE SIZES, ONLY: DPSIZE
      USE NMPRD4,ONLY: VRBL
      IMPLICIT NONE
      SAVE
      REAL(KIND=DPSIZE), DIMENSION (:),POINTER ::COM
      REAL(KIND=DPSIZE), POINTER ::KA,CL,V,S2,EMAX,EC50,E0,EFF,CONC,Y
      REAL(KIND=DPSIZE), POINTER ::TYP2,IPRED,A000032,A000034,A000036
      REAL(KIND=DPSIZE), POINTER ::A000038,A000040,A000042,A000043
      REAL(KIND=DPSIZE), POINTER ::A000044,D000001,D000002,D000003
      REAL(KIND=DPSIZE), POINTER ::D000004,D000005,D000006,D000007
      REAL(KIND=DPSIZE), POINTER ::D000008,D000009,D000041,D000043
      REAL(KIND=DPSIZE), POINTER ::D000045,D000047,D000049,D000051
      REAL(KIND=DPSIZE), POINTER ::D000061,D000126,D000127,D000128
      REAL(KIND=DPSIZE), POINTER ::D000129,D000130,D000062,D000137
      REAL(KIND=DPSIZE), POINTER ::D000138,D000139,D000140,D000063
      REAL(KIND=DPSIZE), POINTER ::D000145,D000146,D000147,D000057
      REAL(KIND=DPSIZE), POINTER ::D000082,D000081,D000064,D000149
      REAL(KIND=DPSIZE), POINTER ::D000157,D000173,D000174,D000175
      REAL(KIND=DPSIZE), POINTER ::D000156,D000168,D000169,D000155
      REAL(KIND=DPSIZE), POINTER ::D000165,D000185,D000207,D000208
      REAL(KIND=DPSIZE), POINTER ::D000209,D000210,D000211,D000186
      REAL(KIND=DPSIZE), POINTER ::D000214,D000215,D000216,D000217
      REAL(KIND=DPSIZE), POINTER ::D000187,D000219,D000220,D000221
      REAL(KIND=DPSIZE), POINTER ::D000183,D000201,D000202,D000179
      REAL(KIND=DPSIZE), POINTER ::D000188,D000184,D000203,C000034
      REAL(KIND=DPSIZE), POINTER ::D000222,D000223,D000224,C000033
      CONTAINS
      SUBROUTINE ASSOCNMPRD4
      COM=>VRBL
      KA=>COM(000001);CL=>COM(000002);V=>COM(000003);S2=>COM(000004)
      EMAX=>COM(000005);EC50=>COM(000006);E0=>COM(000007)
      EFF=>COM(000008);CONC=>COM(000009);Y=>COM(000010)
      TYP2=>COM(000011);IPRED=>COM(000012);A000032=>COM(000013)
      A000034=>COM(000014);A000036=>COM(000015);A000038=>COM(000016)
      A000040=>COM(000017);A000042=>COM(000018);A000043=>COM(000019)
      A000044=>COM(000020);D000001=>COM(000021);D000002=>COM(000022)
      D000003=>COM(000023);D000004=>COM(000024);D000005=>COM(000025)
      D000006=>COM(000026);D000007=>COM(000027);D000008=>COM(000028)
      D000009=>COM(000029);D000041=>COM(000030);D000043=>COM(000031)
      D000045=>COM(000032);D000047=>COM(000033);D000049=>COM(000034)
      D000051=>COM(000035);D000061=>COM(000036);D000126=>COM(000037)
      D000127=>COM(000038);D000128=>COM(000039);D000129=>COM(000040)
      D000130=>COM(000041);D000062=>COM(000042);D000137=>COM(000043)
      D000138=>COM(000044);D000139=>COM(000045);D000140=>COM(000046)
      D000063=>COM(000047);D000145=>COM(000048);D000146=>COM(000049)
      D000147=>COM(000050);D000057=>COM(000051);D000082=>COM(000052)
      D000081=>COM(000053);D000064=>COM(000054);D000149=>COM(000055)
      D000157=>COM(000056);D000173=>COM(000057);D000174=>COM(000058)
      D000175=>COM(000059);D000156=>COM(000060);D000168=>COM(000061)
      D000169=>COM(000062);D000155=>COM(000063);D000165=>COM(000064)
      D000185=>COM(000065);D000207=>COM(000066);D000208=>COM(000067)
      D000209=>COM(000068);D000210=>COM(000069);D000211=>COM(000070)
      D000186=>COM(000071);D000214=>COM(000072);D000215=>COM(000073)
      D000216=>COM(000074);D000217=>COM(000075);D000187=>COM(000076)
      D000219=>COM(000077);D000220=>COM(000078);D000221=>COM(000079)
      D000183=>COM(000080);D000201=>COM(000081);D000202=>COM(000082)
      D000179=>COM(000083);D000188=>COM(000084);D000184=>COM(000085)
      D000203=>COM(000086);C000034=>COM(000087);D000222=>COM(000088)
      D000223=>COM(000089);D000224=>COM(000090);C000033=>COM(000091)
      END SUBROUTINE ASSOCNMPRD4
      END MODULE NMPRD4P
      SUBROUTINE PK(ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,IRGG,GG,NETAS)      
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMBAYES_REAL,    ONLY: PRIORINFO
      USE NMPRD_REAL,ONLY: ETA,EPS                                            
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,COMACT,COMSAV,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE NMPRD_INT, ONLY: IQUIT
      USE PROCM_INT, ONLY: NEWIND=>PNEWIF                                       
      USE NMBAYES_REAL, ONLY: LDF                                             
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                          
      REAL(KIND=DPSIZE) :: EVTREC                                               
      SAVE
      INTEGER(KIND=ISIZE) :: FIRSTEM
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS              
      DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*),GG(IRGG,GPKD+1,*) 
      FIRSTEM=IFIRSTEM
      IF (ICALL <= 1) THEN                                                      
      CALL ASSOCNMPRD4
      IDEF(   1,0001)=  -9
      IDEF(   1,0002)=  -1
      IDEF(   1,0003)=   0
      IDEF(   1,0004)=   0
      IDEF(   2,0003)=   0
      IDEF(   2,0004)=   0
      IDEF(   3,0002)=   4
      CALL GETETA(ETA)                                                          
      IF (IQUIT == 1) RETURN                                                    
      RETURN                                                                    
      ENDIF                                                                     
      IF (NEWIND /= 2) THEN
      IF (ICALL == 4) THEN
      CALL SIMETA(ETA)
      ELSE
      CALL GETETA(ETA)
      ENDIF
      IF (IQUIT == 1) RETURN
      ENDIF
 !  level            0
      B000001=DEXP(ETA(001)) 
      KA=THETA(001)*B000001 
      B000002=DEXP(ETA(002)) 
      CL=THETA(002)*B000002 
      B000003=DEXP(ETA(003)) 
      V=THETA(003)*B000003 
      S2=V 
      IF (FIRSTEM == 1) THEN
!                      A000032 = DERIVATIVE OF KA W.R.T. ETA(001)
      A000032=THETA(001)*B000001 
!                      A000036 = DERIVATIVE OF CL W.R.T. ETA(002)
      A000036=THETA(002)*B000002 
!                      A000040 = DERIVATIVE OF V W.R.T. ETA(003)
      A000040=THETA(003)*B000003 
!                      A000043 = DERIVATIVE OF S2 W.R.T. ETA(003)
      A000043=A000040 
      GG(0001,1,1)=CL
      GG(0001,0003,1)=A000036
      GG(0002,1,1)=V
      GG(0002,0004,1)=A000040
      GG(0003,1,1)=KA
      GG(0003,0002,1)=A000032
      GG(0004,1,1)=S2
      GG(0004,0004,1)=A000043
      ELSE
      GG(0001,1,1)=CL
      GG(0002,1,1)=V
      GG(0003,1,1)=KA
      GG(0004,1,1)=S2
      ENDIF
      IF (MSEC == 1) THEN
!                      A000034 = DERIVATIVE OF A000032 W.R.T. ETA(001)
      A000034=THETA(001)*B000001 
!                      A000038 = DERIVATIVE OF A000036 W.R.T. ETA(002)
      A000038=THETA(002)*B000002 
!                      A000042 = DERIVATIVE OF A000040 W.R.T. ETA(003)
      A000042=THETA(003)*B000003 
!                      A000044 = DERIVATIVE OF A000043 W.R.T. ETA(003)
      A000044=A000042 
      GG(0001,0003,0003)=A000038
      GG(0002,0004,0004)=A000042
      GG(0003,0002,0002)=A000034
      GG(0004,0004,0004)=A000044
      ENDIF
      RETURN
      END
      SUBROUTINE ERROR (ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,F,G,HH)       
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMPRD_REAL,ONLY: ETA,EPS                                            
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,IQUIT,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE NMPRD_INT, ONLY: NEWL2
      USE PROCM_INT, ONLY: NEWIND=>PNEWIF                                       
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                        
      REAL(KIND=DPSIZE) :: EVTREC                                             
      SAVE
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS                       
      DIMENSION :: IDEF(*),THETA(*),EVTREC(IREV,*),INDXS(*)                   
      REAL(KIND=DPSIZE) :: G(GERD,*),HH(HERD,*)                               
      INTEGER(KIND=ISIZE) :: FIRSTEM
      FIRSTEM=IFIRSTEM
      IF (ICALL <= 1) THEN                                                    
      CALL ASSOCNMPRD4
      IDEF(2)=-1
      IDEF(3)=000
      RETURN
      ENDIF
      IF (ICALL == 4) THEN
      IF (NEWL2 == 1) THEN
      CALL SIMEPS(EPS)
      IF (IQUIT == 1) RETURN
      ENDIF
      ENDIF
      D000001=G(001,1)
      D000002=G(002,1)
      D000003=G(003,1)
 !  level            0
      TYPE=EVTREC(NVNT,006)
      B000001=DEXP(ETA(004)) 
      EMAX=THETA(004)*B000001 
      B000002=DEXP(ETA(005)) 
      EC50=THETA(005)*B000002 
      B000003=DEXP(ETA(006)) 
      E0=THETA(006)*B000003 
      B000004=EC50+F 
      EFF=E0+EMAX*F/B000004+EPS(002) 
      CONC=F+F*EPS(001) 
      B000017=1.D0-TYPE 
      Y=EFF*TYPE+CONC*B000017 
!                      C000033 = DERIVATIVE OF Y W.R.T. EPS(002)
      C000033=TYPE 
!                      C000034 = DERIVATIVE OF Y W.R.T. EPS(001)
      C000034=B000017*F 
      TYP2=TYPE 
      IPRED=Y 
      IF (FIRSTEM == 1) THEN !1
!                      D000041 = DERIVATIVE OF EMAX W.R.T. ETA(004)
      D000041=THETA(004)*B000001 
!                      D000045 = DERIVATIVE OF EC50 W.R.T. ETA(005)
      D000045=THETA(005)*B000002 
!                      D000049 = DERIVATIVE OF E0 W.R.T. ETA(006)
      D000049=THETA(006)*B000003 
      B000005=F/B000004 
!                      D000057 = DERIVATIVE OF EFF W.R.T. ETA(004)
      D000057=B000005*D000041 
      B000006=EMAX/B000004 
!                      D000058 = DERIVATIVE OF EFF W.R.T. ETA(003)
      D000058=B000006*D000003 
!                      D000059 = DERIVATIVE OF EFF W.R.T. ETA(002)
      D000059=B000006*D000002 
!                      D000060 = DERIVATIVE OF EFF W.R.T. ETA(001)
      D000060=B000006*D000001 
      B000007=-EMAX*F/B000004/B000004 
!                      D000061 = DERIVATIVE OF EFF W.R.T. ETA(001)
      D000061=B000007*D000001+D000060 
!                      D000062 = DERIVATIVE OF EFF W.R.T. ETA(002)
      D000062=B000007*D000002+D000059 
!                      D000063 = DERIVATIVE OF EFF W.R.T. ETA(003)
      D000063=B000007*D000003+D000058 
!                      D000064 = DERIVATIVE OF EFF W.R.T. ETA(005)
      D000064=B000007*D000045 
!                      D000155 = DERIVATIVE OF CONC W.R.T. ETA(003)
      D000155=EPS(001)*D000003+D000003 
!                      D000156 = DERIVATIVE OF CONC W.R.T. ETA(002)
      D000156=EPS(001)*D000002+D000002 
!                      D000157 = DERIVATIVE OF CONC W.R.T. ETA(001)
      D000157=EPS(001)*D000001+D000001 
!                      D000179 = DERIVATIVE OF Y W.R.T. ETA(005)
      D000179=TYPE*D000064 
!                      D000180 = DERIVATIVE OF Y W.R.T. ETA(003)
      D000180=TYPE*D000063 
!                      D000181 = DERIVATIVE OF Y W.R.T. ETA(002)
      D000181=TYPE*D000062 
!                      D000182 = DERIVATIVE OF Y W.R.T. ETA(001)
      D000182=TYPE*D000061 
!                      D000183 = DERIVATIVE OF Y W.R.T. ETA(004)
      D000183=TYPE*D000057 
!                      D000184 = DERIVATIVE OF Y W.R.T. ETA(006)
      D000184=TYPE*D000049 
!                      D000185 = DERIVATIVE OF Y W.R.T. ETA(001)
      D000185=B000017*D000157+D000182 
!                      D000186 = DERIVATIVE OF Y W.R.T. ETA(002)
      D000186=B000017*D000156+D000181 
!                      D000187 = DERIVATIVE OF Y W.R.T. ETA(003)
      D000187=B000017*D000155+D000180 
!                      D000222 = DERIVATIVE OF C000034 W.R.T. ETA(001)
      D000222=B000017*D000001 
!                      D000223 = DERIVATIVE OF C000034 W.R.T. ETA(002)
      D000223=B000017*D000002 
!                      D000224 = DERIVATIVE OF C000034 W.R.T. ETA(003)
      D000224=B000017*D000003 
      G(001,1)=D000185
      G(002,1)=D000186
      G(003,1)=D000187
      G(004,1)=D000183
      G(005,1)=D000179
      G(006,1)=D000184
      ENDIF !1
      HH(001,1)=C000034
      HH(002,1)=C000033
      IF (FIRSTEM == 1) THEN !2
      HH(001,002)=D000222
      HH(001,003)=D000223
      HH(001,004)=D000224
      ENDIF !2
      IF (MSEC == 1) THEN
      D000004=G(001,002)
      D000005=G(002,002)
      D000006=G(002,003)
      D000007=G(003,002)
      D000008=G(003,003)
      D000009=G(003,004)
!                      D000043 = DERIVATIVE OF D000041 W.R.T. ETA(004)
      D000043=THETA(004)*B000001 
!                      D000047 = DERIVATIVE OF D000045 W.R.T. ETA(005)
      D000047=THETA(005)*B000002 
!                      D000051 = DERIVATIVE OF D000049 W.R.T. ETA(006)
      D000051=THETA(006)*B000003 
      B000009=1.D0/B000004 
!                      D000074 = DERIVATIVE OF B000005 W.R.T. ETA(003)
      D000074=B000009*D000003 
!                      D000075 = DERIVATIVE OF B000005 W.R.T. ETA(002)
      D000075=B000009*D000002 
!                      D000076 = DERIVATIVE OF B000005 W.R.T. ETA(001)
      D000076=B000009*D000001 
      B000010=-F/B000004/B000004 
!                      D000077 = DERIVATIVE OF B000005 W.R.T. ETA(001)
      D000077=B000010*D000001+D000076 
!                      D000078 = DERIVATIVE OF B000005 W.R.T. ETA(002)
      D000078=B000010*D000002+D000075 
!                      D000079 = DERIVATIVE OF B000005 W.R.T. ETA(003)
      D000079=B000010*D000003+D000074 
!                      D000080 = DERIVATIVE OF B000005 W.R.T. ETA(005)
      D000080=B000010*D000045 
!                      D000081 = DERIVATIVE OF D000057 W.R.T. ETA(005)
      D000081=D000041*D000080 
!                      D000082 = DERIVATIVE OF D000057 W.R.T. ETA(004)
      D000082=B000005*D000043 
      B000011=1.D0/B000004 
!                      D000083 = DERIVATIVE OF B000006 W.R.T. ETA(004)
      D000083=B000011*D000041 
      B000012=-EMAX/B000004/B000004 
!                      D000084 = DERIVATIVE OF B000006 W.R.T. ETA(001)
      D000084=B000012*D000001 
!                      D000085 = DERIVATIVE OF B000006 W.R.T. ETA(002)
      D000085=B000012*D000002 
!                      D000086 = DERIVATIVE OF B000006 W.R.T. ETA(003)
      D000086=B000012*D000003 
!                      D000087 = DERIVATIVE OF B000006 W.R.T. ETA(005)
      D000087=B000012*D000045 
!                      D000088 = DERIVATIVE OF D000058 W.R.T. ETA(005)
      D000088=D000003*D000087 
!                      D000089 = DERIVATIVE OF D000058 W.R.T. ETA(003)
      D000089=D000003*D000086 
!                      D000090 = DERIVATIVE OF D000058 W.R.T. ETA(004)
      D000090=D000003*D000083 
!                      D000091 = DERIVATIVE OF D000058 W.R.T. ETA(003)
      D000091=B000006*D000009+D000089 
!                      D000092 = DERIVATIVE OF D000059 W.R.T. ETA(005)
      D000092=D000002*D000087 
!                      D000093 = DERIVATIVE OF D000059 W.R.T. ETA(003)
      D000093=D000002*D000086 
!                      D000094 = DERIVATIVE OF D000059 W.R.T. ETA(002)
      D000094=D000002*D000085 
!                      D000095 = DERIVATIVE OF D000059 W.R.T. ETA(004)
      D000095=D000002*D000083 
!                      D000096 = DERIVATIVE OF D000059 W.R.T. ETA(003)
      D000096=B000006*D000008+D000093 
!                      D000097 = DERIVATIVE OF D000059 W.R.T. ETA(002)
      D000097=B000006*D000006+D000094 
!                      D000098 = DERIVATIVE OF D000060 W.R.T. ETA(005)
      D000098=D000001*D000087 
!                      D000099 = DERIVATIVE OF D000060 W.R.T. ETA(003)
      D000099=D000001*D000086 
!                      D000100 = DERIVATIVE OF D000060 W.R.T. ETA(002)
      D000100=D000001*D000085 
!                      D000101 = DERIVATIVE OF D000060 W.R.T. ETA(001)
      D000101=D000001*D000084 
!                      D000102 = DERIVATIVE OF D000060 W.R.T. ETA(004)
      D000102=D000001*D000083 
!                      D000103 = DERIVATIVE OF D000060 W.R.T. ETA(003)
      D000103=B000006*D000007+D000099 
!                      D000104 = DERIVATIVE OF D000060 W.R.T. ETA(002)
      D000104=B000006*D000005+D000100 
!                      D000105 = DERIVATIVE OF D000060 W.R.T. ETA(001)
      D000105=B000006*D000004+D000101 
      B000013=-F/B000004/B000004 
!                      D000106 = DERIVATIVE OF B000007 W.R.T. ETA(004)
      D000106=B000013*D000041 
      B000014=-EMAX/B000004/B000004 
!                      D000107 = DERIVATIVE OF B000007 W.R.T. ETA(003)
      D000107=B000014*D000003 
!                      D000108 = DERIVATIVE OF B000007 W.R.T. ETA(002)
      D000108=B000014*D000002 
!                      D000109 = DERIVATIVE OF B000007 W.R.T. ETA(001)
      D000109=B000014*D000001 
      B000015=EMAX*F/B000004/B000004/B000004 
!                      D000110 = DERIVATIVE OF B000007 W.R.T. ETA(001)
      D000110=B000015*D000001+D000109 
!                      D000111 = DERIVATIVE OF B000007 W.R.T. ETA(002)
      D000111=B000015*D000002+D000108 
!                      D000112 = DERIVATIVE OF B000007 W.R.T. ETA(003)
      D000112=B000015*D000003+D000107 
!                      D000113 = DERIVATIVE OF B000007 W.R.T. ETA(005)
      D000113=B000015*D000045 
      B000016=EMAX*F/B000004/B000004/B000004 
!                      D000114 = DERIVATIVE OF B000007 W.R.T. ETA(001)
      D000114=B000016*D000001+D000110 
!                      D000115 = DERIVATIVE OF B000007 W.R.T. ETA(002)
      D000115=B000016*D000002+D000111 
!                      D000116 = DERIVATIVE OF B000007 W.R.T. ETA(003)
      D000116=B000016*D000003+D000112 
!                      D000117 = DERIVATIVE OF B000007 W.R.T. ETA(005)
      D000117=B000016*D000045+D000113 
!                      D000118 = DERIVATIVE OF D000061 W.R.T. ETA(005)
      D000118=D000001*D000117 
!                      D000119 = DERIVATIVE OF D000061 W.R.T. ETA(003)
      D000119=D000001*D000116 
!                      D000120 = DERIVATIVE OF D000061 W.R.T. ETA(002)
      D000120=D000001*D000115 
!                      D000121 = DERIVATIVE OF D000061 W.R.T. ETA(001)
      D000121=D000001*D000114 
!                      D000122 = DERIVATIVE OF D000061 W.R.T. ETA(004)
      D000122=D000001*D000106 
!                      D000123 = DERIVATIVE OF D000061 W.R.T. ETA(001)
      D000123=B000007*D000004+D000121 
!                      D000124 = DERIVATIVE OF D000061 W.R.T. ETA(002)
      D000124=B000007*D000005+D000120 
!                      D000125 = DERIVATIVE OF D000061 W.R.T. ETA(003)
      D000125=B000007*D000007+D000119 
!                      D000126 = DERIVATIVE OF D000061 W.R.T. ETA(001)
      D000126=D000105+D000123 
!                      D000127 = DERIVATIVE OF D000061 W.R.T. ETA(002)
      D000127=D000104+D000124 
!                      D000128 = DERIVATIVE OF D000061 W.R.T. ETA(003)
      D000128=D000103+D000125 
!                      D000129 = DERIVATIVE OF D000061 W.R.T. ETA(004)
      D000129=D000102+D000122 
!                      D000130 = DERIVATIVE OF D000061 W.R.T. ETA(005)
      D000130=D000098+D000118 
!                      D000131 = DERIVATIVE OF D000062 W.R.T. ETA(005)
      D000131=D000002*D000117 
!                      D000132 = DERIVATIVE OF D000062 W.R.T. ETA(003)
      D000132=D000002*D000116 
!                      D000133 = DERIVATIVE OF D000062 W.R.T. ETA(002)
      D000133=D000002*D000115 
!                      D000134 = DERIVATIVE OF D000062 W.R.T. ETA(004)
      D000134=D000002*D000106 
!                      D000135 = DERIVATIVE OF D000062 W.R.T. ETA(002)
      D000135=B000007*D000006+D000133 
!                      D000136 = DERIVATIVE OF D000062 W.R.T. ETA(003)
      D000136=B000007*D000008+D000132 
!                      D000137 = DERIVATIVE OF D000062 W.R.T. ETA(002)
      D000137=D000097+D000135 
!                      D000138 = DERIVATIVE OF D000062 W.R.T. ETA(003)
      D000138=D000096+D000136 
!                      D000139 = DERIVATIVE OF D000062 W.R.T. ETA(004)
      D000139=D000095+D000134 
!                      D000140 = DERIVATIVE OF D000062 W.R.T. ETA(005)
      D000140=D000092+D000131 
!                      D000141 = DERIVATIVE OF D000063 W.R.T. ETA(005)
      D000141=D000003*D000117 
!                      D000142 = DERIVATIVE OF D000063 W.R.T. ETA(003)
      D000142=D000003*D000116 
!                      D000143 = DERIVATIVE OF D000063 W.R.T. ETA(004)
      D000143=D000003*D000106 
!                      D000144 = DERIVATIVE OF D000063 W.R.T. ETA(003)
      D000144=B000007*D000009+D000142 
!                      D000145 = DERIVATIVE OF D000063 W.R.T. ETA(003)
      D000145=D000091+D000144 
!                      D000146 = DERIVATIVE OF D000063 W.R.T. ETA(004)
      D000146=D000090+D000143 
!                      D000147 = DERIVATIVE OF D000063 W.R.T. ETA(005)
      D000147=D000088+D000141 
!                      D000148 = DERIVATIVE OF D000064 W.R.T. ETA(005)
      D000148=D000045*D000117 
!                      D000149 = DERIVATIVE OF D000064 W.R.T. ETA(005)
      D000149=B000007*D000047+D000148 
!                      D000164 = DERIVATIVE OF D000155 W.R.T. ETA(003)
      D000164=EPS(001)*D000009 
!                      D000165 = DERIVATIVE OF D000155 W.R.T. ETA(003)
      D000165=D000009+D000164 
!                      D000166 = DERIVATIVE OF D000156 W.R.T. ETA(003)
      D000166=EPS(001)*D000008 
!                      D000167 = DERIVATIVE OF D000156 W.R.T. ETA(002)
      D000167=EPS(001)*D000006 
!                      D000168 = DERIVATIVE OF D000156 W.R.T. ETA(002)
      D000168=D000006+D000167 
!                      D000169 = DERIVATIVE OF D000156 W.R.T. ETA(003)
      D000169=D000008+D000166 
!                      D000170 = DERIVATIVE OF D000157 W.R.T. ETA(003)
      D000170=EPS(001)*D000007 
!                      D000171 = DERIVATIVE OF D000157 W.R.T. ETA(002)
      D000171=EPS(001)*D000005 
!                      D000172 = DERIVATIVE OF D000157 W.R.T. ETA(001)
      D000172=EPS(001)*D000004 
!                      D000173 = DERIVATIVE OF D000157 W.R.T. ETA(001)
      D000173=D000004+D000172 
!                      D000174 = DERIVATIVE OF D000157 W.R.T. ETA(002)
      D000174=D000005+D000171 
!                      D000175 = DERIVATIVE OF D000157 W.R.T. ETA(003)
      D000175=D000007+D000170 
!                      D000188 = DERIVATIVE OF D000179 W.R.T. ETA(005)
      D000188=TYPE*D000149 
!                      D000189 = DERIVATIVE OF D000180 W.R.T. ETA(005)
      D000189=TYPE*D000147 
!                      D000190 = DERIVATIVE OF D000180 W.R.T. ETA(004)
      D000190=TYPE*D000146 
!                      D000191 = DERIVATIVE OF D000180 W.R.T. ETA(003)
      D000191=TYPE*D000145 
!                      D000192 = DERIVATIVE OF D000181 W.R.T. ETA(005)
      D000192=TYPE*D000140 
!                      D000193 = DERIVATIVE OF D000181 W.R.T. ETA(004)
      D000193=TYPE*D000139 
!                      D000194 = DERIVATIVE OF D000181 W.R.T. ETA(003)
      D000194=TYPE*D000138 
!                      D000195 = DERIVATIVE OF D000181 W.R.T. ETA(002)
      D000195=TYPE*D000137 
!                      D000196 = DERIVATIVE OF D000182 W.R.T. ETA(005)
      D000196=TYPE*D000130 
!                      D000197 = DERIVATIVE OF D000182 W.R.T. ETA(004)
      D000197=TYPE*D000129 
!                      D000198 = DERIVATIVE OF D000182 W.R.T. ETA(003)
      D000198=TYPE*D000128 
!                      D000199 = DERIVATIVE OF D000182 W.R.T. ETA(002)
      D000199=TYPE*D000127 
!                      D000200 = DERIVATIVE OF D000182 W.R.T. ETA(001)
      D000200=TYPE*D000126 
!                      D000201 = DERIVATIVE OF D000183 W.R.T. ETA(004)
      D000201=TYPE*D000082 
!                      D000202 = DERIVATIVE OF D000183 W.R.T. ETA(005)
      D000202=TYPE*D000081 
!                      D000203 = DERIVATIVE OF D000184 W.R.T. ETA(006)
      D000203=TYPE*D000051 
!                      D000204 = DERIVATIVE OF D000185 W.R.T. ETA(003)
      D000204=B000017*D000175 
!                      D000205 = DERIVATIVE OF D000185 W.R.T. ETA(002)
      D000205=B000017*D000174 
!                      D000206 = DERIVATIVE OF D000185 W.R.T. ETA(001)
      D000206=B000017*D000173 
!                      D000207 = DERIVATIVE OF D000185 W.R.T. ETA(001)
      D000207=D000200+D000206 
!                      D000208 = DERIVATIVE OF D000185 W.R.T. ETA(002)
      D000208=D000199+D000205 
!                      D000209 = DERIVATIVE OF D000185 W.R.T. ETA(003)
      D000209=D000198+D000204 
!                      D000210 = DERIVATIVE OF D000185 W.R.T. ETA(004)
      D000210=D000197 
!                      D000211 = DERIVATIVE OF D000185 W.R.T. ETA(005)
      D000211=D000196 
!                      D000212 = DERIVATIVE OF D000186 W.R.T. ETA(003)
      D000212=B000017*D000169 
!                      D000213 = DERIVATIVE OF D000186 W.R.T. ETA(002)
      D000213=B000017*D000168 
!                      D000214 = DERIVATIVE OF D000186 W.R.T. ETA(002)
      D000214=D000195+D000213 
!                      D000215 = DERIVATIVE OF D000186 W.R.T. ETA(003)
      D000215=D000194+D000212 
!                      D000216 = DERIVATIVE OF D000186 W.R.T. ETA(004)
      D000216=D000193 
!                      D000217 = DERIVATIVE OF D000186 W.R.T. ETA(005)
      D000217=D000192 
!                      D000218 = DERIVATIVE OF D000187 W.R.T. ETA(003)
      D000218=B000017*D000165 
!                      D000219 = DERIVATIVE OF D000187 W.R.T. ETA(003)
      D000219=D000191+D000218 
!                      D000220 = DERIVATIVE OF D000187 W.R.T. ETA(004)
      D000220=D000190 
!                      D000221 = DERIVATIVE OF D000187 W.R.T. ETA(005)
      D000221=D000189 
      G(001,002)=D000207
      G(002,002)=D000208
      G(002,003)=D000214
      G(003,002)=D000209
      G(003,003)=D000215
      G(003,004)=D000219
      G(004,002)=D000210
      G(004,003)=D000216
      G(004,004)=D000220
      G(004,005)=D000201
      G(005,002)=D000211
      G(005,003)=D000217
      G(005,004)=D000221
      G(005,005)=D000202
      G(005,006)=D000188
      G(006,007)=D000203
      ENDIF
      F=Y
      RETURN
      END
      SUBROUTINE FSIZESR(NAME_FSIZES,F_SIZES)
      USE SIZES, ONLY: ISIZE
      INTEGER(KIND=ISIZE), DIMENSION(*) :: F_SIZES
      CHARACTER(LEN=*),    DIMENSION(*) :: NAME_FSIZES
      NAME_FSIZES(01)='LTH'; F_SIZES(01)=6
      NAME_FSIZES(02)='LVR'; F_SIZES(02)=8
      NAME_FSIZES(03)='LVR2'; F_SIZES(03)=0
      NAME_FSIZES(04)='LPAR'; F_SIZES(04)=30
      NAME_FSIZES(05)='LPAR3'; F_SIZES(05)=0
      NAME_FSIZES(06)='NO'; F_SIZES(06)=0
      NAME_FSIZES(07)='MMX'; F_SIZES(07)=1
      NAME_FSIZES(08)='LNP4'; F_SIZES(08)=0
      NAME_FSIZES(09)='LSUPP'; F_SIZES(09)=1
      NAME_FSIZES(10)='LIM7'; F_SIZES(10)=0
      NAME_FSIZES(11)='LWS3'; F_SIZES(11)=0
      NAME_FSIZES(12)='MAXIDS'; F_SIZES(12)=20
      NAME_FSIZES(13)='LIM1'; F_SIZES(13)=0
      NAME_FSIZES(14)='LIM2'; F_SIZES(14)=0
      NAME_FSIZES(15)='LIM3'; F_SIZES(15)=0
      NAME_FSIZES(16)='LIM4'; F_SIZES(16)=0
      NAME_FSIZES(17)='LIM5'; F_SIZES(17)=0
      NAME_FSIZES(18)='LIM6'; F_SIZES(18)=0
      NAME_FSIZES(19)='LIM8'; F_SIZES(19)=0
      NAME_FSIZES(20)='LIM10'; F_SIZES(20)=0
      NAME_FSIZES(21)='LIM11'; F_SIZES(21)=0
      NAME_FSIZES(22)='LIM13'; F_SIZES(22)=0
      NAME_FSIZES(23)='LIM15'; F_SIZES(23)=0
      NAME_FSIZES(24)='LIM16'; F_SIZES(24)=0
      NAME_FSIZES(25)='MAXRECID'; F_SIZES(25)=0
      NAME_FSIZES(26)='PC'; F_SIZES(26)=0
      NAME_FSIZES(27)='PCT'; F_SIZES(27)=1
      NAME_FSIZES(28)='PIR'; F_SIZES(28)=1
      NAME_FSIZES(29)='PD'; F_SIZES(29)=8
      NAME_FSIZES(30)='PAL'; F_SIZES(30)=0
      NAME_FSIZES(31)='MAXFCN'; F_SIZES(31)=0
      NAME_FSIZES(32)='MAXIC'; F_SIZES(32)=0
      NAME_FSIZES(33)='PG'; F_SIZES(33)=0
      NAME_FSIZES(34)='NPOPMIXMAX'; F_SIZES(34)=0
      NAME_FSIZES(35)='MAXOMEG'; F_SIZES(35)=6
      NAME_FSIZES(36)='MAXPTHETA'; F_SIZES(36)=9
      NAME_FSIZES(37)='MAXITER'; F_SIZES(37)=20
      NAME_FSIZES(38)='ISAMPLEMAX'; F_SIZES(38)=0
      NAME_FSIZES(39)='DIMTMP'; F_SIZES(39)=0
      NAME_FSIZES(40)='DIMCNS'; F_SIZES(40)=0
      NAME_FSIZES(41)='DIMNEW'; F_SIZES(41)=0
      NAME_FSIZES(42)='PDT'; F_SIZES(42)=8
      NAME_FSIZES(43)='LADD_MAX'; F_SIZES(43)=0
      NAME_FSIZES(44)='MAXSIDL'; F_SIZES(44)=0
      NAME_FSIZES(45)='NTT'; F_SIZES(45)=6
      NAME_FSIZES(46)='NOMEG'; F_SIZES(46)=6
      NAME_FSIZES(47)='NSIGM'; F_SIZES(47)=2
      NAME_FSIZES(48)='PPDT'; F_SIZES(48)=4
      RETURN
      END SUBROUTINE FSIZESR
      SUBROUTINE MUMODEL2(THETA,MU_,ICALL,IDEF,NEWIND,&
      EVTREC,DATREC,IREV,NVNT,INDXS,F,G,H,IRGG,GG,NETAS)
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMBAYES_REAL,    ONLY: PRIORINFO
      USE NMPRD_REAL,ONLY: ETA,EPS
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,COMACT,COMSAV,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE NMPRD_INT, ONLY: IQUIT
      USE NMBAYES_REAL, ONLY: LDF
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)
      REAL(KIND=DPSIZE)   :: MU_(*)
      INTEGER NEWIND
      REAL(KIND=DPSIZE) :: EVTREC
      SAVE
      INTEGER(KIND=ISIZE) :: FIRSTEM
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS
      DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*),GG(IRGG,GPKD+1,*)
      RETURN
      END
