      MODULE NMPRD4P
      USE SIZES, ONLY: DPSIZE
      USE NMPRD4,ONLY: VRBL
      IMPLICIT NONE
      SAVE
      REAL(KIND=DPSIZE), DIMENSION (:),POINTER ::COM
      REAL(KIND=DPSIZE), POINTER ::TVCL,CL,TVV2,V2,TVV3,V3,TVQ,Q,KA,S2
      REAL(KIND=DPSIZE), POINTER ::K,K23,K32,SUM,SSUM,ALPH,BETA,HLAL
      REAL(KIND=DPSIZE), POINTER ::HLBE,IPRED,Y,A000032,A000034
      REAL(KIND=DPSIZE), POINTER ::A000036,A000038,A000040,A000042
      REAL(KIND=DPSIZE), POINTER ::A000043,A000044,A000045,A000049
      REAL(KIND=DPSIZE), POINTER ::A000048,A000046,A000054,A000055
      REAL(KIND=DPSIZE), POINTER ::A000059,A000061,A000065,A000122
      REAL(KIND=DPSIZE), POINTER ::A000134,A000133,A000121,A000132
      REAL(KIND=DPSIZE), POINTER ::A000140,A000152,A000151,A000139
      REAL(KIND=DPSIZE), POINTER ::A000150,A000153,A000163,A000164
      REAL(KIND=DPSIZE), POINTER ::A000154,A000166,A000172,A000182
      REAL(KIND=DPSIZE), POINTER ::A000183,A000173,A000185,C000032
      REAL(KIND=DPSIZE), POINTER ::D000060,D000059,D000058
      CONTAINS
      SUBROUTINE ASSOCNMPRD4
      COM=>VRBL
      TVCL=>COM(000001);CL=>COM(000002);TVV2=>COM(000003)
      V2=>COM(000004);TVV3=>COM(000005);V3=>COM(000006)
      TVQ=>COM(000007);Q=>COM(000008);KA=>COM(000009);S2=>COM(000010)
      K=>COM(000011);K23=>COM(000012);K32=>COM(000013)
      SUM=>COM(000014);SSUM=>COM(000015);ALPH=>COM(000016)
      BETA=>COM(000017);HLAL=>COM(000018);HLBE=>COM(000019)
      IPRED=>COM(000020);Y=>COM(000021);A000032=>COM(000022)
      A000034=>COM(000023);A000036=>COM(000024);A000038=>COM(000025)
      A000040=>COM(000026);A000042=>COM(000027);A000043=>COM(000028)
      A000044=>COM(000029);A000045=>COM(000030);A000049=>COM(000031)
      A000048=>COM(000032);A000046=>COM(000033);A000054=>COM(000034)
      A000055=>COM(000035);A000059=>COM(000036);A000061=>COM(000037)
      A000065=>COM(000038);A000122=>COM(000039);A000134=>COM(000040)
      A000133=>COM(000041);A000121=>COM(000042);A000132=>COM(000043)
      A000140=>COM(000044);A000152=>COM(000045);A000151=>COM(000046)
      A000139=>COM(000047);A000150=>COM(000048);A000153=>COM(000049)
      A000163=>COM(000050);A000164=>COM(000051);A000154=>COM(000052)
      A000166=>COM(000053);A000172=>COM(000054);A000182=>COM(000055)
      A000183=>COM(000056);A000173=>COM(000057);A000185=>COM(000058)
      C000032=>COM(000059);D000060=>COM(000060);D000059=>COM(000061)
      D000058=>COM(000062)
      END SUBROUTINE ASSOCNMPRD4
      END MODULE NMPRD4P
      SUBROUTINE PK(ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,IRGG,GG,NETAS)      
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMBAYES_REAL,    ONLY: PRIORINFO
      USE NMPRD_INT, ONLY: IERPRD,IERPRDU,NETEXT,IQUIT                        
      USE NMPRD_CHAR,ONLY: ETEXT                                              
      USE NMPRD_REAL,ONLY: ETA,EPS                                            
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,COMACT,COMSAV,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE PROCM_INT, ONLY: NEWIND=>PNEWIF                                       
      USE NMBAYES_REAL, ONLY: LDF                                             
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                          
      REAL(KIND=DPSIZE) :: EVTREC                                               
      SAVE
      INTEGER(KIND=ISIZE) :: FIRSTEM
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS              
      DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*),GG(IRGG,GPKD+1,*) 
      FIRSTEM=IFIRSTEM
      IF (ICALL <= 1) THEN                                                      
      CALL ASSOCNMPRD4
      IDEF(   1,0001)=  -9
      IDEF(   1,0002)=  -1
      IDEF(   1,0003)=   0
      IDEF(   1,0004)=   0
      IDEF(   2,0003)=   0
      IDEF(   2,0004)=   0
      IDEF(   3,0002)=   6
      CALL GETETA(ETA)                                                          
      IF (IQUIT == 1) RETURN                                                    
      RETURN                                                                    
      ENDIF                                                                     
      IF (NEWIND /= 2) THEN
      IF (ICALL == 4) THEN
      CALL SIMETA(ETA)
      ELSE
      CALL GETETA(ETA)
      ENDIF
      IF (IQUIT == 1) RETURN
      ENDIF
 !  level            0
      WT=EVTREC(NVNT,008)
      B000001=WT/70.D0 
      IF(B000001 == 0.D0.AND.THETA(006) <= 0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE 0**POWER WITH POWER<=0.'
      RETURN
      ENDIF 
      IF(B000001 <  0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE BASE**POWER WITH BASE<0.'
      RETURN
      ENDIF 
      B000002=0.D0 
      IF(B000001 == 0.D0)THEN 
      B000002=1.D0 
      ENDIF 
      B000003=1.D0-B000002 
      B000004=B000001+B000002 
      B000005=B000004**THETA(006) 
      B000006=B000003*B000005 
      TVCL=THETA(001)*B000006 
      B000007=DEXP(ETA(001)) 
      CL=TVCL*B000007 
      B000009=WT/70.D0 
      IF(B000009 == 0.D0.AND.THETA(007) <= 0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE 0**POWER WITH POWER<=0.'
      RETURN
      ENDIF 
      IF(B000009 <  0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE BASE**POWER WITH BASE<0.'
      RETURN
      ENDIF 
      B000010=0.D0 
      IF(B000009 == 0.D0)THEN 
      B000010=1.D0 
      ENDIF 
      B000011=1.D0-B000010 
      B000012=B000009+B000010 
      B000013=B000012**THETA(007) 
      B000014=B000011*B000013 
      TVV2=THETA(002)*B000014 
      B000015=DEXP(ETA(002)) 
      V2=TVV2*B000015 
      B000017=WT/70.D0 
      IF(B000017 == 0.D0.AND.THETA(008) <= 0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE 0**POWER WITH POWER<=0.'
      RETURN
      ENDIF 
      IF(B000017 <  0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE BASE**POWER WITH BASE<0.'
      RETURN
      ENDIF 
      B000018=0.D0 
      IF(B000017 == 0.D0)THEN 
      B000018=1.D0 
      ENDIF 
      B000019=1.D0-B000018 
      B000020=B000017+B000018 
      B000021=B000020**THETA(008) 
      B000022=B000019*B000021 
      TVV3=THETA(003)*B000022 
      V3=TVV3 
      B000023=WT/70.D0 
      IF(B000023 == 0.D0.AND.THETA(009) <= 0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE 0**POWER WITH POWER<=0.'
      RETURN
      ENDIF 
      IF(B000023 <  0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE BASE**POWER WITH BASE<0.'
      RETURN
      ENDIF 
      B000024=0.D0 
      IF(B000023 == 0.D0)THEN 
      B000024=1.D0 
      ENDIF 
      B000025=1.D0-B000024 
      B000026=B000023+B000024 
      B000027=B000026**THETA(009) 
      B000028=B000025*B000027 
      TVQ=THETA(004)*B000028 
      Q=TVQ 
      B000029=DEXP(ETA(003)) 
      KA=THETA(005)*B000029 
      S2=V2/1000.D0 
      K=CL/V2 
      K23=Q/V2 
      K32=Q/V3 
      SUM=K23+K32+K 
      B000040=SUM*SUM-4.D0*K*K32 
      B000041=DSQRT(B000040) 
      SSUM=B000041 
      B000047=SUM+SSUM 
      ALPH=0.5D0*B000047 
      B000048=SUM-SSUM 
      BETA=0.5D0*B000048 
      HLAL=0.693D0/ALPH 
      HLBE=0.693D0/BETA 
      IF (FIRSTEM == 1) THEN
!                      A000032 = DERIVATIVE OF CL W.R.T. ETA(001)
      A000032=TVCL*B000007 
!                      A000036 = DERIVATIVE OF V2 W.R.T. ETA(002)
      A000036=TVV2*B000015 
!                      A000040 = DERIVATIVE OF KA W.R.T. ETA(003)
      A000040=THETA(005)*B000029 
      B000030=1.D0/1000.D0 
!                      A000043 = DERIVATIVE OF S2 W.R.T. ETA(002)
      A000043=B000030*A000036 
      B000031=1.D0/V2 
!                      A000045 = DERIVATIVE OF K W.R.T. ETA(001)
      A000045=B000031*A000032 
      B000032=-CL/V2/V2 
!                      A000046 = DERIVATIVE OF K W.R.T. ETA(002)
      A000046=B000032*A000036 
      B000037=-Q/V2/V2 
!                      A000055 = DERIVATIVE OF K23 W.R.T. ETA(002)
      A000055=B000037*A000036 
!                      A000061 = DERIVATIVE OF SUM W.R.T. ETA(002)
      A000061=A000046+A000055 
!                      A000068 = DERIVATIVE OF B000040 W.R.T. ETA(001)
      A000068=SUM*A000045 
!                      A000069 = DERIVATIVE OF B000040 W.R.T. ETA(002)
      A000069=SUM*A000061 
!                      A000070 = DERIVATIVE OF B000040 W.R.T. ETA(001)
      A000070=SUM*A000045+A000068 
!                      A000071 = DERIVATIVE OF B000040 W.R.T. ETA(002)
      A000071=SUM*A000061+A000069 
      B000042=-4.D0*K32 
!                      A000072 = DERIVATIVE OF B000040 W.R.T. ETA(002)
      A000072=B000042*A000046+A000071 
!                      A000073 = DERIVATIVE OF B000040 W.R.T. ETA(001)
      A000073=B000042*A000045+A000070 
      B000045=.5D0/B000041 
!                      A000076 = DERIVATIVE OF B000041 W.R.T. ETA(001)
      A000076=B000045*A000073 
!                      A000077 = DERIVATIVE OF B000041 W.R.T. ETA(002)
      A000077=B000045*A000072 
!                      A000119 = DERIVATIVE OF B000047 W.R.T. ETA(001)
      A000119=A000076+A000045 
!                      A000120 = DERIVATIVE OF B000047 W.R.T. ETA(002)
      A000120=A000077+A000061 
!                      A000121 = DERIVATIVE OF ALPH W.R.T. ETA(002)
      A000121=0.5D0*A000120 
!                      A000122 = DERIVATIVE OF ALPH W.R.T. ETA(001)
      A000122=0.5D0*A000119 
!                      A000137 = DERIVATIVE OF B000048 W.R.T. ETA(001)
      A000137=-A000076+A000045 
!                      A000138 = DERIVATIVE OF B000048 W.R.T. ETA(002)
      A000138=-A000077+A000061 
!                      A000139 = DERIVATIVE OF BETA W.R.T. ETA(002)
      A000139=0.5D0*A000138 
!                      A000140 = DERIVATIVE OF BETA W.R.T. ETA(001)
      A000140=0.5D0*A000137 
      B000049=-0.693D0/ALPH/ALPH 
!                      A000153 = DERIVATIVE OF HLAL W.R.T. ETA(001)
      A000153=B000049*A000122 
!                      A000154 = DERIVATIVE OF HLAL W.R.T. ETA(002)
      A000154=B000049*A000121 
      B000053=-0.693D0/BETA/BETA 
!                      A000172 = DERIVATIVE OF HLBE W.R.T. ETA(001)
      A000172=B000053*A000140 
!                      A000173 = DERIVATIVE OF HLBE W.R.T. ETA(002)
      A000173=B000053*A000139 
      GG(0001,1,1)=CL
      GG(0001,0002,1)=A000032
      GG(0002,1,1)=V2
      GG(0002,0003,1)=A000036
      GG(0003,1,1)=Q
      GG(0004,1,1)=V3
      GG(0005,1,1)=KA
      GG(0005,0004,1)=A000040
      GG(0006,1,1)=S2
      GG(0006,0003,1)=A000043
      ELSE
      GG(0001,1,1)=CL
      GG(0002,1,1)=V2
      GG(0003,1,1)=Q
      GG(0004,1,1)=V3
      GG(0005,1,1)=KA
      GG(0006,1,1)=S2
      ENDIF
      IF (MSEC == 1) THEN
!                      A000034 = DERIVATIVE OF A000032 W.R.T. ETA(001)
      A000034=TVCL*B000007 
!                      A000038 = DERIVATIVE OF A000036 W.R.T. ETA(002)
      A000038=TVV2*B000015 
!                      A000042 = DERIVATIVE OF A000040 W.R.T. ETA(003)
      A000042=THETA(005)*B000029 
!                      A000044 = DERIVATIVE OF A000043 W.R.T. ETA(002)
      A000044=B000030*A000038 
      B000033=-1.D0/V2/V2 
!                      A000047 = DERIVATIVE OF B000031 W.R.T. ETA(002)
      A000047=B000033*A000036 
!                      A000048 = DERIVATIVE OF A000045 W.R.T. ETA(002)
      A000048=A000032*A000047 
!                      A000049 = DERIVATIVE OF A000045 W.R.T. ETA(001)
      A000049=B000031*A000034 
      B000034=-1.D0/V2/V2 
!                      A000050 = DERIVATIVE OF B000032 W.R.T. ETA(001)
      A000050=B000034*A000032 
      B000035=CL/V2/V2/V2 
!                      A000051 = DERIVATIVE OF B000032 W.R.T. ETA(002)
      A000051=B000035*A000036 
      B000036=CL/V2/V2/V2 
!                      A000052 = DERIVATIVE OF B000032 W.R.T. ETA(002)
      A000052=B000036*A000036+A000051 
!                      A000053 = DERIVATIVE OF A000046 W.R.T. ETA(002)
      A000053=A000036*A000052 
!                      A000054 = DERIVATIVE OF A000046 W.R.T. ETA(002)
      A000054=B000032*A000038+A000053 
      B000038=Q/V2/V2/V2 
!                      A000056 = DERIVATIVE OF B000037 W.R.T. ETA(002)
      A000056=B000038*A000036 
      B000039=Q/V2/V2/V2 
!                      A000057 = DERIVATIVE OF B000037 W.R.T. ETA(002)
      A000057=B000039*A000036+A000056 
!                      A000058 = DERIVATIVE OF A000055 W.R.T. ETA(002)
      A000058=A000036*A000057 
!                      A000059 = DERIVATIVE OF A000055 W.R.T. ETA(002)
      A000059=B000037*A000038+A000058 
!                      A000065 = DERIVATIVE OF A000061 W.R.T. ETA(002)
      A000065=A000059+A000054 
!                      A000080 = DERIVATIVE OF A000068 W.R.T. ETA(002)
      A000080=A000045*A000061 
!                      A000081 = DERIVATIVE OF A000068 W.R.T. ETA(001)
      A000081=A000045*A000045 
!                      A000082 = DERIVATIVE OF A000068 W.R.T. ETA(002)
      A000082=SUM*A000048+A000080 
!                      A000083 = DERIVATIVE OF A000068 W.R.T. ETA(001)
      A000083=SUM*A000049+A000081 
!                      A000084 = DERIVATIVE OF A000069 W.R.T. ETA(002)
      A000084=A000061*A000061 
!                      A000085 = DERIVATIVE OF A000069 W.R.T. ETA(002)
      A000085=SUM*A000065+A000084 
!                      A000086 = DERIVATIVE OF A000070 W.R.T. ETA(002)
      A000086=A000045*A000061 
!                      A000087 = DERIVATIVE OF A000070 W.R.T. ETA(001)
      A000087=A000045*A000045 
!                      A000088 = DERIVATIVE OF A000070 W.R.T. ETA(002)
      A000088=SUM*A000048+A000086 
!                      A000089 = DERIVATIVE OF A000070 W.R.T. ETA(001)
      A000089=SUM*A000049+A000087 
!                      A000090 = DERIVATIVE OF A000070 W.R.T. ETA(001)
      A000090=A000083+A000089 
!                      A000091 = DERIVATIVE OF A000070 W.R.T. ETA(002)
      A000091=A000082+A000088 
!                      A000092 = DERIVATIVE OF A000071 W.R.T. ETA(002)
      A000092=A000061*A000061 
!                      A000093 = DERIVATIVE OF A000071 W.R.T. ETA(002)
      A000093=SUM*A000065+A000092 
!                      A000094 = DERIVATIVE OF A000071 W.R.T. ETA(002)
      A000094=A000085+A000093 
!                      A000095 = DERIVATIVE OF A000072 W.R.T. ETA(002)
      A000095=B000042*A000054 
!                      A000096 = DERIVATIVE OF A000072 W.R.T. ETA(002)
      A000096=A000094+A000095 
!                      A000097 = DERIVATIVE OF A000073 W.R.T. ETA(001)
      A000097=B000042*A000049 
!                      A000098 = DERIVATIVE OF A000073 W.R.T. ETA(002)
      A000098=B000042*A000048 
!                      A000099 = DERIVATIVE OF A000073 W.R.T. ETA(002)
      A000099=A000091+A000098 
!                      A000100 = DERIVATIVE OF A000073 W.R.T. ETA(001)
      A000100=A000090+A000097 
      B000046=-.5D0/B000041/B000041 
!                      A000106 = DERIVATIVE OF B000045 W.R.T. ETA(002)
      A000106=B000046*A000077 
!                      A000107 = DERIVATIVE OF B000045 W.R.T. ETA(001)
      A000107=B000046*A000076 
!                      A000108 = DERIVATIVE OF A000076 W.R.T. ETA(001)
      A000108=A000073*A000107 
!                      A000109 = DERIVATIVE OF A000076 W.R.T. ETA(002)
      A000109=A000073*A000106 
!                      A000110 = DERIVATIVE OF A000076 W.R.T. ETA(001)
      A000110=B000045*A000100+A000108 
!                      A000111 = DERIVATIVE OF A000076 W.R.T. ETA(002)
      A000111=B000045*A000099+A000109 
!                      A000112 = DERIVATIVE OF A000077 W.R.T. ETA(002)
      A000112=A000072*A000106 
!                      A000113 = DERIVATIVE OF A000077 W.R.T. ETA(002)
      A000113=B000045*A000096+A000112 
!                      A000128 = DERIVATIVE OF A000119 W.R.T. ETA(001)
      A000128=A000049+A000110 
!                      A000129 = DERIVATIVE OF A000119 W.R.T. ETA(002)
      A000129=A000048+A000111 
!                      A000131 = DERIVATIVE OF A000120 W.R.T. ETA(002)
      A000131=A000065+A000113 
!                      A000132 = DERIVATIVE OF A000121 W.R.T. ETA(002)
      A000132=0.5D0*A000131 
!                      A000133 = DERIVATIVE OF A000122 W.R.T. ETA(002)
      A000133=0.5D0*A000129 
!                      A000134 = DERIVATIVE OF A000122 W.R.T. ETA(001)
      A000134=0.5D0*A000128 
!                      A000144 = DERIVATIVE OF A000137 W.R.T. ETA(001)
      A000144=-A000110 
!                      A000145 = DERIVATIVE OF A000137 W.R.T. ETA(002)
      A000145=-A000111 
!                      A000146 = DERIVATIVE OF A000137 W.R.T. ETA(001)
      A000146=A000049+A000144 
!                      A000147 = DERIVATIVE OF A000137 W.R.T. ETA(002)
      A000147=A000048+A000145 
!                      A000148 = DERIVATIVE OF A000138 W.R.T. ETA(002)
      A000148=-A000113 
!                      A000149 = DERIVATIVE OF A000138 W.R.T. ETA(002)
      A000149=A000065+A000148 
!                      A000150 = DERIVATIVE OF A000139 W.R.T. ETA(002)
      A000150=0.5D0*A000149 
!                      A000151 = DERIVATIVE OF A000140 W.R.T. ETA(002)
      A000151=0.5D0*A000147 
!                      A000152 = DERIVATIVE OF A000140 W.R.T. ETA(001)
      A000152=0.5D0*A000146 
      B000051=0.693D0/ALPH/ALPH/ALPH 
!                      A000157 = DERIVATIVE OF B000049 W.R.T. ETA(002)
      A000157=B000051*A000121 
!                      A000158 = DERIVATIVE OF B000049 W.R.T. ETA(001)
      A000158=B000051*A000122 
      B000052=0.693D0/ALPH/ALPH/ALPH 
!                      A000159 = DERIVATIVE OF B000049 W.R.T. ETA(002)
      A000159=B000052*A000121+A000157 
!                      A000160 = DERIVATIVE OF B000049 W.R.T. ETA(001)
      A000160=B000052*A000122+A000158 
!                      A000161 = DERIVATIVE OF A000153 W.R.T. ETA(001)
      A000161=A000122*A000160 
!                      A000162 = DERIVATIVE OF A000153 W.R.T. ETA(002)
      A000162=A000122*A000159 
!                      A000163 = DERIVATIVE OF A000153 W.R.T. ETA(001)
      A000163=B000049*A000134+A000161 
!                      A000164 = DERIVATIVE OF A000153 W.R.T. ETA(002)
      A000164=B000049*A000133+A000162 
!                      A000165 = DERIVATIVE OF A000154 W.R.T. ETA(002)
      A000165=A000121*A000159 
!                      A000166 = DERIVATIVE OF A000154 W.R.T. ETA(002)
      A000166=B000049*A000132+A000165 
      B000055=0.693D0/BETA/BETA/BETA 
!                      A000176 = DERIVATIVE OF B000053 W.R.T. ETA(002)
      A000176=B000055*A000139 
!                      A000177 = DERIVATIVE OF B000053 W.R.T. ETA(001)
      A000177=B000055*A000140 
      B000056=0.693D0/BETA/BETA/BETA 
!                      A000178 = DERIVATIVE OF B000053 W.R.T. ETA(002)
      A000178=B000056*A000139+A000176 
!                      A000179 = DERIVATIVE OF B000053 W.R.T. ETA(001)
      A000179=B000056*A000140+A000177 
!                      A000180 = DERIVATIVE OF A000172 W.R.T. ETA(001)
      A000180=A000140*A000179 
!                      A000181 = DERIVATIVE OF A000172 W.R.T. ETA(002)
      A000181=A000140*A000178 
!                      A000182 = DERIVATIVE OF A000172 W.R.T. ETA(001)
      A000182=B000053*A000152+A000180 
!                      A000183 = DERIVATIVE OF A000172 W.R.T. ETA(002)
      A000183=B000053*A000151+A000181 
!                      A000184 = DERIVATIVE OF A000173 W.R.T. ETA(002)
      A000184=A000139*A000178 
!                      A000185 = DERIVATIVE OF A000173 W.R.T. ETA(002)
      A000185=B000053*A000150+A000184 
      GG(0001,0002,0002)=A000034
      GG(0002,0003,0003)=A000038
      GG(0005,0004,0004)=A000042
      GG(0006,0003,0003)=A000044
      ENDIF
      RETURN
      END
      SUBROUTINE ERROR (ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,F,G,HH)       
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMPRD_REAL,ONLY: ETA,EPS                                            
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,IQUIT,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE NMPRD_INT, ONLY: NEWL2
      USE PROCM_INT, ONLY: NEWIND=>PNEWIF                                       
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                        
      REAL(KIND=DPSIZE) :: EVTREC                                             
      SAVE
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS                       
      DIMENSION :: IDEF(*),THETA(*),EVTREC(IREV,*),INDXS(*)                   
      REAL(KIND=DPSIZE) :: G(GERD,*),HH(HERD,*)                               
      INTEGER(KIND=ISIZE) :: FIRSTEM
      FIRSTEM=IFIRSTEM
      IF (ICALL <= 1) THEN                                                    
      CALL ASSOCNMPRD4
      IDEF(2)=-1
      IDEF(3)=000
      RETURN
      ENDIF
      IF (ICALL == 4) THEN
      IF (NEWL2 == 1) THEN
      CALL SIMEPS(EPS)
      IF (IQUIT == 1) RETURN
      ENDIF
      ENDIF
      D000001=G(001,1)
      D000002=G(002,1)
      D000003=G(003,1)
 !  level            0
      IPRED=F 
      B000001=DEXP(EPS(001)) 
      Y=F*B000001 
!                      C000032 = DERIVATIVE OF Y W.R.T. EPS(001)
      C000032=F*B000001 
      IF (FIRSTEM == 1) THEN !1
!                      D000058 = DERIVATIVE OF C000032 W.R.T. ETA(003)
      D000058=B000001*D000003 
!                      D000059 = DERIVATIVE OF C000032 W.R.T. ETA(002)
      D000059=B000001*D000002 
!                      D000060 = DERIVATIVE OF C000032 W.R.T. ETA(001)
      D000060=B000001*D000001 
      ENDIF !1
      HH(001,1)=C000032
      IF (FIRSTEM == 1) THEN !2
      HH(001,002)=D000060
      HH(001,003)=D000059
      HH(001,004)=D000058
      ENDIF !2
      F=Y
      RETURN
      END
      SUBROUTINE FSIZESR(NAME_FSIZES,F_SIZES)
      USE SIZES, ONLY: ISIZE
      INTEGER(KIND=ISIZE), DIMENSION(*) :: F_SIZES
      CHARACTER(LEN=*),    DIMENSION(*) :: NAME_FSIZES
      NAME_FSIZES(01)='LTH'; F_SIZES(01)=9
      NAME_FSIZES(02)='LVR'; F_SIZES(02)=4
      NAME_FSIZES(03)='LVR2'; F_SIZES(03)=0
      NAME_FSIZES(04)='LPAR'; F_SIZES(04)=16
      NAME_FSIZES(05)='LPAR3'; F_SIZES(05)=0
      NAME_FSIZES(06)='NO'; F_SIZES(06)=0
      NAME_FSIZES(07)='MMX'; F_SIZES(07)=1
      NAME_FSIZES(08)='LNP4'; F_SIZES(08)=0
      NAME_FSIZES(09)='LSUPP'; F_SIZES(09)=1
      NAME_FSIZES(10)='LIM7'; F_SIZES(10)=0
      NAME_FSIZES(11)='LWS3'; F_SIZES(11)=0
      NAME_FSIZES(12)='MAXIDS'; F_SIZES(12)=193
      NAME_FSIZES(13)='LIM1'; F_SIZES(13)=0
      NAME_FSIZES(14)='LIM2'; F_SIZES(14)=0
      NAME_FSIZES(15)='LIM3'; F_SIZES(15)=0
      NAME_FSIZES(16)='LIM4'; F_SIZES(16)=0
      NAME_FSIZES(17)='LIM5'; F_SIZES(17)=0
      NAME_FSIZES(18)='LIM6'; F_SIZES(18)=0
      NAME_FSIZES(19)='LIM8'; F_SIZES(19)=0
      NAME_FSIZES(20)='LIM10'; F_SIZES(20)=0
      NAME_FSIZES(21)='LIM11'; F_SIZES(21)=0
      NAME_FSIZES(22)='LIM13'; F_SIZES(22)=0
      NAME_FSIZES(23)='LIM15'; F_SIZES(23)=0
      NAME_FSIZES(24)='LIM16'; F_SIZES(24)=0
      NAME_FSIZES(25)='MAXRECID'; F_SIZES(25)=0
      NAME_FSIZES(26)='PC'; F_SIZES(26)=0
      NAME_FSIZES(27)='PCT'; F_SIZES(27)=1
      NAME_FSIZES(28)='PIR'; F_SIZES(28)=1
      NAME_FSIZES(29)='PD'; F_SIZES(29)=9
      NAME_FSIZES(30)='PAL'; F_SIZES(30)=0
      NAME_FSIZES(31)='MAXFCN'; F_SIZES(31)=0
      NAME_FSIZES(32)='MAXIC'; F_SIZES(32)=0
      NAME_FSIZES(33)='PG'; F_SIZES(33)=0
      NAME_FSIZES(34)='NPOPMIXMAX'; F_SIZES(34)=0
      NAME_FSIZES(35)='MAXOMEG'; F_SIZES(35)=3
      NAME_FSIZES(36)='MAXPTHETA'; F_SIZES(36)=10
      NAME_FSIZES(37)='MAXITER'; F_SIZES(37)=20
      NAME_FSIZES(38)='ISAMPLEMAX'; F_SIZES(38)=0
      NAME_FSIZES(39)='DIMTMP'; F_SIZES(39)=0
      NAME_FSIZES(40)='DIMCNS'; F_SIZES(40)=0
      NAME_FSIZES(41)='DIMNEW'; F_SIZES(41)=0
      NAME_FSIZES(42)='PDT'; F_SIZES(42)=14
      NAME_FSIZES(43)='LADD_MAX'; F_SIZES(43)=0
      NAME_FSIZES(44)='MAXSIDL'; F_SIZES(44)=0
      NAME_FSIZES(45)='NTT'; F_SIZES(45)=9
      NAME_FSIZES(46)='NOMEG'; F_SIZES(46)=3
      NAME_FSIZES(47)='NSIGM'; F_SIZES(47)=1
      NAME_FSIZES(48)='PPDT'; F_SIZES(48)=8
      RETURN
      END SUBROUTINE FSIZESR
      SUBROUTINE MUMODEL2(THETA,MU_,ICALL,IDEF,NEWIND,&
      EVTREC,DATREC,IREV,NVNT,INDXS,F,G,H,IRGG,GG,NETAS)
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMBAYES_REAL,    ONLY: PRIORINFO
      USE NMPRD_INT, ONLY: IERPRD,IERPRDU,NETEXT,IQUIT
      USE NMPRD_CHAR,ONLY: ETEXT
      USE NMPRD_REAL,ONLY: ETA,EPS
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,COMACT,COMSAV,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE NMBAYES_REAL, ONLY: LDF
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)
      REAL(KIND=DPSIZE)   :: MU_(*)
      INTEGER NEWIND
      REAL(KIND=DPSIZE) :: EVTREC
      SAVE
      INTEGER(KIND=ISIZE) :: FIRSTEM
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS
      DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*),GG(IRGG,GPKD+1,*)
      RETURN
      END
