      MODULE NMPRD4P
      USE SIZES, ONLY: DPSIZE
      USE NMPRD4,ONLY: VRBL
      IMPLICIT NONE
      SAVE
      REAL(KIND=DPSIZE), DIMENSION (:),POINTER ::COM
      REAL(KIND=DPSIZE), POINTER ::TVVMAX,VMAX,KM,TVCLL,CLL,TVV1,V1
      REAL(KIND=DPSIZE), POINTER ::TVV2,V2,Q,S1,C1,C2,Y,IPRED,A000032
      REAL(KIND=DPSIZE), POINTER ::A000034,A000036,A000038,A000040
      REAL(KIND=DPSIZE), POINTER ::A000042,A000043,A000044,A000045
      REAL(KIND=DPSIZE), POINTER ::A000046,A000047,A000048,A000049
      REAL(KIND=DPSIZE), POINTER ::A000050,E000017,E000018,F000106
      REAL(KIND=DPSIZE), POINTER ::F000108,F000103,F000105,F000109
      REAL(KIND=DPSIZE), POINTER ::F000100,E000060,E000061,F000180
      REAL(KIND=DPSIZE), POINTER ::F000182,F000183,C000032,D000051
      REAL(KIND=DPSIZE), POINTER ::D000050,D000049
      CONTAINS
      SUBROUTINE ASSOCNMPRD4
      COM=>VRBL
      TVVMAX=>COM(000001);VMAX=>COM(000002);KM=>COM(000003)
      TVCLL=>COM(000004);CLL=>COM(000005);TVV1=>COM(000006)
      V1=>COM(000007);TVV2=>COM(000008);V2=>COM(000009);Q=>COM(000010)
      S1=>COM(000011);C1=>COM(000012);C2=>COM(000013);Y=>COM(000014)
      IPRED=>COM(000015);A000032=>COM(000016);A000034=>COM(000017)
      A000036=>COM(000018);A000038=>COM(000019);A000040=>COM(000020)
      A000042=>COM(000021);A000043=>COM(000022);A000044=>COM(000023)
      A000045=>COM(000024);A000046=>COM(000025);A000047=>COM(000026)
      A000048=>COM(000027);A000049=>COM(000028);A000050=>COM(000029)
      E000017=>COM(000030);E000018=>COM(000031);F000106=>COM(000032)
      F000108=>COM(000033);F000103=>COM(000034);F000105=>COM(000035)
      F000109=>COM(000036);F000100=>COM(000037);E000060=>COM(000038)
      E000061=>COM(000039);F000180=>COM(000040);F000182=>COM(000041)
      F000183=>COM(000042);C000032=>COM(000043);D000051=>COM(000044)
      D000050=>COM(000045);D000049=>COM(000046)
      END SUBROUTINE ASSOCNMPRD4
      END MODULE NMPRD4P
      SUBROUTINE MODEL (IDNO,NCM,NPAR,IR,IATT,LINK)                           
      USE PRMOD_CHAR, ONLY: NAME                                              
      USE SIZES,     ONLY: DPSIZE,ISIZE,SD
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      INTEGER(KIND=ISIZE) :: IDNO,NCM,NPAR,IR,IATT,LINK,I,J                   
      DIMENSION :: IATT(IR,*),LINK(IR,*)                                      
      SAVE
      INTEGER(KIND=ISIZE), DIMENSION (2,7) :: MOD
      CHARACTER(LEN=SD), DIMENSION(2) :: CMOD
      DATA (MOD(I,  1),I=  1,  2)/&
      1,1 /
      DATA (MOD(I,  2),I=  1,  2)/&
      1,1 /
      DATA (MOD(I,  3),I=  1,  2)/&
      1,1 /
      DATA (MOD(I,  4),I=  1,  2)/&
      1,0 /
      DATA (MOD(I,  5),I=  1,  2)/&
      1,0 /
      DATA (MOD(I,  6),I=  1,  2)/&
      0,0 /
      DATA (MOD(I,  7),I=  1,  2)/&
      0,0 /
      DATA (CMOD(I),I=  1,  2) &
      /'CENTRAL','PERIPH'/
      FORALL (I=1:2) NAME(I)=CMOD(I)
      FORALL (I=1:2,J=1:7) IATT(I,J)=MOD(I,J)
      IDNO=9999                                                               
      NCM=  2
      NPAR=010
      RETURN
      END
      SUBROUTINE PK(ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,IRGG,GG,NETAS)      
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMBAYES_REAL,    ONLY: PRIORINFO
      USE NMPRD_INT, ONLY: IERPRD,IERPRDU,NETEXT,IQUIT                        
      USE NMPRD_CHAR,ONLY: ETEXT                                              
      USE NMPRD_REAL,ONLY: ETA,EPS                                            
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,COMACT,COMSAV,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE PROCM_INT, ONLY: NEWIND=>PNEWIF                                       
      USE NMBAYES_REAL, ONLY: LDF                                             
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                          
      REAL(KIND=DPSIZE) :: EVTREC                                               
      SAVE
      INTEGER(KIND=ISIZE) :: FIRSTEM
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS              
      DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*),GG(IRGG,GPKD+1,*) 
      FIRSTEM=IFIRSTEM
      IF (ICALL <= 1) THEN                                                      
      CALL ASSOCNMPRD4
      IDEF(   1,0001)=  -9
      IDEF(   1,0002)=  -1
      IDEF(   1,0003)=   0
      IDEF(   1,0004)=   0
      IDEF(   2,0003)=   0
      IDEF(   2,0004)=   0
      IDEF(   3,0001)=  11
      CALL GETETA(ETA)                                                          
      IF (IQUIT == 1) RETURN                                                    
      RETURN                                                                    
      ENDIF                                                                     
      IF (NEWIND /= 2) THEN
      IF (ICALL == 4) THEN
      CALL SIMETA(ETA)
      ELSE
      CALL GETETA(ETA)
      ENDIF
      IF (IQUIT == 1) RETURN
      ENDIF
 !  level            0
      WGTI=EVTREC(NVNT,009)
      B000001=WGTI/72.D0 
      IF(B000001 == 0.D0.AND.THETA(007) <= 0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE 0**POWER WITH POWER<=0.'
      RETURN
      ENDIF 
      IF(B000001 <  0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE BASE**POWER WITH BASE<0.'
      RETURN
      ENDIF 
      B000002=0.D0 
      IF(B000001 == 0.D0)THEN 
      B000002=1.D0 
      ENDIF 
      B000003=1.D0-B000002 
      B000004=B000001+B000002 
      B000005=B000004**THETA(007) 
      B000006=B000003*B000005 
      TVVMAX=THETA(001)*B000006 
      B000007=DEXP(ETA(001)) 
      VMAX=TVVMAX*B000007 
      KM=THETA(002) 
      B000009=WGTI/72.D0 
      IF(B000009 == 0.D0.AND.THETA(008) <= 0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE 0**POWER WITH POWER<=0.'
      RETURN
      ENDIF 
      IF(B000009 <  0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE BASE**POWER WITH BASE<0.'
      RETURN
      ENDIF 
      B000010=0.D0 
      IF(B000009 == 0.D0)THEN 
      B000010=1.D0 
      ENDIF 
      B000011=1.D0-B000010 
      B000012=B000009+B000010 
      B000013=B000012**THETA(008) 
      B000014=B000011*B000013 
      TVCLL=THETA(003)*B000014 
      B000015=DEXP(ETA(002)) 
      CLL=TVCLL*B000015 
      B000017=WGTI/72.D0 
      IF(B000017 == 0.D0.AND.THETA(009) <= 0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE 0**POWER WITH POWER<=0.'
      RETURN
      ENDIF 
      IF(B000017 <  0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE BASE**POWER WITH BASE<0.'
      RETURN
      ENDIF 
      B000018=0.D0 
      IF(B000017 == 0.D0)THEN 
      B000018=1.D0 
      ENDIF 
      B000019=1.D0-B000018 
      B000020=B000017+B000018 
      B000021=B000020**THETA(009) 
      B000022=B000019*B000021 
      TVV1=THETA(004)*B000022 
      B000023=DEXP(ETA(003)) 
      V1=TVV1*B000023 
      B000025=WGTI/72.D0 
      IF(B000025 == 0.D0.AND.THETA(010) <= 0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE 0**POWER WITH POWER<=0.'
      RETURN
      ENDIF 
      IF(B000025 <  0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE BASE**POWER WITH BASE<0.'
      RETURN
      ENDIF 
      B000026=0.D0 
      IF(B000025 == 0.D0)THEN 
      B000026=1.D0 
      ENDIF 
      B000027=1.D0-B000026 
      B000028=B000025+B000026 
      B000029=B000028**THETA(010) 
      B000030=B000027*B000029 
      TVV2=THETA(005)*B000030 
      V2=TVV2 
      Q=THETA(006) 
      S1=V1 
      P000001=V1 
      P000002=V2 
      P000003=KM 
      P000004=CLL 
      P000005=Q 
      P000006=VMAX 
      IF (FIRSTEM == 1) THEN
!                      A000032 = DERIVATIVE OF VMAX W.R.T. ETA(001)
      A000032=TVVMAX*B000007 
!                      A000036 = DERIVATIVE OF CLL W.R.T. ETA(002)
      A000036=TVCLL*B000015 
!                      A000040 = DERIVATIVE OF V1 W.R.T. ETA(003)
      A000040=TVV1*B000023 
!                      A000043 = DERIVATIVE OF S1 W.R.T. ETA(003)
      A000043=A000040 
!                      A000045 = DERIVATIVE OF P000001 W.R.T. ETA(003)
      A000045=A000040 
!                      A000047 = DERIVATIVE OF P000004 W.R.T. ETA(002)
      A000047=A000036 
!                      A000049 = DERIVATIVE OF P000006 W.R.T. ETA(001)
      A000049=A000032 
      GG(0001,1,1)=P000001
      GG(0001,0004,1)=A000045
      GG(0002,1,1)=P000002
      GG(0003,1,1)=P000003
      GG(0004,1,1)=P000004
      GG(0004,0003,1)=A000047
      GG(0005,1,1)=P000005
      GG(0006,1,1)=P000006
      GG(0006,0002,1)=A000049
      GG(0011,1,1)=S1
      GG(0011,0004,1)=A000043
      ELSE
      GG(0001,1,1)=P000001
      GG(0002,1,1)=P000002
      GG(0003,1,1)=P000003
      GG(0004,1,1)=P000004
      GG(0005,1,1)=P000005
      GG(0006,1,1)=P000006
      GG(0011,1,1)=S1
      ENDIF
      IF (MSEC == 1) THEN
!                      A000034 = DERIVATIVE OF A000032 W.R.T. ETA(001)
      A000034=TVVMAX*B000007 
!                      A000038 = DERIVATIVE OF A000036 W.R.T. ETA(002)
      A000038=TVCLL*B000015 
!                      A000042 = DERIVATIVE OF A000040 W.R.T. ETA(003)
      A000042=TVV1*B000023 
!                      A000044 = DERIVATIVE OF A000043 W.R.T. ETA(003)
      A000044=A000042 
!                      A000046 = DERIVATIVE OF A000045 W.R.T. ETA(003)
      A000046=A000042 
!                      A000048 = DERIVATIVE OF A000047 W.R.T. ETA(002)
      A000048=A000038 
!                      A000050 = DERIVATIVE OF A000049 W.R.T. ETA(001)
      A000050=A000034 
      GG(0001,0004,0004)=A000046
      GG(0004,0003,0003)=A000048
      GG(0006,0002,0002)=A000050
      GG(0011,0004,0004)=A000044
      ENDIF
      RETURN
      END
      SUBROUTINE ERROR (ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,F,G,HH)       
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMPRD_REAL,ONLY: ETA,EPS                                            
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,IQUIT,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE NMPRD_INT, ONLY: NEWL2
      USE PROCM_INT, ONLY: NEWIND=>PNEWIF                                       
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                        
      REAL(KIND=DPSIZE) :: EVTREC                                             
      SAVE
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS                       
      DIMENSION :: IDEF(*),THETA(*),EVTREC(IREV,*),INDXS(*)                   
      REAL(KIND=DPSIZE) :: G(GERD,*),HH(HERD,*)                               
      INTEGER(KIND=ISIZE) :: FIRSTEM
      FIRSTEM=IFIRSTEM
      IF (ICALL <= 1) THEN                                                    
      CALL ASSOCNMPRD4
      IDEF(2)=-1
      IDEF(3)=000
      RETURN
      ENDIF
      IF (ICALL == 4) THEN
      IF (NEWL2 == 1) THEN
      CALL SIMEPS(EPS)
      IF (IQUIT == 1) RETURN
      ENDIF
      ENDIF
      D000001=G(001,1)
      D000002=G(002,1)
      D000003=G(003,1)
 !  level            0
      B000001=DEXP(EPS(001)) 
      Y=F*B000001 
!                      C000032 = DERIVATIVE OF Y W.R.T. EPS(001)
      C000032=F*B000001 
      IPRED=F 
      IF (FIRSTEM == 1) THEN !1
!                      D000049 = DERIVATIVE OF C000032 W.R.T. ETA(003)
      D000049=B000001*D000003 
!                      D000050 = DERIVATIVE OF C000032 W.R.T. ETA(002)
      D000050=B000001*D000002 
!                      D000051 = DERIVATIVE OF C000032 W.R.T. ETA(001)
      D000051=B000001*D000001 
      ENDIF !1
      HH(001,1)=C000032
      IF (FIRSTEM == 1) THEN !2
      HH(001,002)=D000051
      HH(001,003)=D000050
      HH(001,004)=D000049
      ENDIF !2
      F=Y
      RETURN
      END
      SUBROUTINE TOL(NRD,ANRD,NRDC,ANRDC)
      USE SIZES,     ONLY: ISIZE
      INTEGER(KIND=ISIZE) :: NRD(0:*), ANRD(0:*), NRDC(0:*), ANRDC(0:*)
      NRD(1)=8 
      RETURN
      END
      SUBROUTINE DES (A,P,T,DADT,IR,DA,DP,DT)                                 
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMPRD_INT, ONLY: IERPRD,IERPRDU,NETEXT,IQUIT                        
      USE NMPRD_CHAR,ONLY: ETEXT                                              
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,IFIRSTEM,IFIRSTEMJAC
      USE PRCOM_INT, ONLY: MITER
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE PRMOD_INT, ONLY: ICALL=>ICALLD,IDEFD,IDEFA
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                        
      SAVE
      INTEGER(KIND=ISIZE) :: IR                                               
      DIMENSION :: A(*),P(*),DADT(*),DA(IR,*),DP(IR,*),DT(*)                  
      INTEGER(KIND=ISIZE) :: FIRSTEM,IFIRSTEMJACIN
      IF(MITER==1.OR.MITER==4) IFIRSTEM=1
      FIRSTEM=IFIRSTEM
      IFIRSTEMJACIN=IFIRSTEMJAC
      IF(NOFIRSTDERCODE/=1) THEN
      IFIRSTEMJAC=FIRSTEM
      ELSE
      IFIRSTEMJAC=0
      ENDIF
      IF(IFIRSTEMJACIN==-2) RETURN
      IF (ICALL == 1) THEN
      CALL ASSOCNMPRD4
      IDEFD(1)=  0
      IDEFD(2)=0
      DA(   1,1)=0000014280
      DA(   2,1)=0000014399
      DA(   3,1)=0000028441
      DA(   4,1)=0000028560
      DA(   5,1)=0000014281
      DA(   6,1)=0000014311
      DA(   7,1)=0000014313
      DA(   8,1)=0000014316
      DA(   9,1)=0000028472
      DA(  10,1)=0000014431
      DA(  11,1)=0000028592
      DA(  12,1)=0000000000
      DP(   1,1)=0000014280
      DP(   2,1)=0000014399
      DP(   3,1)=0000014518
      DP(   4,1)=0000014637
      DP(   5,1)=0000014756
      DP(   6,1)=0000014875
      DP(   7,1)=0000028441
      DP(   8,1)=0000028560
      DP(   9,1)=0000028917
      DP(  10,1)=0000014281
      DP(  11,1)=0000014519
      DP(  12,1)=0000014638
      DP(  13,1)=0000014757
      DP(  14,1)=0000014876
      DP(  15,1)=0000028442
      DP(  16,1)=0000028918
      DP(  17,1)=0000014401
      DP(  18,1)=0000014758
      DP(  19,1)=0000028562
      DP(  20,1)=0000028919
      DP(  21,1)=0000014283
      DP(  22,1)=0000014521
      DP(  23,1)=0000014878
      DP(  24,1)=0000014284
      DP(  25,1)=0000014285
      DP(  26,1)=0000014404
      DP(  27,1)=0000028446
      DP(  28,1)=0000028565
      DP(  29,1)=0000014286
      DP(  30,1)=0000014524
      DP(  31,1)=0000000000
      DT(   1)=0000000000
      RETURN
      ENDIF
 !  level            0
 !  level            0
      C1=A(1)/P(001) 
      C2=A(2)/P(002) 
      B000011=P(003)+C1 
      B000012=P(004)*C1 
      B000013=P(005)*C1 
      B000014=P(005)*C2 
      DADT(1)=-P(006)*C1/B000011-B000012-B000013+B000014 
      B000041=P(005)*C1 
      B000042=P(005)*C2 
      DADT(2)=B000041-B000042 
      IF (FIRSTEM == 1) THEN ! 1
      B000001=1.D0/P(001) 
      B000002=-A(1)/P(001)/P(001) 
      B000006=1.D0/P(002) 
      B000007=-A(2)/P(002)/P(002) 
!                      E000011 = DERIVATIVE OF B000012 W.R.T. A(001)
      E000011=P(004)*B000001 
!                      E000012 = DERIVATIVE OF B000013 W.R.T. A(001)
      E000012=P(005)*B000001 
!                      E000013 = DERIVATIVE OF B000014 W.R.T. A(002)
      E000013=P(005)*B000006 
      B000015=-P(006)/B000011 
!                      E000014 = DERIVATIVE OF DADT(1) W.R.T. A(001)
      E000014=B000015*B000001 
      B000016=P(006)*C1/B000011/B000011 
!                      E000015 = DERIVATIVE OF DADT(1) W.R.T. A(001)
      E000015=B000016*B000001+E000014 
!                      E000016 = DERIVATIVE OF DADT(1) W.R.T. A(001)
      E000016=-E000011+E000015 
!                      E000017 = DERIVATIVE OF DADT(1) W.R.T. A(001)
      E000017=-E000012+E000016 
!                      E000018 = DERIVATIVE OF DADT(1) W.R.T. A(002)
      E000018=E000013 
!                      F000092 = DERIVATIVE OF B000012 W.R.T. P(001)
      F000092=P(004)*B000002 
!                      F000095 = DERIVATIVE OF B000013 W.R.T. P(001)
      F000095=P(005)*B000002 
!                      F000098 = DERIVATIVE OF B000014 W.R.T. P(002)
      F000098=P(005)*B000007 
      B000025=-C1/B000011 
!                      F000100 = DERIVATIVE OF DADT(1) W.R.T. P(006)
      F000100=B000025 
      B000026=-P(006)/B000011 
!                      F000101 = DERIVATIVE OF DADT(1) W.R.T. P(001)
      F000101=B000026*B000002 
      B000027=P(006)*C1/B000011/B000011 
!                      F000102 = DERIVATIVE OF DADT(1) W.R.T. P(001)
      F000102=B000027*B000002+F000101 
!                      F000103 = DERIVATIVE OF DADT(1) W.R.T. P(003)
      F000103=B000027 
!                      F000104 = DERIVATIVE OF DADT(1) W.R.T. P(001)
      F000104=-F000092+F000102 
!                      F000105 = DERIVATIVE OF DADT(1) W.R.T. P(004)
      F000105=-C1 
!                      F000106 = DERIVATIVE OF DADT(1) W.R.T. P(001)
      F000106=-F000095+F000104 
!                      F000107 = DERIVATIVE OF DADT(1) W.R.T. P(005)
      F000107=-C1 
!                      F000108 = DERIVATIVE OF DADT(1) W.R.T. P(002)
      F000108=F000098 
!                      F000109 = DERIVATIVE OF DADT(1) W.R.T. P(005)
      F000109=C2+F000107 
!                      E000058 = DERIVATIVE OF B000041 W.R.T. A(001)
      E000058=P(005)*B000001 
!                      E000059 = DERIVATIVE OF B000042 W.R.T. A(002)
      E000059=P(005)*B000006 
!                      E000060 = DERIVATIVE OF DADT(2) W.R.T. A(001)
      E000060=E000058 
!                      E000061 = DERIVATIVE OF DADT(2) W.R.T. A(002)
      E000061=-E000059 
!                      F000175 = DERIVATIVE OF B000041 W.R.T. P(001)
      F000175=P(005)*B000002 
!                      F000178 = DERIVATIVE OF B000042 W.R.T. P(002)
      F000178=P(005)*B000007 
!                      F000180 = DERIVATIVE OF DADT(2) W.R.T. P(001)
      F000180=F000175 
!                      F000181 = DERIVATIVE OF DADT(2) W.R.T. P(005)
      F000181=C1 
!                      F000182 = DERIVATIVE OF DADT(2) W.R.T. P(002)
      F000182=-F000178 
!                      F000183 = DERIVATIVE OF DADT(2) W.R.T. P(005)
      F000183=-C2+F000181 
      ENDIF !1
      IF (MSEC == 1) THEN 
      B000003=A(1)/P(001)/P(001)/P(001) 
      B000004=A(1)/P(001)/P(001)/P(001) 
!                      F000083 = DERIVATIVE OF B000002 W.R.T. P(001)
      F000083=B000004+B000003 
!                      F000084 = DERIVATIVE OF F000081 W.R.T. P(001)
      F000084=F000083 
      B000005=-1.D0/P(001)/P(001) 
!                      E000006 = DERIVATIVE OF F000081 W.R.T. A(001)
      E000006=B000005 
      B000008=A(2)/P(002)/P(002)/P(002) 
      B000009=A(2)/P(002)/P(002)/P(002) 
!                      F000087 = DERIVATIVE OF B000007 W.R.T. P(002)
      F000087=B000009+B000008 
!                      F000088 = DERIVATIVE OF F000085 W.R.T. P(002)
      F000088=F000087 
      B000010=-1.D0/P(002)/P(002) 
!                      E000009 = DERIVATIVE OF F000085 W.R.T. A(002)
      E000009=B000010 
      B000018=P(006)/B000011/B000011 
!                      E000020 = DERIVATIVE OF B000015 W.R.T. A(001)
      E000020=B000018*B000001 
!                      E000021 = DERIVATIVE OF E000014 W.R.T. A(001)
      E000021=B000001*E000020 
      B000019=P(006)/B000011/B000011 
!                      E000022 = DERIVATIVE OF B000016 W.R.T. A(001)
      E000022=B000019*B000001 
      B000020=-P(006)*C1/B000011/B000011/B000011 
!                      E000023 = DERIVATIVE OF B000016 W.R.T. A(001)
      E000023=B000020*B000001+E000022 
      B000021=-P(006)*C1/B000011/B000011/B000011 
!                      E000024 = DERIVATIVE OF B000016 W.R.T. A(001)
      E000024=B000021*B000001+E000023 
!                      E000025 = DERIVATIVE OF E000015 W.R.T. A(001)
      E000025=B000001*E000024 
!                      E000026 = DERIVATIVE OF E000015 W.R.T. A(001)
      E000026=E000021+E000025 
!                      E000027 = DERIVATIVE OF E000016 W.R.T. A(001)
      E000027=E000026 
!                      E000028 = DERIVATIVE OF E000017 W.R.T. A(001)
      E000028=E000027 
!                      F000111 = DERIVATIVE OF F000090 W.R.T. P(001)
      F000111=F000084 
!                      F000112 = DERIVATIVE OF F000091 W.R.T. P(001)
      F000112=B000002 
!                      F000113 = DERIVATIVE OF F000092 W.R.T. P(004)
      F000113=B000002 
!                      F000114 = DERIVATIVE OF F000092 W.R.T. P(001)
      F000114=P(004)*F000084 
!                      F000116 = DERIVATIVE OF F000093 W.R.T. P(001)
      F000116=F000084 
!                      F000117 = DERIVATIVE OF F000094 W.R.T. P(001)
      F000117=B000002 
!                      F000118 = DERIVATIVE OF F000095 W.R.T. P(005)
      F000118=B000002 
!                      F000119 = DERIVATIVE OF F000095 W.R.T. P(001)
      F000119=P(005)*F000084 
!                      F000121 = DERIVATIVE OF F000096 W.R.T. P(001)
      F000121=F000084 
!                      F000122 = DERIVATIVE OF F000097 W.R.T. P(002)
      F000122=B000007 
!                      F000123 = DERIVATIVE OF F000098 W.R.T. P(005)
      F000123=B000007 
!                      F000124 = DERIVATIVE OF F000098 W.R.T. P(002)
      F000124=P(005)*F000088 
!                      F000126 = DERIVATIVE OF F000099 W.R.T. P(002)
      F000126=F000088 
      B000029=-1.D0/B000011 
!                      F000127 = DERIVATIVE OF B000025 W.R.T. P(001)
      F000127=B000029*B000002 
      B000030=C1/B000011/B000011 
!                      F000128 = DERIVATIVE OF B000025 W.R.T. P(001)
      F000128=B000030*B000002+F000127 
!                      F000130 = DERIVATIVE OF F000100 W.R.T. P(003)
      F000130=B000030 
!                      F000131 = DERIVATIVE OF F000100 W.R.T. P(001)
      F000131=F000128 
      B000031=-1.D0/B000011 
      B000032=P(006)/B000011/B000011 
!                      F000133 = DERIVATIVE OF B000026 W.R.T. P(001)
      F000133=B000032*B000002 
!                      F000135 = DERIVATIVE OF F000101 W.R.T. P(003)
      F000135=B000002*B000032 
!                      F000136 = DERIVATIVE OF F000101 W.R.T. P(001)
      F000136=B000002*F000133 
!                      F000137 = DERIVATIVE OF F000101 W.R.T. P(006)
      F000137=B000002*B000031 
!                      F000138 = DERIVATIVE OF F000101 W.R.T. P(001)
      F000138=B000026*F000084+F000136 
      B000033=C1/B000011/B000011 
      B000034=P(006)/B000011/B000011 
!                      F000140 = DERIVATIVE OF B000027 W.R.T. P(001)
      F000140=B000034*B000002 
      B000035=-P(006)*C1/B000011/B000011/B000011 
!                      F000141 = DERIVATIVE OF B000027 W.R.T. P(001)
      F000141=B000035*B000002+F000140 
      B000036=-P(006)*C1/B000011/B000011/B000011 
!                      F000143 = DERIVATIVE OF B000027 W.R.T. P(001)
      F000143=B000036*B000002+F000141 
!                      F000144 = DERIVATIVE OF B000027 W.R.T. P(003)
      F000144=B000036+B000035 
!                      F000145 = DERIVATIVE OF F000102 W.R.T. P(003)
      F000145=B000002*F000144 
!                      F000146 = DERIVATIVE OF F000102 W.R.T. P(001)
      F000146=B000002*F000143 
!                      F000147 = DERIVATIVE OF F000102 W.R.T. P(006)
      F000147=B000002*B000033 
!                      F000148 = DERIVATIVE OF F000102 W.R.T. P(001)
      F000148=B000027*F000111+F000146 
!                      F000149 = DERIVATIVE OF F000102 W.R.T. P(001)
      F000149=F000138+F000148 
!                      F000150 = DERIVATIVE OF F000102 W.R.T. P(006)
      F000150=F000137+F000147 
!                      F000151 = DERIVATIVE OF F000102 W.R.T. P(003)
      F000151=F000135+F000145 
!                      F000152 = DERIVATIVE OF F000103 W.R.T. P(003)
      F000152=F000144 
!                      F000153 = DERIVATIVE OF F000103 W.R.T. P(001)
      F000153=F000143 
!                      F000154 = DERIVATIVE OF F000103 W.R.T. P(006)
      F000154=B000033 
!                      F000155 = DERIVATIVE OF F000104 W.R.T. P(001)
      F000155=-F000114 
!                      F000156 = DERIVATIVE OF F000104 W.R.T. P(004)
      F000156=-F000113 
!                      F000157 = DERIVATIVE OF F000104 W.R.T. P(003)
      F000157=F000151 
!                      F000158 = DERIVATIVE OF F000104 W.R.T. P(006)
      F000158=F000150 
!                      F000159 = DERIVATIVE OF F000104 W.R.T. P(001)
      F000159=F000149+F000155 
!                      F000160 = DERIVATIVE OF F000105 W.R.T. P(001)
      F000160=-F000112 
!                      F000161 = DERIVATIVE OF F000106 W.R.T. P(001)
      F000161=-F000119 
!                      F000162 = DERIVATIVE OF F000106 W.R.T. P(005)
      F000162=-F000118 
!                      F000163 = DERIVATIVE OF F000106 W.R.T. P(001)
      F000163=F000159+F000161 
!                      F000164 = DERIVATIVE OF F000106 W.R.T. P(006)
      F000164=F000158 
!                      F000165 = DERIVATIVE OF F000106 W.R.T. P(003)
      F000165=F000157 
!                      F000166 = DERIVATIVE OF F000106 W.R.T. P(004)
      F000166=F000156 
!                      F000167 = DERIVATIVE OF F000107 W.R.T. P(001)
      F000167=-F000117 
!                      F000168 = DERIVATIVE OF F000108 W.R.T. P(002)
      F000168=F000124 
!                      F000169 = DERIVATIVE OF F000108 W.R.T. P(005)
      F000169=F000123 
!                      F000170 = DERIVATIVE OF F000109 W.R.T. P(002)
      F000170=F000122 
!                      F000171 = DERIVATIVE OF F000109 W.R.T. P(001)
      F000171=F000167 
!                      F000173 = DERIVATIVE OF F000110 W.R.T. P(001)
      F000173=F000084 
!                      E000030 = DERIVATIVE OF F000090 W.R.T. A(001)
      E000030=E000006 
!                      E000031 = DERIVATIVE OF F000092 W.R.T. A(001)
      E000031=P(004)*E000006 
!                      E000033 = DERIVATIVE OF F000093 W.R.T. A(001)
      E000033=E000006 
!                      E000034 = DERIVATIVE OF F000095 W.R.T. A(001)
      E000034=P(005)*E000006 
!                      E000036 = DERIVATIVE OF F000096 W.R.T. A(001)
      E000036=E000006 
!                      E000037 = DERIVATIVE OF F000098 W.R.T. A(002)
      E000037=P(005)*E000009 
!                      E000039 = DERIVATIVE OF F000099 W.R.T. A(002)
      E000039=E000009 
      B000037=C1/B000011/B000011 
!                      E000040 = DERIVATIVE OF B000025 W.R.T. A(001)
      E000040=B000037*B000001 
!                      E000041 = DERIVATIVE OF F000100 W.R.T. A(001)
      E000041=E000040 
      B000038=P(006)/B000011/B000011 
!                      E000042 = DERIVATIVE OF B000026 W.R.T. A(001)
      E000042=B000038*B000001 
!                      E000043 = DERIVATIVE OF F000101 W.R.T. A(001)
      E000043=B000002*E000042 
!                      E000044 = DERIVATIVE OF F000101 W.R.T. A(001)
      E000044=B000026*E000006+E000043 
      B000039=-P(006)*C1/B000011/B000011/B000011 
!                      E000045 = DERIVATIVE OF B000027 W.R.T. A(001)
      E000045=B000039*B000001 
      B000040=-P(006)*C1/B000011/B000011/B000011 
!                      E000046 = DERIVATIVE OF B000027 W.R.T. A(001)
      E000046=B000040*B000001+E000045 
!                      E000047 = DERIVATIVE OF F000102 W.R.T. A(001)
      E000047=B000002*E000046 
!                      E000048 = DERIVATIVE OF F000102 W.R.T. A(001)
      E000048=B000027*E000030+E000047 
!                      E000049 = DERIVATIVE OF F000102 W.R.T. A(001)
      E000049=E000044+E000048 
!                      E000050 = DERIVATIVE OF F000103 W.R.T. A(001)
      E000050=E000046 
!                      E000051 = DERIVATIVE OF F000104 W.R.T. A(001)
      E000051=-E000031 
!                      E000052 = DERIVATIVE OF F000104 W.R.T. A(001)
      E000052=E000049+E000051 
!                      E000053 = DERIVATIVE OF F000106 W.R.T. A(001)
      E000053=-E000034 
!                      E000054 = DERIVATIVE OF F000106 W.R.T. A(001)
      E000054=E000052+E000053 
!                      E000055 = DERIVATIVE OF F000108 W.R.T. A(002)
      E000055=E000037 
!                      E000057 = DERIVATIVE OF F000110 W.R.T. A(001)
      E000057=E000006 
!                      F000184 = DERIVATIVE OF F000174 W.R.T. P(001)
      F000184=B000002 
!                      F000185 = DERIVATIVE OF F000175 W.R.T. P(005)
      F000185=B000002 
!                      F000186 = DERIVATIVE OF F000175 W.R.T. P(001)
      F000186=P(005)*F000084 
!                      F000188 = DERIVATIVE OF F000176 W.R.T. P(001)
      F000188=F000084 
!                      F000189 = DERIVATIVE OF F000177 W.R.T. P(002)
      F000189=B000007 
!                      F000190 = DERIVATIVE OF F000178 W.R.T. P(005)
      F000190=B000007 
!                      F000191 = DERIVATIVE OF F000178 W.R.T. P(002)
      F000191=P(005)*F000088 
!                      F000193 = DERIVATIVE OF F000179 W.R.T. P(002)
      F000193=F000088 
!                      F000194 = DERIVATIVE OF F000180 W.R.T. P(001)
      F000194=F000186 
!                      F000195 = DERIVATIVE OF F000180 W.R.T. P(005)
      F000195=F000185 
!                      F000196 = DERIVATIVE OF F000181 W.R.T. P(001)
      F000196=F000184 
!                      F000197 = DERIVATIVE OF F000182 W.R.T. P(002)
      F000197=-F000191 
!                      F000198 = DERIVATIVE OF F000182 W.R.T. P(005)
      F000198=-F000190 
!                      F000199 = DERIVATIVE OF F000183 W.R.T. P(002)
      F000199=-F000189 
!                      F000200 = DERIVATIVE OF F000183 W.R.T. P(001)
      F000200=F000196 
!                      E000062 = DERIVATIVE OF F000175 W.R.T. A(001)
      E000062=P(005)*E000006 
!                      E000064 = DERIVATIVE OF F000176 W.R.T. A(001)
      E000064=E000006 
!                      E000065 = DERIVATIVE OF F000178 W.R.T. A(002)
      E000065=P(005)*E000009 
!                      E000067 = DERIVATIVE OF F000179 W.R.T. A(002)
      E000067=E000009 
!                      E000068 = DERIVATIVE OF F000180 W.R.T. A(001)
      E000068=E000062 
!                      E000069 = DERIVATIVE OF F000182 W.R.T. A(002)
      E000069=-E000065 
      ENDIF !msec
      IF (FIRSTEM == 1) THEN !2
      DA(   1,1)=E000017
      DA(   2,1)=E000018
      DA(   3,1)=E000060
      DA(   4,1)=E000061
      DP(   1,1)=F000106
      DP(   2,1)=F000108
      DP(   3,1)=F000103
      DP(   4,1)=F000105
      DP(   5,1)=F000109
      DP(   6,1)=F000100
      DP(   7,1)=F000180
      DP(   8,1)=F000182
      DP(   9,1)=F000183
      ENDIF !2
      IF (MSEC == 1) THEN
      DA(   5,1)=E000028
      DA(   6,1)=E000054
      DA(   7,1)=E000050
      DA(   8,1)=E000041
      DA(   9,1)=E000068
      DA(  10,1)=E000055
      DA(  11,1)=E000069
      DP(  10,1)=F000163
      DP(  11,1)=F000153
      DP(  12,1)=F000160
      DP(  13,1)=F000171
      DP(  14,1)=F000131
      DP(  15,1)=F000194
      DP(  16,1)=F000200
      DP(  17,1)=F000168
      DP(  18,1)=F000170
      DP(  19,1)=F000197
      DP(  20,1)=F000199
      DP(  21,1)=F000165
      DP(  22,1)=F000152
      DP(  23,1)=F000130
      DP(  24,1)=F000166
      DP(  25,1)=F000162
      DP(  26,1)=F000169
      DP(  27,1)=F000195
      DP(  28,1)=F000198
      DP(  29,1)=F000164
      DP(  30,1)=F000154
      ENDIF
      RETURN
      END
      SUBROUTINE FSIZESR(NAME_FSIZES,F_SIZES)
      USE SIZES, ONLY: ISIZE
      INTEGER(KIND=ISIZE), DIMENSION(*) :: F_SIZES
      CHARACTER(LEN=*),    DIMENSION(*) :: NAME_FSIZES
      NAME_FSIZES(01)='LTH'; F_SIZES(01)=10
      NAME_FSIZES(02)='LVR'; F_SIZES(02)=4
      NAME_FSIZES(03)='LVR2'; F_SIZES(03)=0
      NAME_FSIZES(04)='LPAR'; F_SIZES(04)=17
      NAME_FSIZES(05)='LPAR3'; F_SIZES(05)=0
      NAME_FSIZES(06)='NO'; F_SIZES(06)=0
      NAME_FSIZES(07)='MMX'; F_SIZES(07)=1
      NAME_FSIZES(08)='LNP4'; F_SIZES(08)=0
      NAME_FSIZES(09)='LSUPP'; F_SIZES(09)=1
      NAME_FSIZES(10)='LIM7'; F_SIZES(10)=0
      NAME_FSIZES(11)='LWS3'; F_SIZES(11)=0
      NAME_FSIZES(12)='MAXIDS'; F_SIZES(12)=36
      NAME_FSIZES(13)='LIM1'; F_SIZES(13)=0
      NAME_FSIZES(14)='LIM2'; F_SIZES(14)=0
      NAME_FSIZES(15)='LIM3'; F_SIZES(15)=0
      NAME_FSIZES(16)='LIM4'; F_SIZES(16)=0
      NAME_FSIZES(17)='LIM5'; F_SIZES(17)=0
      NAME_FSIZES(18)='LIM6'; F_SIZES(18)=0
      NAME_FSIZES(19)='LIM8'; F_SIZES(19)=0
      NAME_FSIZES(20)='LIM10'; F_SIZES(20)=0
      NAME_FSIZES(21)='LIM11'; F_SIZES(21)=0
      NAME_FSIZES(22)='LIM13'; F_SIZES(22)=0
      NAME_FSIZES(23)='LIM15'; F_SIZES(23)=0
      NAME_FSIZES(24)='LIM16'; F_SIZES(24)=0
      NAME_FSIZES(25)='MAXRECID'; F_SIZES(25)=0
      NAME_FSIZES(26)='PC'; F_SIZES(26)=0
      NAME_FSIZES(27)='PCT'; F_SIZES(27)=1
      NAME_FSIZES(28)='PIR'; F_SIZES(28)=31
      NAME_FSIZES(29)='PD'; F_SIZES(29)=10
      NAME_FSIZES(30)='PAL'; F_SIZES(30)=0
      NAME_FSIZES(31)='MAXFCN'; F_SIZES(31)=0
      NAME_FSIZES(32)='MAXIC'; F_SIZES(32)=0
      NAME_FSIZES(33)='PG'; F_SIZES(33)=0
      NAME_FSIZES(34)='NPOPMIXMAX'; F_SIZES(34)=0
      NAME_FSIZES(35)='MAXOMEG'; F_SIZES(35)=3
      NAME_FSIZES(36)='MAXPTHETA'; F_SIZES(36)=11
      NAME_FSIZES(37)='MAXITER'; F_SIZES(37)=20
      NAME_FSIZES(38)='ISAMPLEMAX'; F_SIZES(38)=0
      NAME_FSIZES(39)='DIMTMP'; F_SIZES(39)=0
      NAME_FSIZES(40)='DIMCNS'; F_SIZES(40)=0
      NAME_FSIZES(41)='DIMNEW'; F_SIZES(41)=0
      NAME_FSIZES(42)='PDT'; F_SIZES(42)=10
      NAME_FSIZES(43)='LADD_MAX'; F_SIZES(43)=0
      NAME_FSIZES(44)='MAXSIDL'; F_SIZES(44)=0
      NAME_FSIZES(45)='NTT'; F_SIZES(45)=10
      NAME_FSIZES(46)='NOMEG'; F_SIZES(46)=3
      NAME_FSIZES(47)='NSIGM'; F_SIZES(47)=1
      NAME_FSIZES(48)='PPDT'; F_SIZES(48)=7
      RETURN
      END SUBROUTINE FSIZESR
      SUBROUTINE MUMODEL2(THETA,MU_,ICALL,IDEF,NEWIND,&
      EVTREC,DATREC,IREV,NVNT,INDXS,F,G,H,IRGG,GG,NETAS)
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMBAYES_REAL,    ONLY: PRIORINFO
      USE NMPRD_INT, ONLY: IERPRD,IERPRDU,NETEXT,IQUIT
      USE NMPRD_CHAR,ONLY: ETEXT
      USE NMPRD_REAL,ONLY: ETA,EPS
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,COMACT,COMSAV,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE NMBAYES_REAL, ONLY: LDF
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)
      REAL(KIND=DPSIZE)   :: MU_(*)
      INTEGER NEWIND
      REAL(KIND=DPSIZE) :: EVTREC
      SAVE
      INTEGER(KIND=ISIZE) :: FIRSTEM
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS
      DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*),GG(IRGG,GPKD+1,*)
      RETURN
      END
