      MODULE NMPRD4P
      USE SIZES, ONLY: DPSIZE
      USE NMPRD4,ONLY: VRBL
      IMPLICIT NONE
      SAVE
      REAL(KIND=DPSIZE), DIMENSION (:),POINTER ::COM
      REAL(KIND=DPSIZE), POINTER ::VST1,VST2,VST3,EST,TVCL,CL,TVV,V,S1
      REAL(KIND=DPSIZE), POINTER ::Y,IPRED,A000039,A000056,A000055
      REAL(KIND=DPSIZE), POINTER ::A000054,A000053,A000040,A000059
      REAL(KIND=DPSIZE), POINTER ::A000058,A000057,A000041,A000061
      REAL(KIND=DPSIZE), POINTER ::A000060,A000042,A000062,A000064
      REAL(KIND=DPSIZE), POINTER ::A000066,A000067,A000068,D000001
      REAL(KIND=DPSIZE), POINTER ::D000002,D000003,D000004,D000005
      REAL(KIND=DPSIZE), POINTER ::D000006,D000007,D000008,D000009
      REAL(KIND=DPSIZE), POINTER ::D000010,D000011,D000012,D000013
      REAL(KIND=DPSIZE), POINTER ::D000014,D000015,D000016,D000017
      REAL(KIND=DPSIZE), POINTER ::D000018,D000019,D000020,D000060
      REAL(KIND=DPSIZE), POINTER ::D000101,D000102,D000103,D000104
      REAL(KIND=DPSIZE), POINTER ::D000105,D000059,D000092,D000093
      REAL(KIND=DPSIZE), POINTER ::D000094,D000095,D000058,D000085
      REAL(KIND=DPSIZE), POINTER ::D000086,D000087,D000057,D000080
      REAL(KIND=DPSIZE), POINTER ::D000081,D000056,D000077,C000031
      REAL(KIND=DPSIZE), POINTER ::D000110,D000109,D000108,D000107
      REAL(KIND=DPSIZE), POINTER ::D000106,C000032
      CONTAINS
      SUBROUTINE ASSOCNMPRD4
      COM=>VRBL
      VST1=>COM(000001);VST2=>COM(000002);VST3=>COM(000003)
      EST=>COM(000004);TVCL=>COM(000005);CL=>COM(000006)
      TVV=>COM(000007);V=>COM(000008);S1=>COM(000009);Y=>COM(000010)
      IPRED=>COM(000011);A000039=>COM(000012);A000056=>COM(000013)
      A000055=>COM(000014);A000054=>COM(000015);A000053=>COM(000016)
      A000040=>COM(000017);A000059=>COM(000018);A000058=>COM(000019)
      A000057=>COM(000020);A000041=>COM(000021);A000061=>COM(000022)
      A000060=>COM(000023);A000042=>COM(000024);A000062=>COM(000025)
      A000064=>COM(000026);A000066=>COM(000027);A000067=>COM(000028)
      A000068=>COM(000029);D000001=>COM(000030);D000002=>COM(000031)
      D000003=>COM(000032);D000004=>COM(000033);D000005=>COM(000034)
      D000006=>COM(000035);D000007=>COM(000036);D000008=>COM(000037)
      D000009=>COM(000038);D000010=>COM(000039);D000011=>COM(000040)
      D000012=>COM(000041);D000013=>COM(000042);D000014=>COM(000043)
      D000015=>COM(000044);D000016=>COM(000045);D000017=>COM(000046)
      D000018=>COM(000047);D000019=>COM(000048);D000020=>COM(000049)
      D000060=>COM(000050);D000101=>COM(000051);D000102=>COM(000052)
      D000103=>COM(000053);D000104=>COM(000054);D000105=>COM(000055)
      D000059=>COM(000056);D000092=>COM(000057);D000093=>COM(000058)
      D000094=>COM(000059);D000095=>COM(000060);D000058=>COM(000061)
      D000085=>COM(000062);D000086=>COM(000063);D000087=>COM(000064)
      D000057=>COM(000065);D000080=>COM(000066);D000081=>COM(000067)
      D000056=>COM(000068);D000077=>COM(000069);C000031=>COM(000070)
      D000110=>COM(000071);D000109=>COM(000072);D000108=>COM(000073)
      D000107=>COM(000074);D000106=>COM(000075);C000032=>COM(000076)
      END SUBROUTINE ASSOCNMPRD4
      END MODULE NMPRD4P
      SUBROUTINE PK(ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,IRGG,GG,NETAS)      
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMBAYES_REAL,    ONLY: PRIORINFO
      USE NMPRD_INT, ONLY: IERPRD,IERPRDU,NETEXT,IQUIT                        
      USE NMPRD_CHAR,ONLY: ETEXT                                              
      USE NMPRD_REAL,ONLY: ETA,EPS                                            
      USE ROCM_INT,  ONLY: MIXNUM=>MIXCALL,MIXEST=>IMIXEST                            
      USE ROCM_REAL, ONLY: MIXP                                                       
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,COMACT,COMSAV,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE PROCM_INT, ONLY: NEWIND=>PNEWIF                                       
      USE NMBAYES_REAL, ONLY: LDF                                             
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                          
      REAL(KIND=DPSIZE) :: EVTREC                                               
      SAVE
      INTEGER(KIND=ISIZE) :: FIRSTEM
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS              
      DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*),GG(IRGG,GPKD+1,*) 
      FIRSTEM=IFIRSTEM
      IF (ICALL <= 1) THEN                                                      
      CALL ASSOCNMPRD4
      IDEF(   1,0001)=  -9
      IDEF(   1,0002)=  -1
      IDEF(   1,0003)=   0
      IDEF(   1,0004)=   0
      IDEF(   2,0003)=   0
      IDEF(   2,0004)=   0
      IDEF(   3,0001)=   3
      CALL GETETA(ETA)                                                          
      IF (IQUIT == 1) RETURN                                                    
      RETURN                                                                    
      ENDIF                                                                     
      IF (NEWIND /= 2) THEN
      IF (ICALL == 4) THEN
      CALL SIMETA(ETA)
      ELSE
      CALL GETETA(ETA)
      ENDIF
      IF (IQUIT == 1) RETURN
      ENDIF
 !  level            0
      WT=EVTREC(NVNT,010)
      VIST=EVTREC(NVNT,015)
      VST1=0.D0 
      IF(VIST == 1.D0)THEN 
      VST1=1.D0 
      ENDIF 
      VST2=0.D0 
      IF(VIST == 2.D0)THEN 
      VST2=1.D0 
      ENDIF 
      VST3=0.D0 
      IF(VIST == 3.D0)THEN 
      VST3=1.D0 
      ENDIF 
      EST=MIXEST 
      IF(MIXNUM == 1.D0)THEN 
      B000012=WT/70.D0 
      IF(B000012 == 0.D0.AND.THETA(003) <= 0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE 0**POWER WITH POWER<=0.'
      RETURN
      ENDIF 
      IF(B000012 <  0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE BASE**POWER WITH BASE<0.'
      RETURN
      ENDIF 
      B000013=0.D0 
      IF(B000012 == 0.D0)THEN 
      B000013=1.D0 
      ENDIF 
      B000014=1.D0-B000013 
      B000015=B000012+B000013 
      B000016=B000015**THETA(003) 
      B000017=B000014*B000016 
      TVCL=THETA(001)*B000017 
      ELSE 
      B000019=WT/70.D0 
      IF(B000019 == 0.D0.AND.THETA(003) <= 0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE 0**POWER WITH POWER<=0.'
      RETURN
      ENDIF 
      IF(B000019 <  0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE BASE**POWER WITH BASE<0.'
      RETURN
      ENDIF 
      B000020=0.D0 
      IF(B000019 == 0.D0)THEN 
      B000020=1.D0 
      ENDIF 
      B000021=1.D0-B000020 
      B000022=B000019+B000020 
      B000023=B000022**THETA(003) 
      B000024=B000021*B000023 
      TVCL=THETA(005)*B000024 
      ENDIF 
      B000026=ETA(001)+ETA(003)*VST1+ETA(004)*VST2+ETA(005)*VST3 
      B000027=DEXP(B000026) 
      CL=TVCL*B000027 
      B000028=VST1 
      B000029=VST2 
      B000030=VST3 
      B000031=TVCL 
      B000032=WT/70.D0 
      IF(B000032 == 0.D0.AND.THETA(004) <= 0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE 0**POWER WITH POWER<=0.'
      RETURN
      ENDIF 
      IF(B000032 <  0.D0)THEN 
      IERPRD=1
      ETEXT(1)='PK SUBROUTINE: ERROR IN COMPUTATION'
      ETEXT(2)='ATTEMPT TO COMPUTE BASE**POWER WITH BASE<0.'
      RETURN
      ENDIF 
      B000033=0.D0 
      IF(B000032 == 0.D0)THEN 
      B000033=1.D0 
      ENDIF 
      B000034=1.D0-B000033 
      B000035=B000032+B000033 
      B000036=B000035**THETA(004) 
      B000037=B000034*B000036 
      TVV=THETA(002)*B000037 
      B000038=DEXP(ETA(002)) 
      V=TVV*B000038 
      S1=V 
      IF (FIRSTEM == 1) THEN
!                      A000035 = DERIVATIVE OF B000027 W.R.T. ETA(005)
      A000035=B000027*B000030 
!                      A000036 = DERIVATIVE OF B000027 W.R.T. ETA(004)
      A000036=B000027*B000029 
!                      A000037 = DERIVATIVE OF B000027 W.R.T. ETA(003)
      A000037=B000027*B000028 
!                      A000039 = DERIVATIVE OF CL W.R.T. ETA(001)
      A000039=B000031*B000027 
!                      A000040 = DERIVATIVE OF CL W.R.T. ETA(003)
      A000040=B000031*A000037 
!                      A000041 = DERIVATIVE OF CL W.R.T. ETA(004)
      A000041=B000031*A000036 
!                      A000042 = DERIVATIVE OF CL W.R.T. ETA(005)
      A000042=B000031*A000035 
!                      A000064 = DERIVATIVE OF V W.R.T. ETA(002)
      A000064=TVV*B000038 
!                      A000067 = DERIVATIVE OF S1 W.R.T. ETA(002)
      A000067=A000064 
      GG(0001,1,1)=CL
      GG(0001,0002,1)=A000039
      GG(0001,0004,1)=A000040
      GG(0001,0005,1)=A000041
      GG(0001,0006,1)=A000042
      GG(0002,1,1)=V
      GG(0002,0003,1)=A000064
      GG(0003,1,1)=S1
      GG(0003,0003,1)=A000067
      ELSE
      GG(0001,1,1)=CL
      GG(0002,1,1)=V
      GG(0003,1,1)=S1
      ENDIF
      IF (MSEC == 1) THEN
!                      A000043 = DERIVATIVE OF A000035 W.R.T. ETA(005)
      A000043=B000030*A000035 
!                      A000044 = DERIVATIVE OF A000036 W.R.T. ETA(004)
      A000044=B000029*A000036 
!                      A000045 = DERIVATIVE OF A000036 W.R.T. ETA(005)
      A000045=B000029*A000035 
!                      A000046 = DERIVATIVE OF A000037 W.R.T. ETA(003)
      A000046=B000028*A000037 
!                      A000047 = DERIVATIVE OF A000037 W.R.T. ETA(004)
      A000047=B000028*A000036 
!                      A000048 = DERIVATIVE OF A000037 W.R.T. ETA(005)
      A000048=B000028*A000035 
!                      A000053 = DERIVATIVE OF A000039 W.R.T. ETA(005)
      A000053=B000031*A000035 
!                      A000054 = DERIVATIVE OF A000039 W.R.T. ETA(004)
      A000054=B000031*A000036 
!                      A000055 = DERIVATIVE OF A000039 W.R.T. ETA(003)
      A000055=B000031*A000037 
!                      A000056 = DERIVATIVE OF A000039 W.R.T. ETA(001)
      A000056=B000031*B000027 
!                      A000057 = DERIVATIVE OF A000040 W.R.T. ETA(005)
      A000057=B000031*A000048 
!                      A000058 = DERIVATIVE OF A000040 W.R.T. ETA(004)
      A000058=B000031*A000047 
!                      A000059 = DERIVATIVE OF A000040 W.R.T. ETA(003)
      A000059=B000031*A000046 
!                      A000060 = DERIVATIVE OF A000041 W.R.T. ETA(005)
      A000060=B000031*A000045 
!                      A000061 = DERIVATIVE OF A000041 W.R.T. ETA(004)
      A000061=B000031*A000044 
!                      A000062 = DERIVATIVE OF A000042 W.R.T. ETA(005)
      A000062=B000031*A000043 
!                      A000066 = DERIVATIVE OF A000064 W.R.T. ETA(002)
      A000066=TVV*B000038 
!                      A000068 = DERIVATIVE OF A000067 W.R.T. ETA(002)
      A000068=A000066 
      GG(0001,0002,0002)=A000056
      GG(0001,0004,0002)=A000055
      GG(0001,0005,0002)=A000054
      GG(0001,0006,0002)=A000053
      GG(0001,0004,0004)=A000059
      GG(0001,0005,0004)=A000058
      GG(0001,0006,0004)=A000057
      GG(0001,0005,0005)=A000061
      GG(0001,0006,0005)=A000060
      GG(0001,0006,0006)=A000062
      GG(0002,0003,0003)=A000066
      GG(0003,0003,0003)=A000068
      ENDIF
      RETURN
      END
      SUBROUTINE ERROR (ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,F,G,HH)       
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMPRD_REAL,ONLY: ETA,EPS                                            
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,IQUIT,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE NMPRD_INT, ONLY: NEWL2
      USE PROCM_INT, ONLY: NEWIND=>PNEWIF                                       
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                        
      REAL(KIND=DPSIZE) :: EVTREC                                             
      SAVE
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS                       
      DIMENSION :: IDEF(*),THETA(*),EVTREC(IREV,*),INDXS(*)                   
      REAL(KIND=DPSIZE) :: G(GERD,*),HH(HERD,*)                               
      INTEGER(KIND=ISIZE) :: FIRSTEM
      FIRSTEM=IFIRSTEM
      IF (ICALL <= 1) THEN                                                    
      CALL ASSOCNMPRD4
      IDEF(2)=-1
      IDEF(3)=000
      RETURN
      ENDIF
      IF (ICALL == 4) THEN
      IF (NEWL2 == 1) THEN
      CALL SIMEPS(EPS)
      IF (IQUIT == 1) RETURN
      ENDIF
      ENDIF
      D000001=G(001,1)
      D000002=G(002,1)
      D000003=G(003,1)
      D000004=G(004,1)
      D000005=G(005,1)
 !  level            0
      Y=F+F*EPS(001)+EPS(002) 
!                      C000031 = DERIVATIVE OF Y W.R.T. EPS(001)
      C000031=F 
!                      C000032 = DERIVATIVE OF Y W.R.T. EPS(002)
      C000032=1.D0 
      IPRED=F 
      IF (FIRSTEM == 1) THEN !1
!                      D000051 = DERIVATIVE OF Y W.R.T. ETA(005)
      D000051=D000005 
!                      D000052 = DERIVATIVE OF Y W.R.T. ETA(004)
      D000052=D000004 
!                      D000053 = DERIVATIVE OF Y W.R.T. ETA(003)
      D000053=D000003 
!                      D000054 = DERIVATIVE OF Y W.R.T. ETA(002)
      D000054=D000002 
!                      D000055 = DERIVATIVE OF Y W.R.T. ETA(001)
      D000055=D000001 
!                      D000056 = DERIVATIVE OF Y W.R.T. ETA(005)
      D000056=EPS(001)*D000005+D000051 
!                      D000057 = DERIVATIVE OF Y W.R.T. ETA(004)
      D000057=EPS(001)*D000004+D000052 
!                      D000058 = DERIVATIVE OF Y W.R.T. ETA(003)
      D000058=EPS(001)*D000003+D000053 
!                      D000059 = DERIVATIVE OF Y W.R.T. ETA(002)
      D000059=EPS(001)*D000002+D000054 
!                      D000060 = DERIVATIVE OF Y W.R.T. ETA(001)
      D000060=EPS(001)*D000001+D000055 
!                      D000106 = DERIVATIVE OF C000031 W.R.T. ETA(005)
      D000106=D000005 
!                      D000107 = DERIVATIVE OF C000031 W.R.T. ETA(004)
      D000107=D000004 
!                      D000108 = DERIVATIVE OF C000031 W.R.T. ETA(003)
      D000108=D000003 
!                      D000109 = DERIVATIVE OF C000031 W.R.T. ETA(002)
      D000109=D000002 
!                      D000110 = DERIVATIVE OF C000031 W.R.T. ETA(001)
      D000110=D000001 
      G(001,1)=D000060
      G(002,1)=D000059
      G(003,1)=D000058
      G(004,1)=D000057
      G(005,1)=D000056
      ENDIF !1
      HH(001,1)=C000031
      HH(002,1)=C000032
      IF (FIRSTEM == 1) THEN !2
      HH(001,002)=D000110
      HH(001,003)=D000109
      HH(001,004)=D000108
      HH(001,005)=D000107
      HH(001,006)=D000106
      ENDIF !2
      IF (MSEC == 1) THEN
      D000006=G(001,002)
      D000007=G(002,002)
      D000008=G(002,003)
      D000009=G(003,002)
      D000010=G(003,003)
      D000011=G(003,004)
      D000012=G(004,002)
      D000013=G(004,003)
      D000014=G(004,004)
      D000015=G(004,005)
      D000016=G(005,002)
      D000017=G(005,003)
      D000018=G(005,004)
      D000019=G(005,005)
      D000020=G(005,006)
!                      D000061 = DERIVATIVE OF D000051 W.R.T. ETA(005)
      D000061=D000020 
!                      D000062 = DERIVATIVE OF D000052 W.R.T. ETA(005)
      D000062=D000019 
!                      D000063 = DERIVATIVE OF D000052 W.R.T. ETA(004)
      D000063=D000015 
!                      D000064 = DERIVATIVE OF D000053 W.R.T. ETA(005)
      D000064=D000018 
!                      D000065 = DERIVATIVE OF D000053 W.R.T. ETA(004)
      D000065=D000014 
!                      D000066 = DERIVATIVE OF D000053 W.R.T. ETA(003)
      D000066=D000011 
!                      D000067 = DERIVATIVE OF D000054 W.R.T. ETA(005)
      D000067=D000017 
!                      D000068 = DERIVATIVE OF D000054 W.R.T. ETA(004)
      D000068=D000013 
!                      D000069 = DERIVATIVE OF D000054 W.R.T. ETA(003)
      D000069=D000010 
!                      D000070 = DERIVATIVE OF D000054 W.R.T. ETA(002)
      D000070=D000008 
!                      D000071 = DERIVATIVE OF D000055 W.R.T. ETA(005)
      D000071=D000016 
!                      D000072 = DERIVATIVE OF D000055 W.R.T. ETA(004)
      D000072=D000012 
!                      D000073 = DERIVATIVE OF D000055 W.R.T. ETA(003)
      D000073=D000009 
!                      D000074 = DERIVATIVE OF D000055 W.R.T. ETA(002)
      D000074=D000007 
!                      D000075 = DERIVATIVE OF D000055 W.R.T. ETA(001)
      D000075=D000006 
!                      D000076 = DERIVATIVE OF D000056 W.R.T. ETA(005)
      D000076=EPS(001)*D000020 
!                      D000077 = DERIVATIVE OF D000056 W.R.T. ETA(005)
      D000077=D000061+D000076 
!                      D000078 = DERIVATIVE OF D000057 W.R.T. ETA(005)
      D000078=EPS(001)*D000019 
!                      D000079 = DERIVATIVE OF D000057 W.R.T. ETA(004)
      D000079=EPS(001)*D000015 
!                      D000080 = DERIVATIVE OF D000057 W.R.T. ETA(004)
      D000080=D000063+D000079 
!                      D000081 = DERIVATIVE OF D000057 W.R.T. ETA(005)
      D000081=D000062+D000078 
!                      D000082 = DERIVATIVE OF D000058 W.R.T. ETA(005)
      D000082=EPS(001)*D000018 
!                      D000083 = DERIVATIVE OF D000058 W.R.T. ETA(004)
      D000083=EPS(001)*D000014 
!                      D000084 = DERIVATIVE OF D000058 W.R.T. ETA(003)
      D000084=EPS(001)*D000011 
!                      D000085 = DERIVATIVE OF D000058 W.R.T. ETA(003)
      D000085=D000066+D000084 
!                      D000086 = DERIVATIVE OF D000058 W.R.T. ETA(004)
      D000086=D000065+D000083 
!                      D000087 = DERIVATIVE OF D000058 W.R.T. ETA(005)
      D000087=D000064+D000082 
!                      D000088 = DERIVATIVE OF D000059 W.R.T. ETA(005)
      D000088=EPS(001)*D000017 
!                      D000089 = DERIVATIVE OF D000059 W.R.T. ETA(004)
      D000089=EPS(001)*D000013 
!                      D000090 = DERIVATIVE OF D000059 W.R.T. ETA(003)
      D000090=EPS(001)*D000010 
!                      D000091 = DERIVATIVE OF D000059 W.R.T. ETA(002)
      D000091=EPS(001)*D000008 
!                      D000092 = DERIVATIVE OF D000059 W.R.T. ETA(002)
      D000092=D000070+D000091 
!                      D000093 = DERIVATIVE OF D000059 W.R.T. ETA(003)
      D000093=D000069+D000090 
!                      D000094 = DERIVATIVE OF D000059 W.R.T. ETA(004)
      D000094=D000068+D000089 
!                      D000095 = DERIVATIVE OF D000059 W.R.T. ETA(005)
      D000095=D000067+D000088 
!                      D000096 = DERIVATIVE OF D000060 W.R.T. ETA(005)
      D000096=EPS(001)*D000016 
!                      D000097 = DERIVATIVE OF D000060 W.R.T. ETA(004)
      D000097=EPS(001)*D000012 
!                      D000098 = DERIVATIVE OF D000060 W.R.T. ETA(003)
      D000098=EPS(001)*D000009 
!                      D000099 = DERIVATIVE OF D000060 W.R.T. ETA(002)
      D000099=EPS(001)*D000007 
!                      D000100 = DERIVATIVE OF D000060 W.R.T. ETA(001)
      D000100=EPS(001)*D000006 
!                      D000101 = DERIVATIVE OF D000060 W.R.T. ETA(001)
      D000101=D000075+D000100 
!                      D000102 = DERIVATIVE OF D000060 W.R.T. ETA(002)
      D000102=D000074+D000099 
!                      D000103 = DERIVATIVE OF D000060 W.R.T. ETA(003)
      D000103=D000073+D000098 
!                      D000104 = DERIVATIVE OF D000060 W.R.T. ETA(004)
      D000104=D000072+D000097 
!                      D000105 = DERIVATIVE OF D000060 W.R.T. ETA(005)
      D000105=D000071+D000096 
      G(001,002)=D000101
      G(002,002)=D000102
      G(002,003)=D000092
      G(003,002)=D000103
      G(003,003)=D000093
      G(003,004)=D000085
      G(004,002)=D000104
      G(004,003)=D000094
      G(004,004)=D000086
      G(004,005)=D000080
      G(005,002)=D000105
      G(005,003)=D000095
      G(005,004)=D000087
      G(005,005)=D000081
      G(005,006)=D000077
      ENDIF
      F=Y
      RETURN
      END
      SUBROUTINE MIX (ICALL,NSPOP,P)
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE ROCM_REAL, ONLY: THETA=>THETAC,DATA=>RDATA
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                        
      SAVE
      DIMENSION :: P(*)
      INTEGER(KIND=ISIZE) :: ICALL,NSPOP
 !  level            0
      NSPOP=2 
      P(001)=THETA(006) 
      P(002)=1.D0-THETA(006) 
      RETURN
      END
      SUBROUTINE FSIZESR(NAME_FSIZES,F_SIZES)
      USE SIZES, ONLY: ISIZE
      INTEGER(KIND=ISIZE), DIMENSION(*) :: F_SIZES
      CHARACTER(LEN=*),    DIMENSION(*) :: NAME_FSIZES
      NAME_FSIZES(01)='LTH'; F_SIZES(01)=6
      NAME_FSIZES(02)='LVR'; F_SIZES(02)=7
      NAME_FSIZES(03)='LVR2'; F_SIZES(03)=0
      NAME_FSIZES(04)='LPAR'; F_SIZES(04)=24
      NAME_FSIZES(05)='LPAR3'; F_SIZES(05)=0
      NAME_FSIZES(06)='NO'; F_SIZES(06)=0
      NAME_FSIZES(07)='MMX'; F_SIZES(07)=2
      NAME_FSIZES(08)='LNP4'; F_SIZES(08)=0
      NAME_FSIZES(09)='LSUPP'; F_SIZES(09)=1
      NAME_FSIZES(10)='LIM7'; F_SIZES(10)=0
      NAME_FSIZES(11)='LWS3'; F_SIZES(11)=0
      NAME_FSIZES(12)='MAXIDS'; F_SIZES(12)=300
      NAME_FSIZES(13)='LIM1'; F_SIZES(13)=0
      NAME_FSIZES(14)='LIM2'; F_SIZES(14)=0
      NAME_FSIZES(15)='LIM3'; F_SIZES(15)=0
      NAME_FSIZES(16)='LIM4'; F_SIZES(16)=0
      NAME_FSIZES(17)='LIM5'; F_SIZES(17)=0
      NAME_FSIZES(18)='LIM6'; F_SIZES(18)=0
      NAME_FSIZES(19)='LIM8'; F_SIZES(19)=0
      NAME_FSIZES(20)='LIM10'; F_SIZES(20)=0
      NAME_FSIZES(21)='LIM11'; F_SIZES(21)=0
      NAME_FSIZES(22)='LIM13'; F_SIZES(22)=0
      NAME_FSIZES(23)='LIM15'; F_SIZES(23)=0
      NAME_FSIZES(24)='LIM16'; F_SIZES(24)=0
      NAME_FSIZES(25)='MAXRECID'; F_SIZES(25)=0
      NAME_FSIZES(26)='PC'; F_SIZES(26)=0
      NAME_FSIZES(27)='PCT'; F_SIZES(27)=1
      NAME_FSIZES(28)='PIR'; F_SIZES(28)=1
      NAME_FSIZES(29)='PD'; F_SIZES(29)=16
      NAME_FSIZES(30)='PAL'; F_SIZES(30)=0
      NAME_FSIZES(31)='MAXFCN'; F_SIZES(31)=0
      NAME_FSIZES(32)='MAXIC'; F_SIZES(32)=0
      NAME_FSIZES(33)='PG'; F_SIZES(33)=0
      NAME_FSIZES(34)='NPOPMIXMAX'; F_SIZES(34)=0
      NAME_FSIZES(35)='MAXOMEG'; F_SIZES(35)=5
      NAME_FSIZES(36)='MAXPTHETA'; F_SIZES(36)=9
      NAME_FSIZES(37)='MAXITER'; F_SIZES(37)=20
      NAME_FSIZES(38)='ISAMPLEMAX'; F_SIZES(38)=0
      NAME_FSIZES(39)='DIMTMP'; F_SIZES(39)=0
      NAME_FSIZES(40)='DIMCNS'; F_SIZES(40)=0
      NAME_FSIZES(41)='DIMNEW'; F_SIZES(41)=0
      NAME_FSIZES(42)='PDT'; F_SIZES(42)=14
      NAME_FSIZES(43)='LADD_MAX'; F_SIZES(43)=0
      NAME_FSIZES(44)='MAXSIDL'; F_SIZES(44)=0
      NAME_FSIZES(45)='NTT'; F_SIZES(45)=6
      NAME_FSIZES(46)='NOMEG'; F_SIZES(46)=5
      NAME_FSIZES(47)='NSIGM'; F_SIZES(47)=2
      NAME_FSIZES(48)='PPDT'; F_SIZES(48)=4
      RETURN
      END SUBROUTINE FSIZESR
      SUBROUTINE MUMODEL2(THETA,MU_,ICALL,IDEF,NEWIND,&
      EVTREC,DATREC,IREV,NVNT,INDXS,F,G,H,IRGG,GG,NETAS)
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMBAYES_REAL,    ONLY: PRIORINFO
      USE NMPRD_INT, ONLY: IERPRD,IERPRDU,NETEXT,IQUIT
      USE NMPRD_CHAR,ONLY: ETEXT
      USE NMPRD_REAL,ONLY: ETA,EPS
      USE ROCM_INT,  ONLY: MIXNUM=>MIXCALL,MIXEST=>IMIXEST
      USE ROCM_REAL, ONLY: MIXP
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,COMACT,COMSAV,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE NMBAYES_REAL, ONLY: LDF
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)
      REAL(KIND=DPSIZE)   :: MU_(*)
      INTEGER NEWIND
      REAL(KIND=DPSIZE) :: EVTREC
      SAVE
      INTEGER(KIND=ISIZE) :: FIRSTEM
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS
      DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*),GG(IRGG,GPKD+1,*)
      RETURN
      END
