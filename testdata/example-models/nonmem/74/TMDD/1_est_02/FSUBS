      MODULE NMPRD4P
      USE SIZES, ONLY: DPSIZE
      USE NMPRD4,ONLY: VRBL
      IMPLICIT NONE
      SAVE
      REAL(KIND=DPSIZE), DIMENSION (:),POINTER ::COM
      REAL(KIND=DPSIZE), POINTER ::CL,VC,Q,VP,K,K12,K21,BASE,KINT,KDEG
      REAL(KIND=DPSIZE), POINTER ::KON,KOFF,KSYN,FDRUG,FTARG,FCOMP
      REAL(KIND=DPSIZE), POINTER ::IPRED,Y,A000032,A000034,A000036
      REAL(KIND=DPSIZE), POINTER ::A000038,A000039,A000045,A000044
      REAL(KIND=DPSIZE), POINTER ::A000040,A000050,A000055,A000060
      REAL(KIND=DPSIZE), POINTER ::A000064,A000066,A000067,A000068
      REAL(KIND=DPSIZE), POINTER ::A000071,A000072,A000073,A000074
      REAL(KIND=DPSIZE), POINTER ::A000075,A000076,A000077,A000078
      REAL(KIND=DPSIZE), POINTER ::A000079,A000080,A000081,E000010
      REAL(KIND=DPSIZE), POINTER ::E000007,E000009,E000011,F000081
      REAL(KIND=DPSIZE), POINTER ::F000082,F000083,F000084,F000085
      REAL(KIND=DPSIZE), POINTER ::F000086,E000030,E000029,E000031
      REAL(KIND=DPSIZE), POINTER ::F000093,F000095,F000094,F000091
      REAL(KIND=DPSIZE), POINTER ::F000092,E000047,E000046,E000048
      REAL(KIND=DPSIZE), POINTER ::F000105,F000108,F000106,F000107
      REAL(KIND=DPSIZE), POINTER ::E000063,E000064,F000116,F000117
      REAL(KIND=DPSIZE), POINTER ::D000001,D000002,D000003,D000004
      REAL(KIND=DPSIZE), POINTER ::D000005,D000006,D000007,D000008
      REAL(KIND=DPSIZE), POINTER ::D000009,D000053,D000064,D000063
      REAL(KIND=DPSIZE), POINTER ::D000062,D000054,D000073,D000074
      REAL(KIND=DPSIZE), POINTER ::D000051,D000057,D000342,D000347
      REAL(KIND=DPSIZE), POINTER ::D000346,D000345,D000343,D000349
      REAL(KIND=DPSIZE), POINTER ::D000348,D000341,D000344,C000046
      REAL(KIND=DPSIZE), POINTER ::D000354,D000355,D000353,C000045
      REAL(KIND=DPSIZE), POINTER ::D000351,D000350,D000352,C000047
      REAL(KIND=DPSIZE), POINTER ::D000357,D000358,D000356
      CONTAINS
      SUBROUTINE ASSOCNMPRD4
      COM=>VRBL
      CL=>COM(000001);VC=>COM(000002);Q=>COM(000003);VP=>COM(000004)
      K=>COM(000005);K12=>COM(000006);K21=>COM(000007)
      BASE=>COM(000008);KINT=>COM(000009);KDEG=>COM(000010)
      KON=>COM(000011);KOFF=>COM(000012);KSYN=>COM(000013)
      FDRUG=>COM(000014);FTARG=>COM(000015);FCOMP=>COM(000016)
      IPRED=>COM(000017);Y=>COM(000018);A000032=>COM(000019)
      A000034=>COM(000020);A000036=>COM(000021);A000038=>COM(000022)
      A000039=>COM(000023);A000045=>COM(000024);A000044=>COM(000025)
      A000040=>COM(000026);A000050=>COM(000027);A000055=>COM(000028)
      A000060=>COM(000029);A000064=>COM(000030);A000066=>COM(000031)
      A000067=>COM(000032);A000068=>COM(000033);A000071=>COM(000034)
      A000072=>COM(000035);A000073=>COM(000036);A000074=>COM(000037)
      A000075=>COM(000038);A000076=>COM(000039);A000077=>COM(000040)
      A000078=>COM(000041);A000079=>COM(000042);A000080=>COM(000043)
      A000081=>COM(000044);E000010=>COM(000045);E000007=>COM(000046)
      E000009=>COM(000047);E000011=>COM(000048);F000081=>COM(000049)
      F000082=>COM(000050);F000083=>COM(000051);F000084=>COM(000052)
      F000085=>COM(000053);F000086=>COM(000054);E000030=>COM(000055)
      E000029=>COM(000056);E000031=>COM(000057);F000093=>COM(000058)
      F000095=>COM(000059);F000094=>COM(000060);F000091=>COM(000061)
      F000092=>COM(000062);E000047=>COM(000063);E000046=>COM(000064)
      E000048=>COM(000065);F000105=>COM(000066);F000108=>COM(000067)
      F000106=>COM(000068);F000107=>COM(000069);E000063=>COM(000070)
      E000064=>COM(000071);F000116=>COM(000072);F000117=>COM(000073)
      D000001=>COM(000074);D000002=>COM(000075);D000003=>COM(000076)
      D000004=>COM(000077);D000005=>COM(000078);D000006=>COM(000079)
      D000007=>COM(000080);D000008=>COM(000081);D000009=>COM(000082)
      D000053=>COM(000083);D000064=>COM(000084);D000063=>COM(000085)
      D000062=>COM(000086);D000054=>COM(000087);D000073=>COM(000088)
      D000074=>COM(000089);D000051=>COM(000090);D000057=>COM(000091)
      D000342=>COM(000092);D000347=>COM(000093);D000346=>COM(000094)
      D000345=>COM(000095);D000343=>COM(000096);D000349=>COM(000097)
      D000348=>COM(000098);D000341=>COM(000099);D000344=>COM(000100)
      C000046=>COM(000101);D000354=>COM(000102);D000355=>COM(000103)
      D000353=>COM(000104);C000045=>COM(000105);D000351=>COM(000106)
      D000350=>COM(000107);D000352=>COM(000108);C000047=>COM(000109)
      D000357=>COM(000110);D000358=>COM(000111);D000356=>COM(000112)
      END SUBROUTINE ASSOCNMPRD4
      END MODULE NMPRD4P
      SUBROUTINE MODEL (IDNO,NCM,NPAR,IR,IATT,LINK)                           
      USE PRMOD_CHAR, ONLY: NAME                                              
      USE SIZES,     ONLY: DPSIZE,ISIZE,SD
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      INTEGER(KIND=ISIZE) :: IDNO,NCM,NPAR,IR,IATT,LINK,I,J                   
      DIMENSION :: IATT(IR,*),LINK(IR,*)                                      
      SAVE
      INTEGER(KIND=ISIZE), DIMENSION (4,7) :: MOD
      CHARACTER(LEN=SD), DIMENSION(4) :: CMOD
      DATA (MOD(I,  1),I=  1,  4)/&
      1,1,1,1 /
      DATA (MOD(I,  2),I=  1,  4)/&
      1,1,1,1 /
      DATA (MOD(I,  3),I=  1,  4)/&
      1,1,1,1 /
      DATA (MOD(I,  4),I=  1,  4)/&
      1,0,0,0 /
      DATA (MOD(I,  5),I=  1,  4)/&
      1,0,0,0 /
      DATA (MOD(I,  6),I=  1,  4)/&
      0,0,0,0 /
      DATA (MOD(I,  7),I=  1,  4)/&
      0,0,0,0 /
      DATA (CMOD(I),I=  1,  4) &
      /'CENTRAL','TARGET','COMPLEX','PERIPH'/
      FORALL (I=1:4) NAME(I)=CMOD(I)
      FORALL (I=1:4,J=1:7) IATT(I,J)=MOD(I,J)
      IDNO=9999                                                               
      NCM=  4
      NPAR=009
      RETURN
      END
      SUBROUTINE PK(ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,IRGG,GG,NETAS)      
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMBAYES_REAL,    ONLY: PRIORINFO
      USE NMPRD_REAL,ONLY: ETA,EPS                                            
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,COMACT,COMSAV,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE NMPRD_INT, ONLY: IQUIT
      USE PROCM_INT, ONLY: NEWIND=>PNEWIF                                       
      USE PROCM_INT, ONLY: A_0FLG
      USE PRMOD_REAL,ONLY: A_0,DA_0,D2A_0
      USE NMBAYES_REAL, ONLY: LDF                                             
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                          
      REAL(KIND=DPSIZE) :: EVTREC                                               
      SAVE
      INTEGER(KIND=ISIZE) :: FIRSTEM
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS              
      DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*),GG(IRGG,GPKD+1,*) 
      FIRSTEM=IFIRSTEM
      IF (ICALL <= 1) THEN                                                      
      CALL ASSOCNMPRD4
      IDEF(   1,0001)=  -9
      IDEF(   1,0002)=  -1
      IDEF(   1,0003)=   1
      IDEF(   1,0004)=   0
      IDEF(   2,0003)=   0
      IDEF(   2,0004)=   0
      CALL GETETA(ETA)                                                          
      IF (IQUIT == 1) RETURN                                                    
      RETURN                                                                    
      ENDIF                                                                     
      IF (NEWIND /= 2) THEN
      IF (ICALL == 4) THEN
      CALL SIMETA(ETA)
      ELSE
      CALL GETETA(ETA)
      ENDIF
      IF (IQUIT == 1) RETURN
      ENDIF
 !  level            0
      B000001=DEXP(ETA(001)) 
      CL=THETA(001)*B000001 
      B000002=DEXP(ETA(002)) 
      VC=THETA(002)*B000002 
      Q=THETA(003) 
      VP=THETA(004) 
      K=CL/VC 
      K12=Q/VC 
      K21=Q/VP 
      B000016=DEXP(ETA(003)) 
      BASE=THETA(005)*B000016 
      KINT=THETA(006) 
      KDEG=THETA(007) 
      KON=THETA(008) 
      KOFF=THETA(009) 
      KSYN=BASE*KDEG 
      IF(A_0FLG == 1)THEN 
      A_0(2)=BASE 
      ENDIF 
      P000001=K 
      P000002=KON 
      P000003=KOFF 
      P000004=VC 
      P000005=K12 
      P000006=K21 
      P000007=KSYN 
      P000008=KDEG 
      P000009=KINT 
      IF (FIRSTEM == 1) THEN
!                      A000032 = DERIVATIVE OF CL W.R.T. ETA(001)
      A000032=THETA(001)*B000001 
!                      A000036 = DERIVATIVE OF VC W.R.T. ETA(002)
      A000036=THETA(002)*B000002 
      B000003=1.D0/VC 
!                      A000039 = DERIVATIVE OF K W.R.T. ETA(001)
      A000039=B000003*A000032 
      B000004=-CL/VC/VC 
!                      A000040 = DERIVATIVE OF K W.R.T. ETA(002)
      A000040=B000004*A000036 
      B000011=-Q/VC/VC 
!                      A000055 = DERIVATIVE OF K12 W.R.T. ETA(002)
      A000055=B000011*A000036 
!                      A000064 = DERIVATIVE OF BASE W.R.T. ETA(003)
      A000064=THETA(005)*B000016 
!                      A000067 = DERIVATIVE OF KSYN W.R.T. ETA(003)
      A000067=KDEG*A000064 
      IF(A_0FLG == 1)THEN 
      DA_0(002,003)=A000064 
      ENDIF 
!                      A000071 = DERIVATIVE OF P000001 W.R.T. ETA(002)
      A000071=A000040 
!                      A000072 = DERIVATIVE OF P000001 W.R.T. ETA(001)
      A000072=A000039 
!                      A000076 = DERIVATIVE OF P000004 W.R.T. ETA(002)
      A000076=A000036 
!                      A000078 = DERIVATIVE OF P000005 W.R.T. ETA(002)
      A000078=A000055 
!                      A000080 = DERIVATIVE OF P000007 W.R.T. ETA(003)
      A000080=A000067 
      GG(0001,1,1)=P000001
      GG(0001,0002,1)=A000072
      GG(0001,0003,1)=A000071
      GG(0002,1,1)=P000002
      GG(0003,1,1)=P000003
      GG(0004,1,1)=P000004
      GG(0004,0003,1)=A000076
      GG(0005,1,1)=P000005
      GG(0005,0003,1)=A000078
      GG(0006,1,1)=P000006
      GG(0007,1,1)=P000007
      GG(0007,0004,1)=A000080
      GG(0008,1,1)=P000008
      GG(0009,1,1)=P000009
      ELSE
      GG(0001,1,1)=P000001
      GG(0002,1,1)=P000002
      GG(0003,1,1)=P000003
      GG(0004,1,1)=P000004
      GG(0005,1,1)=P000005
      GG(0006,1,1)=P000006
      GG(0007,1,1)=P000007
      GG(0008,1,1)=P000008
      GG(0009,1,1)=P000009
      ENDIF
      IF (MSEC == 1) THEN
!                      A000034 = DERIVATIVE OF A000032 W.R.T. ETA(001)
      A000034=THETA(001)*B000001 
!                      A000038 = DERIVATIVE OF A000036 W.R.T. ETA(002)
      A000038=THETA(002)*B000002 
      B000007=-1.D0/VC/VC 
!                      A000043 = DERIVATIVE OF B000003 W.R.T. ETA(002)
      A000043=B000007*A000036 
!                      A000044 = DERIVATIVE OF A000039 W.R.T. ETA(002)
      A000044=A000032*A000043 
!                      A000045 = DERIVATIVE OF A000039 W.R.T. ETA(001)
      A000045=B000003*A000034 
      B000008=-1.D0/VC/VC 
!                      A000046 = DERIVATIVE OF B000004 W.R.T. ETA(001)
      A000046=B000008*A000032 
      B000009=CL/VC/VC/VC 
!                      A000047 = DERIVATIVE OF B000004 W.R.T. ETA(002)
      A000047=B000009*A000036 
      B000010=CL/VC/VC/VC 
!                      A000048 = DERIVATIVE OF B000004 W.R.T. ETA(002)
      A000048=B000010*A000036+A000047 
!                      A000049 = DERIVATIVE OF A000040 W.R.T. ETA(002)
      A000049=A000036*A000048 
!                      A000050 = DERIVATIVE OF A000040 W.R.T. ETA(002)
      A000050=B000004*A000038+A000049 
      B000014=Q/VC/VC/VC 
!                      A000057 = DERIVATIVE OF B000011 W.R.T. ETA(002)
      A000057=B000014*A000036 
      B000015=Q/VC/VC/VC 
!                      A000058 = DERIVATIVE OF B000011 W.R.T. ETA(002)
      A000058=B000015*A000036+A000057 
!                      A000059 = DERIVATIVE OF A000055 W.R.T. ETA(002)
      A000059=A000036*A000058 
!                      A000060 = DERIVATIVE OF A000055 W.R.T. ETA(002)
      A000060=B000011*A000038+A000059 
!                      A000066 = DERIVATIVE OF A000064 W.R.T. ETA(003)
      A000066=THETA(005)*B000016 
!                      A000068 = DERIVATIVE OF A000067 W.R.T. ETA(003)
      A000068=KDEG*A000066 
      IF(A_0FLG == 1)THEN 
      D2A_0(002,003,003)=A000066 
      ENDIF 
!                      A000073 = DERIVATIVE OF A000071 W.R.T. ETA(002)
      A000073=A000050 
!                      A000074 = DERIVATIVE OF A000072 W.R.T. ETA(001)
      A000074=A000045 
!                      A000075 = DERIVATIVE OF A000072 W.R.T. ETA(002)
      A000075=A000044 
!                      A000077 = DERIVATIVE OF A000076 W.R.T. ETA(002)
      A000077=A000038 
!                      A000079 = DERIVATIVE OF A000078 W.R.T. ETA(002)
      A000079=A000060 
!                      A000081 = DERIVATIVE OF A000080 W.R.T. ETA(003)
      A000081=A000068 
      GG(0001,0002,0002)=A000074
      GG(0001,0003,0002)=A000075
      GG(0001,0003,0003)=A000073
      GG(0004,0003,0003)=A000077
      GG(0005,0003,0003)=A000079
      GG(0007,0004,0004)=A000081
      ENDIF
      RETURN
      END
      SUBROUTINE ERROR (ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,F,G,HH)       
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMPRD_REAL,ONLY: ETA,EPS                                            
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,IQUIT,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE NMPRD_INT, ONLY: NEWL2
      USE PROCM_INT, ONLY: NEWIND=>PNEWIF                                       
      USE PROCM_REAL,ONLY: TSTATE
      USE PROCM_REAL,ONLY: A=>AMNT,DAETA,D2AETA
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                        
      REAL(KIND=DPSIZE) :: EVTREC                                             
      SAVE
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS                       
      DIMENSION :: IDEF(*),THETA(*),EVTREC(IREV,*),INDXS(*)                   
      REAL(KIND=DPSIZE) :: G(GERD,*),HH(HERD,*)                               
      INTEGER(KIND=ISIZE) :: FIRSTEM
      FIRSTEM=IFIRSTEM
      IF (ICALL <= 1) THEN                                                    
      CALL ASSOCNMPRD4
      IDEF(2)=0
      IDEF(3)=001
      RETURN
      ENDIF
      IF (ICALL == 4) THEN
      IF (NEWL2 == 1) THEN
      CALL SIMEPS(EPS)
      IF (IQUIT == 1) RETURN
      ENDIF
      ENDIF
 !  level            0
      CMT=EVTREC(NVNT,007)
      FDRUG=A(1)/VC 
      FTARG=A(2) 
      FCOMP=A(3) 
      Q000000=0.D0 
      IF(CMT == 1.D0)THEN 
      Q000000=1.D0 
      ENDIF 
      IPRED=Q000000*FDRUG 
      Q000002=0.D0 
      Q000003=1.D0 
      IF(CMT == 2.D0)THEN 
      Q000002=1.D0 
      Q000003=0.D0 
      ENDIF 
      B000014=Q000002*FTARG+Q000003*IPRED 
      IPRED=B000014 
      Q000004=0.D0 
      Q000005=1.D0 
      IF(CMT == 3.D0)THEN 
      Q000004=1.D0 
      Q000005=0.D0 
      ENDIF 
      B000018=Q000004*FCOMP+Q000005*B000014 
      IPRED=B000018 
      Q000006=0.D0 
      IF(CMT == 1.D0)THEN 
      Q000006=1.D0 
      B000021=1.D0+EPS(001) 
      B000022=IPRED*B000021 
!                      C000032 = DERIVATIVE OF B000022 W.R.T. EPS(001)
      C000032=IPRED 
      ENDIF 
      Y=Q000006*B000022 
!                      C000033 = DERIVATIVE OF Y W.R.T. EPS(001)
      C000033=Q000006*C000032 
      Q000008=0.D0 
      Q000009=1.D0 
      IF(CMT == 2.D0)THEN 
      Q000008=1.D0 
      Q000009=0.D0 
      B000025=1.D0+EPS(002) 
      B000026=IPRED*B000025 
!                      C000035 = DERIVATIVE OF B000026 W.R.T. EPS(002)
      C000035=IPRED 
      ENDIF 
      B000027=Q000008*B000026+Q000009*Y 
!                      C000036 = DERIVATIVE OF B000027 W.R.T. EPS(002)
      C000036=Q000008*C000035 
!                      C000037 = DERIVATIVE OF B000027 W.R.T. EPS(001)
      C000037=Q000009*C000033 
      Y=B000027 
!                      C000038 = DERIVATIVE OF Y W.R.T. EPS(001)
      C000038=C000037 
!                      C000039 = DERIVATIVE OF Y W.R.T. EPS(002)
      C000039=C000036 
      Q000010=0.D0 
      Q000011=1.D0 
      IF(CMT == 3.D0)THEN 
      Q000010=1.D0 
      Q000011=0.D0 
      B000030=1.D0+EPS(003) 
      B000031=IPRED*B000030 
!                      C000041 = DERIVATIVE OF B000031 W.R.T. EPS(003)
      C000041=IPRED 
      ENDIF 
      B000032=Q000010*B000031+Q000011*B000027 
!                      C000042 = DERIVATIVE OF B000032 W.R.T. EPS(003)
      C000042=Q000010*C000041 
!                      C000043 = DERIVATIVE OF B000032 W.R.T. EPS(001)
      C000043=Q000011*C000037 
!                      C000044 = DERIVATIVE OF B000032 W.R.T. EPS(002)
      C000044=Q000011*C000036 
      Y=B000032 
!                      C000045 = DERIVATIVE OF Y W.R.T. EPS(002)
      C000045=C000044 
!                      C000046 = DERIVATIVE OF Y W.R.T. EPS(001)
      C000046=C000043 
!                      C000047 = DERIVATIVE OF Y W.R.T. EPS(003)
      C000047=C000042 
      IF (FIRSTEM == 1) THEN !1
      B000001=1.D0/VC 
!                      D000051 = DERIVATIVE OF FDRUG W.R.T. ETA(003)
      D000051=B000001*DAETA(001,003) 
!                      D000052 = DERIVATIVE OF FDRUG W.R.T. ETA(002)
      D000052=B000001*DAETA(001,002) 
!                      D000053 = DERIVATIVE OF FDRUG W.R.T. ETA(001)
      D000053=B000001*DAETA(001,001) 
      B000002=-A(1)/VC/VC 
!                      D000054 = DERIVATIVE OF FDRUG W.R.T. ETA(002)
      D000054=B000002*A000036+D000052 
!                      D000122 = DERIVATIVE OF IPRED W.R.T. ETA(003)
      D000122=Q000000*D000051 
!                      D000123 = DERIVATIVE OF IPRED W.R.T. ETA(001)
      D000123=Q000000*D000053 
!                      D000124 = DERIVATIVE OF IPRED W.R.T. ETA(002)
      D000124=Q000000*D000054 
!                      D000140 = DERIVATIVE OF B000014 W.R.T. ETA(003)
      D000140=Q000002*DAETA(002,003) 
!                      D000141 = DERIVATIVE OF B000014 W.R.T. ETA(002)
      D000141=Q000002*DAETA(002,002) 
!                      D000142 = DERIVATIVE OF B000014 W.R.T. ETA(001)
      D000142=Q000002*DAETA(002,001) 
!                      D000143 = DERIVATIVE OF B000014 W.R.T. ETA(002)
      D000143=Q000003*D000124+D000141 
!                      D000144 = DERIVATIVE OF B000014 W.R.T. ETA(001)
      D000144=Q000003*D000123+D000142 
!                      D000145 = DERIVATIVE OF B000014 W.R.T. ETA(003)
      D000145=Q000003*D000122+D000140 
!                      D000182 = DERIVATIVE OF B000018 W.R.T. ETA(003)
      D000182=Q000004*DAETA(003,003) 
!                      D000183 = DERIVATIVE OF B000018 W.R.T. ETA(002)
      D000183=Q000004*DAETA(003,002) 
!                      D000184 = DERIVATIVE OF B000018 W.R.T. ETA(001)
      D000184=Q000004*DAETA(003,001) 
!                      D000185 = DERIVATIVE OF B000018 W.R.T. ETA(003)
      D000185=Q000005*D000145+D000182 
!                      D000186 = DERIVATIVE OF B000018 W.R.T. ETA(001)
      D000186=Q000005*D000144+D000184 
!                      D000187 = DERIVATIVE OF B000018 W.R.T. ETA(002)
      D000187=Q000005*D000143+D000183 
      IF(CMT == 1.D0)THEN 
!                      D000215 = DERIVATIVE OF B000022 W.R.T. ETA(003)
      D000215=B000021*D000185 
!                      D000216 = DERIVATIVE OF B000022 W.R.T. ETA(001)
      D000216=B000021*D000186 
!                      D000217 = DERIVATIVE OF B000022 W.R.T. ETA(002)
      D000217=B000021*D000187 
      ENDIF 
!                      D000227 = DERIVATIVE OF Y W.R.T. ETA(002)
      D000227=Q000006*D000217 
!                      D000228 = DERIVATIVE OF Y W.R.T. ETA(001)
      D000228=Q000006*D000216 
!                      D000229 = DERIVATIVE OF Y W.R.T. ETA(003)
      D000229=Q000006*D000215 
!                      D000236 = DERIVATIVE OF C000033 W.R.T. ETA(002)
      D000236=Q000006*D000187 
!                      D000237 = DERIVATIVE OF C000033 W.R.T. ETA(001)
      D000237=Q000006*D000186 
!                      D000238 = DERIVATIVE OF C000033 W.R.T. ETA(003)
      D000238=Q000006*D000185 
      IF(CMT == 2.D0)THEN 
!                      D000239 = DERIVATIVE OF B000026 W.R.T. ETA(003)
      D000239=B000025*D000185 
!                      D000240 = DERIVATIVE OF B000026 W.R.T. ETA(001)
      D000240=B000025*D000186 
!                      D000241 = DERIVATIVE OF B000026 W.R.T. ETA(002)
      D000241=B000025*D000187 
      ENDIF 
!                      D000251 = DERIVATIVE OF B000027 W.R.T. ETA(002)
      D000251=Q000008*D000241 
!                      D000252 = DERIVATIVE OF B000027 W.R.T. ETA(001)
      D000252=Q000008*D000240 
!                      D000253 = DERIVATIVE OF B000027 W.R.T. ETA(003)
      D000253=Q000008*D000239 
!                      D000254 = DERIVATIVE OF B000027 W.R.T. ETA(003)
      D000254=Q000009*D000229+D000253 
!                      D000255 = DERIVATIVE OF B000027 W.R.T. ETA(001)
      D000255=Q000009*D000228+D000252 
!                      D000256 = DERIVATIVE OF B000027 W.R.T. ETA(002)
      D000256=Q000009*D000227+D000251 
!                      D000275 = DERIVATIVE OF C000036 W.R.T. ETA(002)
      D000275=Q000008*D000187 
!                      D000276 = DERIVATIVE OF C000036 W.R.T. ETA(001)
      D000276=Q000008*D000186 
!                      D000277 = DERIVATIVE OF C000036 W.R.T. ETA(003)
      D000277=Q000008*D000185 
!                      D000278 = DERIVATIVE OF C000037 W.R.T. ETA(003)
      D000278=Q000009*D000238 
!                      D000279 = DERIVATIVE OF C000037 W.R.T. ETA(001)
      D000279=Q000009*D000237 
!                      D000280 = DERIVATIVE OF C000037 W.R.T. ETA(002)
      D000280=Q000009*D000236 
!                      D000281 = DERIVATIVE OF Y W.R.T. ETA(002)
      D000281=D000256 
!                      D000282 = DERIVATIVE OF Y W.R.T. ETA(001)
      D000282=D000255 
!                      D000283 = DERIVATIVE OF Y W.R.T. ETA(003)
      D000283=D000254 
!                      D000290 = DERIVATIVE OF C000038 W.R.T. ETA(002)
      D000290=D000280 
!                      D000291 = DERIVATIVE OF C000038 W.R.T. ETA(001)
      D000291=D000279 
!                      D000292 = DERIVATIVE OF C000038 W.R.T. ETA(003)
      D000292=D000278 
!                      D000293 = DERIVATIVE OF C000039 W.R.T. ETA(003)
      D000293=D000277 
!                      D000294 = DERIVATIVE OF C000039 W.R.T. ETA(001)
      D000294=D000276 
!                      D000295 = DERIVATIVE OF C000039 W.R.T. ETA(002)
      D000295=D000275 
      IF(CMT == 3.D0)THEN 
!                      D000296 = DERIVATIVE OF B000031 W.R.T. ETA(003)
      D000296=B000030*D000185 
!                      D000297 = DERIVATIVE OF B000031 W.R.T. ETA(001)
      D000297=B000030*D000186 
!                      D000298 = DERIVATIVE OF B000031 W.R.T. ETA(002)
      D000298=B000030*D000187 
      ENDIF 
!                      D000308 = DERIVATIVE OF B000032 W.R.T. ETA(002)
      D000308=Q000010*D000298 
!                      D000309 = DERIVATIVE OF B000032 W.R.T. ETA(001)
      D000309=Q000010*D000297 
!                      D000310 = DERIVATIVE OF B000032 W.R.T. ETA(003)
      D000310=Q000010*D000296 
!                      D000311 = DERIVATIVE OF B000032 W.R.T. ETA(002)
      D000311=Q000011*D000256+D000308 
!                      D000312 = DERIVATIVE OF B000032 W.R.T. ETA(001)
      D000312=Q000011*D000255+D000309 
!                      D000313 = DERIVATIVE OF B000032 W.R.T. ETA(003)
      D000313=Q000011*D000254+D000310 
!                      D000332 = DERIVATIVE OF C000042 W.R.T. ETA(002)
      D000332=Q000010*D000187 
!                      D000333 = DERIVATIVE OF C000042 W.R.T. ETA(001)
      D000333=Q000010*D000186 
!                      D000334 = DERIVATIVE OF C000042 W.R.T. ETA(003)
      D000334=Q000010*D000185 
!                      D000335 = DERIVATIVE OF C000043 W.R.T. ETA(002)
      D000335=Q000011*D000280 
!                      D000336 = DERIVATIVE OF C000043 W.R.T. ETA(001)
      D000336=Q000011*D000279 
!                      D000337 = DERIVATIVE OF C000043 W.R.T. ETA(003)
      D000337=Q000011*D000278 
!                      D000338 = DERIVATIVE OF C000044 W.R.T. ETA(003)
      D000338=Q000011*D000277 
!                      D000339 = DERIVATIVE OF C000044 W.R.T. ETA(001)
      D000339=Q000011*D000276 
!                      D000340 = DERIVATIVE OF C000044 W.R.T. ETA(002)
      D000340=Q000011*D000275 
!                      D000341 = DERIVATIVE OF Y W.R.T. ETA(003)
      D000341=D000313 
!                      D000342 = DERIVATIVE OF Y W.R.T. ETA(001)
      D000342=D000312 
!                      D000343 = DERIVATIVE OF Y W.R.T. ETA(002)
      D000343=D000311 
!                      D000350 = DERIVATIVE OF C000045 W.R.T. ETA(002)
      D000350=D000340 
!                      D000351 = DERIVATIVE OF C000045 W.R.T. ETA(001)
      D000351=D000339 
!                      D000352 = DERIVATIVE OF C000045 W.R.T. ETA(003)
      D000352=D000338 
!                      D000353 = DERIVATIVE OF C000046 W.R.T. ETA(003)
      D000353=D000337 
!                      D000354 = DERIVATIVE OF C000046 W.R.T. ETA(001)
      D000354=D000336 
!                      D000355 = DERIVATIVE OF C000046 W.R.T. ETA(002)
      D000355=D000335 
!                      D000356 = DERIVATIVE OF C000047 W.R.T. ETA(003)
      D000356=D000334 
!                      D000357 = DERIVATIVE OF C000047 W.R.T. ETA(001)
      D000357=D000333 
!                      D000358 = DERIVATIVE OF C000047 W.R.T. ETA(002)
      D000358=D000332 
      G(001,1)=D000342
      G(002,1)=D000343
      G(003,1)=D000341
      ENDIF !1
      HH(001,1)=C000046
      HH(002,1)=C000045
      HH(003,1)=C000047
      IF (FIRSTEM == 1) THEN !2
      HH(001,002)=D000354
      HH(002,002)=D000351
      HH(003,002)=D000357
      HH(001,003)=D000355
      HH(002,003)=D000350
      HH(003,003)=D000358
      HH(001,004)=D000353
      HH(002,004)=D000352
      HH(003,004)=D000356
      ENDIF !2
      IF (MSEC == 1) THEN
      B000004=-1.D0/VC/VC 
!                      D000056 = DERIVATIVE OF B000001 W.R.T. ETA(002)
      D000056=B000004*A000036 
!                      D000057 = DERIVATIVE OF D000051 W.R.T. ETA(003)
      D000057=B000001*D2AETA(001,003,003) 
!                      D000058 = DERIVATIVE OF D000052 W.R.T. ETA(002)
      D000058=DAETA(001,002)*D000056 
!                      D000059 = DERIVATIVE OF D000052 W.R.T. ETA(003)
      D000059=B000001*D2AETA(001,003,002) 
!                      D000060 = DERIVATIVE OF D000052 W.R.T. ETA(002)
      D000060=B000001*D2AETA(001,002,002)+D000058 
!                      D000061 = DERIVATIVE OF D000053 W.R.T. ETA(002)
      D000061=DAETA(001,001)*D000056 
!                      D000062 = DERIVATIVE OF D000053 W.R.T. ETA(003)
      D000062=B000001*D2AETA(001,003,001) 
!                      D000063 = DERIVATIVE OF D000053 W.R.T. ETA(002)
      D000063=B000001*D2AETA(001,002,001)+D000061 
!                      D000064 = DERIVATIVE OF D000053 W.R.T. ETA(001)
      D000064=B000001*D2AETA(001,001,001) 
      B000005=-1.D0/VC/VC 
!                      D000065 = DERIVATIVE OF B000002 W.R.T. ETA(003)
      D000065=B000005*DAETA(001,003) 
!                      D000066 = DERIVATIVE OF B000002 W.R.T. ETA(002)
      D000066=B000005*DAETA(001,002) 
!                      D000067 = DERIVATIVE OF B000002 W.R.T. ETA(001)
      D000067=B000005*DAETA(001,001) 
      B000006=A(1)/VC/VC/VC 
!                      D000068 = DERIVATIVE OF B000002 W.R.T. ETA(002)
      D000068=B000006*A000036+D000066 
      B000007=A(1)/VC/VC/VC 
!                      D000069 = DERIVATIVE OF B000002 W.R.T. ETA(002)
      D000069=B000007*A000036+D000068 
!                      D000070 = DERIVATIVE OF D000054 W.R.T. ETA(002)
      D000070=A000036*D000069 
!                      D000071 = DERIVATIVE OF D000054 W.R.T. ETA(003)
      D000071=A000036*D000065 
!                      D000072 = DERIVATIVE OF D000054 W.R.T. ETA(002)
      D000072=B000002*A000038+D000070 
!                      D000073 = DERIVATIVE OF D000054 W.R.T. ETA(002)
      D000073=D000060+D000072 
!                      D000074 = DERIVATIVE OF D000054 W.R.T. ETA(003)
      D000074=D000059+D000071 
!                      D000125 = DERIVATIVE OF D000122 W.R.T. ETA(003)
      D000125=Q000000*D000057 
!                      D000126 = DERIVATIVE OF D000123 W.R.T. ETA(003)
      D000126=Q000000*D000062 
!                      D000127 = DERIVATIVE OF D000123 W.R.T. ETA(002)
      D000127=Q000000*D000063 
!                      D000128 = DERIVATIVE OF D000123 W.R.T. ETA(001)
      D000128=Q000000*D000064 
!                      D000129 = DERIVATIVE OF D000124 W.R.T. ETA(002)
      D000129=Q000000*D000073 
!                      D000130 = DERIVATIVE OF D000124 W.R.T. ETA(003)
      D000130=Q000000*D000074 
!                      D000146 = DERIVATIVE OF D000140 W.R.T. ETA(003)
      D000146=Q000002*D2AETA(002,003,003) 
!                      D000147 = DERIVATIVE OF D000141 W.R.T. ETA(003)
      D000147=Q000002*D2AETA(002,003,002) 
!                      D000148 = DERIVATIVE OF D000141 W.R.T. ETA(002)
      D000148=Q000002*D2AETA(002,002,002) 
!                      D000149 = DERIVATIVE OF D000142 W.R.T. ETA(003)
      D000149=Q000002*D2AETA(002,003,001) 
!                      D000150 = DERIVATIVE OF D000142 W.R.T. ETA(002)
      D000150=Q000002*D2AETA(002,002,001) 
!                      D000151 = DERIVATIVE OF D000142 W.R.T. ETA(001)
      D000151=Q000002*D2AETA(002,001,001) 
!                      D000152 = DERIVATIVE OF D000143 W.R.T. ETA(003)
      D000152=Q000003*D000130 
!                      D000153 = DERIVATIVE OF D000143 W.R.T. ETA(002)
      D000153=Q000003*D000129 
!                      D000154 = DERIVATIVE OF D000143 W.R.T. ETA(002)
      D000154=D000148+D000153 
!                      D000155 = DERIVATIVE OF D000143 W.R.T. ETA(003)
      D000155=D000147+D000152 
!                      D000156 = DERIVATIVE OF D000144 W.R.T. ETA(001)
      D000156=Q000003*D000128 
!                      D000157 = DERIVATIVE OF D000144 W.R.T. ETA(002)
      D000157=Q000003*D000127 
!                      D000158 = DERIVATIVE OF D000144 W.R.T. ETA(003)
      D000158=Q000003*D000126 
!                      D000159 = DERIVATIVE OF D000144 W.R.T. ETA(001)
      D000159=D000151+D000156 
!                      D000160 = DERIVATIVE OF D000144 W.R.T. ETA(002)
      D000160=D000150+D000157 
!                      D000161 = DERIVATIVE OF D000144 W.R.T. ETA(003)
      D000161=D000149+D000158 
!                      D000162 = DERIVATIVE OF D000145 W.R.T. ETA(003)
      D000162=Q000003*D000125 
!                      D000163 = DERIVATIVE OF D000145 W.R.T. ETA(003)
      D000163=D000146+D000162 
!                      D000188 = DERIVATIVE OF D000182 W.R.T. ETA(003)
      D000188=Q000004*D2AETA(003,003,003) 
!                      D000189 = DERIVATIVE OF D000183 W.R.T. ETA(003)
      D000189=Q000004*D2AETA(003,003,002) 
!                      D000190 = DERIVATIVE OF D000183 W.R.T. ETA(002)
      D000190=Q000004*D2AETA(003,002,002) 
!                      D000191 = DERIVATIVE OF D000184 W.R.T. ETA(003)
      D000191=Q000004*D2AETA(003,003,001) 
!                      D000192 = DERIVATIVE OF D000184 W.R.T. ETA(002)
      D000192=Q000004*D2AETA(003,002,001) 
!                      D000193 = DERIVATIVE OF D000184 W.R.T. ETA(001)
      D000193=Q000004*D2AETA(003,001,001) 
!                      D000194 = DERIVATIVE OF D000185 W.R.T. ETA(003)
      D000194=Q000005*D000163 
!                      D000195 = DERIVATIVE OF D000185 W.R.T. ETA(003)
      D000195=D000188+D000194 
!                      D000196 = DERIVATIVE OF D000186 W.R.T. ETA(003)
      D000196=Q000005*D000161 
!                      D000197 = DERIVATIVE OF D000186 W.R.T. ETA(002)
      D000197=Q000005*D000160 
!                      D000198 = DERIVATIVE OF D000186 W.R.T. ETA(001)
      D000198=Q000005*D000159 
!                      D000199 = DERIVATIVE OF D000186 W.R.T. ETA(001)
      D000199=D000193+D000198 
!                      D000200 = DERIVATIVE OF D000186 W.R.T. ETA(002)
      D000200=D000192+D000197 
!                      D000201 = DERIVATIVE OF D000186 W.R.T. ETA(003)
      D000201=D000191+D000196 
!                      D000202 = DERIVATIVE OF D000187 W.R.T. ETA(003)
      D000202=Q000005*D000155 
!                      D000203 = DERIVATIVE OF D000187 W.R.T. ETA(002)
      D000203=Q000005*D000154 
!                      D000204 = DERIVATIVE OF D000187 W.R.T. ETA(002)
      D000204=D000190+D000203 
!                      D000205 = DERIVATIVE OF D000187 W.R.T. ETA(003)
      D000205=D000189+D000202 
      IF(CMT == 1.D0)THEN 
!                      D000218 = DERIVATIVE OF D000215 W.R.T. ETA(003)
      D000218=B000021*D000195 
!                      D000219 = DERIVATIVE OF D000216 W.R.T. ETA(001)
      D000219=B000021*D000199 
!                      D000220 = DERIVATIVE OF D000216 W.R.T. ETA(002)
      D000220=B000021*D000200 
!                      D000221 = DERIVATIVE OF D000216 W.R.T. ETA(003)
      D000221=B000021*D000201 
!                      D000222 = DERIVATIVE OF D000217 W.R.T. ETA(002)
      D000222=B000021*D000204 
!                      D000223 = DERIVATIVE OF D000217 W.R.T. ETA(003)
      D000223=B000021*D000205 
      ENDIF 
!                      D000230 = DERIVATIVE OF D000227 W.R.T. ETA(003)
      D000230=Q000006*D000223 
!                      D000231 = DERIVATIVE OF D000227 W.R.T. ETA(002)
      D000231=Q000006*D000222 
!                      D000232 = DERIVATIVE OF D000228 W.R.T. ETA(003)
      D000232=Q000006*D000221 
!                      D000233 = DERIVATIVE OF D000228 W.R.T. ETA(002)
      D000233=Q000006*D000220 
!                      D000234 = DERIVATIVE OF D000228 W.R.T. ETA(001)
      D000234=Q000006*D000219 
!                      D000235 = DERIVATIVE OF D000229 W.R.T. ETA(003)
      D000235=Q000006*D000218 
      IF(CMT == 2.D0)THEN 
!                      D000242 = DERIVATIVE OF D000239 W.R.T. ETA(003)
      D000242=B000025*D000195 
!                      D000243 = DERIVATIVE OF D000240 W.R.T. ETA(001)
      D000243=B000025*D000199 
!                      D000244 = DERIVATIVE OF D000240 W.R.T. ETA(002)
      D000244=B000025*D000200 
!                      D000245 = DERIVATIVE OF D000240 W.R.T. ETA(003)
      D000245=B000025*D000201 
!                      D000246 = DERIVATIVE OF D000241 W.R.T. ETA(002)
      D000246=B000025*D000204 
!                      D000247 = DERIVATIVE OF D000241 W.R.T. ETA(003)
      D000247=B000025*D000205 
      ENDIF 
!                      D000257 = DERIVATIVE OF D000251 W.R.T. ETA(003)
      D000257=Q000008*D000247 
!                      D000258 = DERIVATIVE OF D000251 W.R.T. ETA(002)
      D000258=Q000008*D000246 
!                      D000259 = DERIVATIVE OF D000252 W.R.T. ETA(003)
      D000259=Q000008*D000245 
!                      D000260 = DERIVATIVE OF D000252 W.R.T. ETA(002)
      D000260=Q000008*D000244 
!                      D000261 = DERIVATIVE OF D000252 W.R.T. ETA(001)
      D000261=Q000008*D000243 
!                      D000262 = DERIVATIVE OF D000253 W.R.T. ETA(003)
      D000262=Q000008*D000242 
!                      D000263 = DERIVATIVE OF D000254 W.R.T. ETA(003)
      D000263=Q000009*D000235 
!                      D000264 = DERIVATIVE OF D000254 W.R.T. ETA(003)
      D000264=D000262+D000263 
!                      D000265 = DERIVATIVE OF D000255 W.R.T. ETA(001)
      D000265=Q000009*D000234 
!                      D000266 = DERIVATIVE OF D000255 W.R.T. ETA(002)
      D000266=Q000009*D000233 
!                      D000267 = DERIVATIVE OF D000255 W.R.T. ETA(003)
      D000267=Q000009*D000232 
!                      D000268 = DERIVATIVE OF D000255 W.R.T. ETA(001)
      D000268=D000261+D000265 
!                      D000269 = DERIVATIVE OF D000255 W.R.T. ETA(002)
      D000269=D000260+D000266 
!                      D000270 = DERIVATIVE OF D000255 W.R.T. ETA(003)
      D000270=D000259+D000267 
!                      D000271 = DERIVATIVE OF D000256 W.R.T. ETA(002)
      D000271=Q000009*D000231 
!                      D000272 = DERIVATIVE OF D000256 W.R.T. ETA(003)
      D000272=Q000009*D000230 
!                      D000273 = DERIVATIVE OF D000256 W.R.T. ETA(002)
      D000273=D000258+D000271 
!                      D000274 = DERIVATIVE OF D000256 W.R.T. ETA(003)
      D000274=D000257+D000272 
!                      D000284 = DERIVATIVE OF D000281 W.R.T. ETA(003)
      D000284=D000274 
!                      D000285 = DERIVATIVE OF D000281 W.R.T. ETA(002)
      D000285=D000273 
!                      D000286 = DERIVATIVE OF D000282 W.R.T. ETA(003)
      D000286=D000270 
!                      D000287 = DERIVATIVE OF D000282 W.R.T. ETA(002)
      D000287=D000269 
!                      D000288 = DERIVATIVE OF D000282 W.R.T. ETA(001)
      D000288=D000268 
!                      D000289 = DERIVATIVE OF D000283 W.R.T. ETA(003)
      D000289=D000264 
      IF(CMT == 3.D0)THEN 
!                      D000299 = DERIVATIVE OF D000296 W.R.T. ETA(003)
      D000299=B000030*D000195 
!                      D000300 = DERIVATIVE OF D000297 W.R.T. ETA(001)
      D000300=B000030*D000199 
!                      D000301 = DERIVATIVE OF D000297 W.R.T. ETA(002)
      D000301=B000030*D000200 
!                      D000302 = DERIVATIVE OF D000297 W.R.T. ETA(003)
      D000302=B000030*D000201 
!                      D000303 = DERIVATIVE OF D000298 W.R.T. ETA(002)
      D000303=B000030*D000204 
!                      D000304 = DERIVATIVE OF D000298 W.R.T. ETA(003)
      D000304=B000030*D000205 
      ENDIF 
!                      D000314 = DERIVATIVE OF D000308 W.R.T. ETA(003)
      D000314=Q000010*D000304 
!                      D000315 = DERIVATIVE OF D000308 W.R.T. ETA(002)
      D000315=Q000010*D000303 
!                      D000316 = DERIVATIVE OF D000309 W.R.T. ETA(003)
      D000316=Q000010*D000302 
!                      D000317 = DERIVATIVE OF D000309 W.R.T. ETA(002)
      D000317=Q000010*D000301 
!                      D000318 = DERIVATIVE OF D000309 W.R.T. ETA(001)
      D000318=Q000010*D000300 
!                      D000319 = DERIVATIVE OF D000310 W.R.T. ETA(003)
      D000319=Q000010*D000299 
!                      D000320 = DERIVATIVE OF D000311 W.R.T. ETA(003)
      D000320=Q000011*D000274 
!                      D000321 = DERIVATIVE OF D000311 W.R.T. ETA(002)
      D000321=Q000011*D000273 
!                      D000322 = DERIVATIVE OF D000311 W.R.T. ETA(002)
      D000322=D000315+D000321 
!                      D000323 = DERIVATIVE OF D000311 W.R.T. ETA(003)
      D000323=D000314+D000320 
!                      D000324 = DERIVATIVE OF D000312 W.R.T. ETA(003)
      D000324=Q000011*D000270 
!                      D000325 = DERIVATIVE OF D000312 W.R.T. ETA(002)
      D000325=Q000011*D000269 
!                      D000326 = DERIVATIVE OF D000312 W.R.T. ETA(001)
      D000326=Q000011*D000268 
!                      D000327 = DERIVATIVE OF D000312 W.R.T. ETA(001)
      D000327=D000318+D000326 
!                      D000328 = DERIVATIVE OF D000312 W.R.T. ETA(002)
      D000328=D000317+D000325 
!                      D000329 = DERIVATIVE OF D000312 W.R.T. ETA(003)
      D000329=D000316+D000324 
!                      D000330 = DERIVATIVE OF D000313 W.R.T. ETA(003)
      D000330=Q000011*D000264 
!                      D000331 = DERIVATIVE OF D000313 W.R.T. ETA(003)
      D000331=D000319+D000330 
!                      D000344 = DERIVATIVE OF D000341 W.R.T. ETA(003)
      D000344=D000331 
!                      D000345 = DERIVATIVE OF D000342 W.R.T. ETA(003)
      D000345=D000329 
!                      D000346 = DERIVATIVE OF D000342 W.R.T. ETA(002)
      D000346=D000328 
!                      D000347 = DERIVATIVE OF D000342 W.R.T. ETA(001)
      D000347=D000327 
!                      D000348 = DERIVATIVE OF D000343 W.R.T. ETA(003)
      D000348=D000323 
!                      D000349 = DERIVATIVE OF D000343 W.R.T. ETA(002)
      D000349=D000322 
      G(001,002)=D000347
      G(002,002)=D000346
      G(002,003)=D000349
      G(003,002)=D000345
      G(003,003)=D000348
      G(003,004)=D000344
      ENDIF
      F=Y
      RETURN
      END
      SUBROUTINE TOL(NRD,ANRD,NRDC,ANRDC)
      USE SIZES,     ONLY: ISIZE
      INTEGER(KIND=ISIZE) :: NRD(0:*), ANRD(0:*), NRDC(0:*), ANRDC(0:*)
      NRD(1)=4 
      RETURN
      END
      SUBROUTINE DES (A,P,T,DADT,IR,DA,DP,DT)                                 
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMPRD_INT, ONLY: IERPRD,IERPRDU,NETEXT,IQUIT                        
      USE NMPRD_CHAR,ONLY: ETEXT                                              
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,IFIRSTEM,IFIRSTEMJAC
      USE PRCOM_INT, ONLY: MITER
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE PRMOD_INT, ONLY: ICALL=>ICALLD,IDEFD,IDEFA
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)                                        
      SAVE
      INTEGER(KIND=ISIZE) :: IR                                               
      DIMENSION :: A(*),P(*),DADT(*),DA(IR,*),DP(IR,*),DT(*)                  
      INTEGER(KIND=ISIZE) :: FIRSTEM,IFIRSTEMJACIN
      IF(MITER==1.OR.MITER==4) IFIRSTEM=1
      FIRSTEM=IFIRSTEM
      IFIRSTEMJACIN=IFIRSTEMJAC
      IF(NOFIRSTDERCODE/=1) THEN
      IFIRSTEMJAC=FIRSTEM
      ELSE
      IFIRSTEMJAC=0
      ENDIF
      IF(IFIRSTEMJACIN==-2) RETURN
      IF (ICALL == 1) THEN
      CALL ASSOCNMPRD4
      IDEFD(1)=  0
      IDEFD(2)=0
      DA(   1,1)=0000014280
      DA(   2,1)=0000014399
      DA(   3,1)=0000014518
      DA(   4,1)=0000014637
      DA(   5,1)=0000028441
      DA(   6,1)=0000028560
      DA(   7,1)=0000028679
      DA(   8,1)=0000042602
      DA(   9,1)=0000042721
      DA(  10,1)=0000042840
      DA(  11,1)=0000056763
      DA(  12,1)=0000057120
      DA(  13,1)=0000014400
      DA(  14,1)=0000028561
      DA(  15,1)=0000042722
      DA(  16,1)=0000014282
      DA(  17,1)=0000028443
      DA(  18,1)=0000042604
      DA(  19,1)=0000014311
      DA(  20,1)=0000014312
      DA(  21,1)=0000014315
      DA(  22,1)=0000028473
      DA(  23,1)=0000028475
      DA(  24,1)=0000042634
      DA(  25,1)=0000042636
      DA(  26,1)=0000056798
      DA(  27,1)=0000014431
      DA(  28,1)=0000028592
      DA(  29,1)=0000028594
      DA(  30,1)=0000028598
      DA(  31,1)=0000042753
      DA(  32,1)=0000042755
      DA(  33,1)=0000014551
      DA(  34,1)=0000014552
      DA(  35,1)=0000028712
      DA(  36,1)=0000042873
      DA(  37,1)=0000042879
      DA(  38,1)=0000014673
      DA(  39,1)=0000057156
      DA(  40,1)=0000000000
      DP(   1,1)=0000014280
      DP(   2,1)=0000014399
      DP(   3,1)=0000014518
      DP(   4,1)=0000014637
      DP(   5,1)=0000014756
      DP(   6,1)=0000014875
      DP(   7,1)=0000028560
      DP(   8,1)=0000028679
      DP(   9,1)=0000028798
      DP(  10,1)=0000029155
      DP(  11,1)=0000029274
      DP(  12,1)=0000042721
      DP(  13,1)=0000042840
      DP(  14,1)=0000042959
      DP(  15,1)=0000043554
      DP(  16,1)=0000057239
      DP(  17,1)=0000057358
      DP(  18,1)=0000028800
      DP(  19,1)=0000042961
      DP(  20,1)=0000014640
      DP(  21,1)=0000014522
      DP(  22,1)=0000028564
      DP(  23,1)=0000028802
      DP(  24,1)=0000042725
      DP(  25,1)=0000042963
      DP(  26,1)=0000000000
      DT(   1)=0000000000
      RETURN
      ENDIF
 !  level            0
 !  level            0
      DADT(1)=-P(001)*A(1)-P(002)*A(2)*A(1)+P(003)*A(3)*P(004)-P(005)* &
      A(1)+P(006)*A(4) 
      DADT(2)=P(007)-P(008)*A(2)-P(002)*A(2)*A(1)/P(004)+P(003)*A(3) 
      B000021=P(003)+P(009) 
      DADT(3)=P(002)*A(2)*A(1)/P(004)-B000021*A(3) 
      DADT(4)=P(005)*A(1)-P(006)*A(4) 
      IF (FIRSTEM == 1) THEN ! 1
!                      E000006 = DERIVATIVE OF DADT(1) W.R.T. A(001)
      E000006=-P(001) 
      B000001=-P(002)*A(1) 
!                      E000007 = DERIVATIVE OF DADT(1) W.R.T. A(002)
      E000007=B000001 
      B000002=-P(002)*A(2) 
!                      E000008 = DERIVATIVE OF DADT(1) W.R.T. A(001)
      E000008=B000002+E000006 
      B000003=P(003)*P(004) 
!                      E000009 = DERIVATIVE OF DADT(1) W.R.T. A(003)
      E000009=B000003 
!                      E000010 = DERIVATIVE OF DADT(1) W.R.T. A(001)
      E000010=-P(005)+E000008 
!                      E000011 = DERIVATIVE OF DADT(1) W.R.T. A(004)
      E000011=P(006) 
!                      F000081 = DERIVATIVE OF DADT(1) W.R.T. P(001)
      F000081=-A(1) 
      B000004=-A(2)*A(1) 
!                      F000082 = DERIVATIVE OF DADT(1) W.R.T. P(002)
      F000082=B000004 
      B000005=A(3)*P(004) 
!                      F000083 = DERIVATIVE OF DADT(1) W.R.T. P(003)
      F000083=B000005 
      B000006=P(003)*A(3) 
!                      F000084 = DERIVATIVE OF DADT(1) W.R.T. P(004)
      F000084=B000006 
!                      F000085 = DERIVATIVE OF DADT(1) W.R.T. P(005)
      F000085=-A(1) 
!                      F000086 = DERIVATIVE OF DADT(1) W.R.T. P(006)
      F000086=A(4) 
!                      E000028 = DERIVATIVE OF DADT(2) W.R.T. A(002)
      E000028=-P(008) 
      B000007=-P(002)*A(1)/P(004) 
!                      E000029 = DERIVATIVE OF DADT(2) W.R.T. A(002)
      E000029=B000007+E000028 
      B000008=-P(002)*A(2)/P(004) 
!                      E000030 = DERIVATIVE OF DADT(2) W.R.T. A(001)
      E000030=B000008 
!                      E000031 = DERIVATIVE OF DADT(2) W.R.T. A(003)
      E000031=P(003) 
!                      F000091 = DERIVATIVE OF DADT(2) W.R.T. P(007)
      F000091=1.D0 
!                      F000092 = DERIVATIVE OF DADT(2) W.R.T. P(008)
      F000092=-A(2) 
      B000011=-A(2)*A(1)/P(004) 
!                      F000093 = DERIVATIVE OF DADT(2) W.R.T. P(002)
      F000093=B000011 
      B000012=P(002)*A(2)*A(1)/P(004)/P(004) 
!                      F000094 = DERIVATIVE OF DADT(2) W.R.T. P(004)
      F000094=B000012 
!                      F000095 = DERIVATIVE OF DADT(2) W.R.T. P(003)
      F000095=A(3) 
      B000022=P(002)*A(1)/P(004) 
!                      E000046 = DERIVATIVE OF DADT(3) W.R.T. A(002)
      E000046=B000022 
      B000023=P(002)*A(2)/P(004) 
!                      E000047 = DERIVATIVE OF DADT(3) W.R.T. A(001)
      E000047=B000023 
!                      E000048 = DERIVATIVE OF DADT(3) W.R.T. A(003)
      E000048=-B000021 
      B000026=A(2)*A(1)/P(004) 
!                      F000105 = DERIVATIVE OF DADT(3) W.R.T. P(002)
      F000105=B000026 
      B000027=-P(002)*A(2)*A(1)/P(004)/P(004) 
!                      F000106 = DERIVATIVE OF DADT(3) W.R.T. P(004)
      F000106=B000027 
!                      F000107 = DERIVATIVE OF DADT(3) W.R.T. P(009)
      F000107=-A(3) 
!                      F000108 = DERIVATIVE OF DADT(3) W.R.T. P(003)
      F000108=-A(3) 
!                      E000063 = DERIVATIVE OF DADT(4) W.R.T. A(001)
      E000063=P(005) 
!                      E000064 = DERIVATIVE OF DADT(4) W.R.T. A(004)
      E000064=-P(006) 
!                      F000116 = DERIVATIVE OF DADT(4) W.R.T. P(005)
      F000116=A(1) 
!                      F000117 = DERIVATIVE OF DADT(4) W.R.T. P(006)
      F000117=-A(4) 
      ENDIF !1
      IF (MSEC == 1) THEN 
!                      E000012 = DERIVATIVE OF B000001 W.R.T. A(001)
      E000012=-P(002) 
!                      E000013 = DERIVATIVE OF E000007 W.R.T. A(001)
      E000013=E000012 
!                      E000014 = DERIVATIVE OF B000002 W.R.T. A(002)
      E000014=-P(002) 
!                      E000015 = DERIVATIVE OF E000008 W.R.T. A(002)
      E000015=E000014 
!                      E000016 = DERIVATIVE OF E000010 W.R.T. A(002)
      E000016=E000015 
!                      F000088 = DERIVATIVE OF F000083 W.R.T. P(004)
      F000088=A(3) 
!                      F000090 = DERIVATIVE OF F000084 W.R.T. P(003)
      F000090=A(3) 
!                      E000017 = DERIVATIVE OF F000081 W.R.T. A(001)
      E000017=-1.D0 
!                      E000018 = DERIVATIVE OF B000004 W.R.T. A(002)
      E000018=-A(1) 
!                      E000019 = DERIVATIVE OF B000004 W.R.T. A(001)
      E000019=-A(2) 
!                      E000020 = DERIVATIVE OF F000082 W.R.T. A(001)
      E000020=E000019 
!                      E000021 = DERIVATIVE OF F000082 W.R.T. A(002)
      E000021=E000018 
!                      E000023 = DERIVATIVE OF F000083 W.R.T. A(003)
      E000023=P(004) 
!                      E000025 = DERIVATIVE OF F000084 W.R.T. A(003)
      E000025=P(003) 
!                      E000026 = DERIVATIVE OF F000085 W.R.T. A(001)
      E000026=-1.D0 
!                      E000027 = DERIVATIVE OF F000086 W.R.T. A(004)
      E000027=1.D0 
      B000009=-P(002)/P(004) 
!                      E000033 = DERIVATIVE OF E000029 W.R.T. A(001)
      E000033=B000009 
      B000010=-P(002)/P(004) 
!                      E000035 = DERIVATIVE OF E000030 W.R.T. A(002)
      E000035=B000010 
      B000013=A(2)*A(1)/P(004)/P(004) 
!                      F000097 = DERIVATIVE OF F000093 W.R.T. P(004)
      F000097=B000013 
      B000014=A(2)*A(1)/P(004)/P(004) 
      B000015=-P(002)*A(2)*A(1)/P(004)/P(004)/P(004) 
      B000016=-P(002)*A(2)*A(1)/P(004)/P(004)/P(004) 
!                      F000100 = DERIVATIVE OF B000012 W.R.T. P(004)
      F000100=B000016+B000015 
!                      F000101 = DERIVATIVE OF F000094 W.R.T. P(004)
      F000101=F000100 
!                      F000102 = DERIVATIVE OF F000094 W.R.T. P(002)
      F000102=B000014 
!                      E000036 = DERIVATIVE OF F000092 W.R.T. A(002)
      E000036=-1.D0 
      B000017=-A(1)/P(004) 
      B000018=-A(2)/P(004) 
!                      E000039 = DERIVATIVE OF F000093 W.R.T. A(001)
      E000039=B000018 
!                      E000040 = DERIVATIVE OF F000093 W.R.T. A(002)
      E000040=B000017 
      B000019=P(002)*A(1)/P(004)/P(004) 
      B000020=P(002)*A(2)/P(004)/P(004) 
!                      E000043 = DERIVATIVE OF F000094 W.R.T. A(001)
      E000043=B000020 
!                      E000044 = DERIVATIVE OF F000094 W.R.T. A(002)
      E000044=B000019 
!                      E000045 = DERIVATIVE OF F000095 W.R.T. A(003)
      E000045=1.D0 
      B000024=P(002)/P(004) 
!                      E000050 = DERIVATIVE OF E000046 W.R.T. A(001)
      E000050=B000024 
      B000025=P(002)/P(004) 
!                      E000052 = DERIVATIVE OF E000047 W.R.T. A(002)
      E000052=B000025 
      B000028=-A(2)*A(1)/P(004)/P(004) 
!                      F000110 = DERIVATIVE OF F000105 W.R.T. P(004)
      F000110=B000028 
      B000029=-A(2)*A(1)/P(004)/P(004) 
      B000030=P(002)*A(2)*A(1)/P(004)/P(004)/P(004) 
      B000031=P(002)*A(2)*A(1)/P(004)/P(004)/P(004) 
!                      F000113 = DERIVATIVE OF B000027 W.R.T. P(004)
      F000113=B000031+B000030 
!                      F000114 = DERIVATIVE OF F000106 W.R.T. P(004)
      F000114=F000113 
!                      F000115 = DERIVATIVE OF F000106 W.R.T. P(002)
      F000115=B000029 
      B000032=A(1)/P(004) 
      B000033=A(2)/P(004) 
!                      E000055 = DERIVATIVE OF F000105 W.R.T. A(001)
      E000055=B000033 
!                      E000056 = DERIVATIVE OF F000105 W.R.T. A(002)
      E000056=B000032 
      B000034=-P(002)*A(1)/P(004)/P(004) 
      B000035=-P(002)*A(2)/P(004)/P(004) 
!                      E000059 = DERIVATIVE OF F000106 W.R.T. A(001)
      E000059=B000035 
!                      E000060 = DERIVATIVE OF F000106 W.R.T. A(002)
      E000060=B000034 
!                      E000061 = DERIVATIVE OF F000107 W.R.T. A(003)
      E000061=-1.D0 
!                      E000062 = DERIVATIVE OF F000108 W.R.T. A(003)
      E000062=-1.D0 
!                      E000065 = DERIVATIVE OF F000116 W.R.T. A(001)
      E000065=1.D0 
!                      E000066 = DERIVATIVE OF F000117 W.R.T. A(004)
      E000066=-1.D0 
      ENDIF !msec
      IF (FIRSTEM == 1) THEN !2
      DA(   1,1)=E000010
      DA(   2,1)=E000007
      DA(   3,1)=E000009
      DA(   4,1)=E000011
      DA(   5,1)=E000030
      DA(   6,1)=E000029
      DA(   7,1)=E000031
      DA(   8,1)=E000047
      DA(   9,1)=E000046
      DA(  10,1)=E000048
      DA(  11,1)=E000063
      DA(  12,1)=E000064
      DP(   1,1)=F000081
      DP(   2,1)=F000082
      DP(   3,1)=F000083
      DP(   4,1)=F000084
      DP(   5,1)=F000085
      DP(   6,1)=F000086
      DP(   7,1)=F000093
      DP(   8,1)=F000095
      DP(   9,1)=F000094
      DP(  10,1)=F000091
      DP(  11,1)=F000092
      DP(  12,1)=F000105
      DP(  13,1)=F000108
      DP(  14,1)=F000106
      DP(  15,1)=F000107
      DP(  16,1)=F000116
      DP(  17,1)=F000117
      ENDIF !2
      IF (MSEC == 1) THEN
      DA(  13,1)=E000013
      DA(  14,1)=E000033
      DA(  15,1)=E000050
      DA(  16,1)=E000016
      DA(  17,1)=E000035
      DA(  18,1)=E000052
      DA(  19,1)=E000017
      DA(  20,1)=E000020
      DA(  21,1)=E000026
      DA(  22,1)=E000039
      DA(  23,1)=E000043
      DA(  24,1)=E000055
      DA(  25,1)=E000059
      DA(  26,1)=E000065
      DA(  27,1)=E000021
      DA(  28,1)=E000040
      DA(  29,1)=E000044
      DA(  30,1)=E000036
      DA(  31,1)=E000056
      DA(  32,1)=E000060
      DA(  33,1)=E000023
      DA(  34,1)=E000025
      DA(  35,1)=E000045
      DA(  36,1)=E000062
      DA(  37,1)=E000061
      DA(  38,1)=E000027
      DA(  39,1)=E000066
      DP(  18,1)=F000102
      DP(  19,1)=F000115
      DP(  20,1)=F000090
      DP(  21,1)=F000088
      DP(  22,1)=F000097
      DP(  23,1)=F000101
      DP(  24,1)=F000110
      DP(  25,1)=F000114
      ENDIF
      RETURN
      END
      SUBROUTINE FSIZESR(NAME_FSIZES,F_SIZES)
      USE SIZES, ONLY: ISIZE
      INTEGER(KIND=ISIZE), DIMENSION(*) :: F_SIZES
      CHARACTER(LEN=*),    DIMENSION(*) :: NAME_FSIZES
      NAME_FSIZES(01)='LTH'; F_SIZES(01)=9
      NAME_FSIZES(02)='LVR'; F_SIZES(02)=6
      NAME_FSIZES(03)='LVR2'; F_SIZES(03)=0
      NAME_FSIZES(04)='LPAR'; F_SIZES(04)=21
      NAME_FSIZES(05)='LPAR3'; F_SIZES(05)=0
      NAME_FSIZES(06)='NO'; F_SIZES(06)=0
      NAME_FSIZES(07)='MMX'; F_SIZES(07)=1
      NAME_FSIZES(08)='LNP4'; F_SIZES(08)=0
      NAME_FSIZES(09)='LSUPP'; F_SIZES(09)=1
      NAME_FSIZES(10)='LIM7'; F_SIZES(10)=0
      NAME_FSIZES(11)='LWS3'; F_SIZES(11)=0
      NAME_FSIZES(12)='MAXIDS'; F_SIZES(12)=15
      NAME_FSIZES(13)='LIM1'; F_SIZES(13)=0
      NAME_FSIZES(14)='LIM2'; F_SIZES(14)=0
      NAME_FSIZES(15)='LIM3'; F_SIZES(15)=0
      NAME_FSIZES(16)='LIM4'; F_SIZES(16)=0
      NAME_FSIZES(17)='LIM5'; F_SIZES(17)=0
      NAME_FSIZES(18)='LIM6'; F_SIZES(18)=0
      NAME_FSIZES(19)='LIM8'; F_SIZES(19)=0
      NAME_FSIZES(20)='LIM10'; F_SIZES(20)=0
      NAME_FSIZES(21)='LIM11'; F_SIZES(21)=0
      NAME_FSIZES(22)='LIM13'; F_SIZES(22)=0
      NAME_FSIZES(23)='LIM15'; F_SIZES(23)=0
      NAME_FSIZES(24)='LIM16'; F_SIZES(24)=0
      NAME_FSIZES(25)='MAXRECID'; F_SIZES(25)=0
      NAME_FSIZES(26)='PC'; F_SIZES(26)=0
      NAME_FSIZES(27)='PCT'; F_SIZES(27)=1
      NAME_FSIZES(28)='PIR'; F_SIZES(28)=40
      NAME_FSIZES(29)='PD'; F_SIZES(29)=9
      NAME_FSIZES(30)='PAL'; F_SIZES(30)=0
      NAME_FSIZES(31)='MAXFCN'; F_SIZES(31)=0
      NAME_FSIZES(32)='MAXIC'; F_SIZES(32)=0
      NAME_FSIZES(33)='PG'; F_SIZES(33)=0
      NAME_FSIZES(34)='NPOPMIXMAX'; F_SIZES(34)=0
      NAME_FSIZES(35)='MAXOMEG'; F_SIZES(35)=3
      NAME_FSIZES(36)='MAXPTHETA'; F_SIZES(36)=15
      NAME_FSIZES(37)='MAXITER'; F_SIZES(37)=20
      NAME_FSIZES(38)='ISAMPLEMAX'; F_SIZES(38)=0
      NAME_FSIZES(39)='DIMTMP'; F_SIZES(39)=0
      NAME_FSIZES(40)='DIMCNS'; F_SIZES(40)=0
      NAME_FSIZES(41)='DIMNEW'; F_SIZES(41)=0
      NAME_FSIZES(42)='PDT'; F_SIZES(42)=17
      NAME_FSIZES(43)='LADD_MAX'; F_SIZES(43)=0
      NAME_FSIZES(44)='MAXSIDL'; F_SIZES(44)=0
      NAME_FSIZES(45)='NTT'; F_SIZES(45)=9
      NAME_FSIZES(46)='NOMEG'; F_SIZES(46)=3
      NAME_FSIZES(47)='NSIGM'; F_SIZES(47)=3
      NAME_FSIZES(48)='PPDT'; F_SIZES(48)=14
      RETURN
      END SUBROUTINE FSIZESR
      SUBROUTINE MUMODEL2(THETA,MU_,ICALL,IDEF,NEWIND,&
      EVTREC,DATREC,IREV,NVNT,INDXS,F,G,H,IRGG,GG,NETAS)
      USE NMPRD4P
      USE SIZES,     ONLY: DPSIZE,ISIZE
      USE PRDIMS,    ONLY: GPRD,HPRD,GERD,HERD,GPKD
      USE NMBAYES_REAL,    ONLY: PRIORINFO
      USE NMPRD_REAL,ONLY: ETA,EPS
      USE NMPRD_INT, ONLY: MSEC=>ISECDER,MFIRST=>IFRSTDER,COMACT,COMSAV,IFIRSTEM
      USE NMPRD_INT, ONLY: MDVRES,ETASXI,NPDE_MODE,NOFIRSTDERCODE
      USE NMPRD_REAL, ONLY: DV_LOQ,CDF_L,DV_LAQ,CDF_LA
      USE NMPRD_INT, ONLY: IQUIT
      USE PROCM_INT, ONLY: A_0FLG
      USE PRMOD_REAL,ONLY: A_0,DA_0,D2A_0
      USE NMBAYES_REAL, ONLY: LDF
      IMPLICIT REAL(KIND=DPSIZE) (A-Z)
      REAL(KIND=DPSIZE)   :: MU_(*)
      INTEGER NEWIND
      REAL(KIND=DPSIZE) :: EVTREC
      SAVE
      INTEGER(KIND=ISIZE) :: FIRSTEM
      INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS
      DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*),GG(IRGG,GPKD+1,*)
      RETURN
      END
